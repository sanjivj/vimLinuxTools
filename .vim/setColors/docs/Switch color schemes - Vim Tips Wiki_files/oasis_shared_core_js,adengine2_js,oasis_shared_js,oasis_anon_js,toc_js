(function(){my={};my.Class=function(){var len=arguments.length;var body=arguments[len-1];var SuperClass=len>1?arguments[0]:null;var hasImplementClasses=len>2;var Class,SuperClassEmpty;if(body.constructor===Object){Class=function(){};}else{Class=body.constructor;delete body.constructor;}
if(SuperClass){SuperClassEmpty=function(){};SuperClassEmpty.prototype=SuperClass.prototype;Class.prototype=new SuperClassEmpty();Class.prototype.constructor=Class;Class.Super=SuperClass;extend(Class,SuperClass,false);}
if(hasImplementClasses)
for(var i=1;i<len-1;i++)
extend(Class.prototype,arguments[i].prototype,false);extendClass(Class,body);return Class;};var extendClass=my.extendClass=function(Class,extension,override){if(extension.STATIC){extend(Class,extension.STATIC,override);delete extension.STATIC;}
extend(Class.prototype,extension,override)};var extend=function(obj,extension,override){var prop;if(override===false){for(prop in extension)
if(!(prop in obj))
obj[prop]=extension[prop];}else{for(prop in extension)
obj[prop]=extension[prop];if(extension.toString!==Object.prototype.toString)
obj.toString=extension.toString;}};})();;define('sloth',function(){'use strict';var slice=Array.prototype.slice,win=window,wTop,wBottom,undef,debounce,delegate=win.setTimeout,branches=[],Branch=function(element,threshold,callback){this.element=element;this.threshold=threshold;this.callback=function(){callback(element);};},addEvent=function(){win.addEventListener('scroll',execute);},removeEvent=function(){win.removeEventListener('scroll',execute);},lock=0,execute=function(){var i=branches.length,branch;removeEvent();if(i&&!lock){lock=delegate(function(){lock=0;addEvent();},debounce);wTop=win.scrollY||win.pageYOffset;wBottom=wTop+win.innerHeight;while(i--){branch=branches[i];if(branch.isVisible()){delegate(branch.callback,0);branches.splice(i,1);}}}};Branch.prototype.isVisible=function(){var elem=this.element,mayBeVisible=elem.scrollHeight||elem.scrollWidth,height,threshold,top,bottom;if(mayBeVisible){threshold=this.threshold;height=elem.offsetHeight;top=(elem.offsetTop||elem.y)-threshold;bottom=top+height+threshold;return wBottom>=top&&wTop<=bottom;}
return false;};return function(params){if(params){var elements=params.on,threshold=params.threshold!==undef?params.threshold:100,callback=params.callback,i;debounce=params.debounce!==undef?params.debounce:500;if(!elements){throw'No elements passed';}
if(!callback){throw'No callback passed';}
if(elements.length!==undef){elements=slice.call(elements);i=elements.length;while(i--){branches.push(new Branch(elements[i],threshold,callback));}}else{branches.push(new Branch(elements,threshold,callback));}}
execute();};});;var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(exports){exports.name="mustache.js";exports.version="0.5.0-dev";exports.tags=["{{","}}"];exports.parse=parse;exports.compile=compile;exports.render=render;exports.clearCache=clearCache;exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send==="function"){send(result);}else{return result;}};var _toString=Object.prototype.toString;var _isArray=Array.isArray;var _forEach=Array.prototype.forEach;var _trim=String.prototype.trim;var isArray;if(_isArray){isArray=_isArray;}else{isArray=function(obj){return _toString.call(obj)==="[object Array]";};}
var forEach;if(_forEach){forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope);};}else{forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i){callback.call(scope,obj[i],i,obj);}};}
var spaceRe=/^\s*$/;function isWhitespace(string){return spaceRe.test(string);}
var trim;if(_trim){trim=function(string){return string==null?"":_trim.call(string);};}else{var trimLeft,trimRight;if(isWhitespace("\xA0")){trimLeft=/^\s+/;trimRight=/\s+$/;}else{trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}
trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"");};}
var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;'};function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s;});}
function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end);var c;for(var i=0,len=context.length;i<len;++i){c=i+start+1;context[i]=(c===line?" >> ":"    ")+context[i];}
e.template=template;e.line=line;e.file=file;e.message=[file+":"+line,context.join("\n"),"",e.message].join("\n");return e;}
function lookup(name,stack,defaultValue){if(name==="."){return stack[stack.length-1];}
var names=name.split(".");var lastIndex=names.length-1;var target=names[lastIndex];var value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0);context=stack[--i];j=0;while(j<lastIndex){context=context[names[j++]];if(context==null){break;}
localStack.push(context);}
if(context&&typeof context==="object"&&target in context){value=context[target];break;}}
if(typeof value==="function"){value=value.call(localStack[localStack.length-1]);}
if(value==null){return defaultValue;}
return value;}
function renderSection(name,stack,callback,inverted){var buffer="";var value=lookup(name,stack);if(inverted){if(value==null||value===false||(isArray(value)&&value.length===0)){buffer+=callback();}}else if(isArray(value)){forEach(value,function(value){stack.push(value);buffer+=callback();stack.pop();});}else if(typeof value==="object"){stack.push(value);buffer+=callback();stack.pop();}else if(typeof value==="function"){var scope=stack[stack.length-1];var scopedRender=function(template){return render(template,scope);};buffer+=value.call(scope,callback(),scopedRender)||"";}else if(value){buffer+=callback();}
return buffer;}
function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1];var code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var spaces=[],hasTag=false,nonSpace=false;var stripSpace=function(){if(hasTag&&!nonSpace&&!options.space){while(spaces.length){code.splice(spaces.pop(),1);}}else{spaces=[];}
hasTag=false;nonSpace=false;};var sectionStack=[],updateLine,nextOpenTag,nextCloseTag;var setTags=function(source){tags=trim(source).split(/\s+/);nextOpenTag=tags[0];nextCloseTag=tags[tags.length-1];};var includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];','\nif (partial) {','\n  buffer += render(partial,stack[stack.length - 1],partials);','\n}','\nbuffer += "');};var openSection=function(source,inverted){var name=trim(source);if(name===""){throw debug(new Error("Section name may not be empty"),template,line,options.file);}
sectionStack.push({name:name,inverted:inverted});code.push('";',updateLine,'\nvar name = "'+name+'";','\nvar callback = (function () {','\n  return function () {','\n    var buffer = "";','\nbuffer += "');};var openInvertedSection=function(source){openSection(source,true);};var closeSection=function(source){var name=trim(source);var openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName){throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);}
var section=sectionStack.pop();code.push('";','\n    return buffer;','\n  };','\n})();');if(section.inverted){code.push("\nbuffer += renderSection(name,stack,callback,true);");}else{code.push("\nbuffer += renderSection(name,stack,callback);");}
code.push('\nbuffer += "');};var sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(source)+'",stack,"");','\nbuffer += "');};var sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "');};var line=1,c,callback;for(var i=0,len=template.length;i<len;++i){if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length;c=template.substr(i,1);updateLine='\nline = '+line+';';nextOpenTag=openTag;nextCloseTag=closeTag;hasTag=true;switch(c){case"!":i++;callback=null;break;case"=":i++;closeTag="="+closeTag;callback=setTags;break;case">":i++;callback=includePartial;break;case"#":i++;callback=openSection;break;case"^":i++;callback=openInvertedSection;break;case"/":i++;callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++;nonSpace=true;callback=sendPlain;break;default:nonSpace=true;callback=sendEscaped;}
var end=template.indexOf(closeTag,i);if(end===-1){throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);}
var source=template.substring(i,end);if(callback){callback(source);}
var n=0;while(~(n=source.indexOf("\n",n))){line++;n++;}
i=end+closeTag.length-1;openTag=nextOpenTag;closeTag=nextCloseTag;}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=true;code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length);code.push("\\n");stripSpace();line++;break;default:if(isWhitespace(c)){spaces.push(code.length);}else{nonSpace=true;}
code.push(c);}}}
if(sectionStack.length!=0){throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);}
stripSpace();code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");if(options.debug){if(typeof console!="undefined"&&console.log){console.log(body);}else if(typeof print==="function"){print(body);}}
return body;}
function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render";var body=parse(template,options);var fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render);}catch(e){throw debug(e.error,template,e.line,options.file);}};}
var _cache={};function clearCache(){_cache={};}
function compile(template,options){options=options||{};if(options.cache!==false){if(!_cache[template]){_cache[template]=_compile(template,options);}
return _cache[template];}
return _compile(template,options);}
function render(template,view,partials){return compile(template)(view,partials);}})(Mustache);(function(context){context.Mustache=Mustache;if(context.define&&context.define.amd){context.define('wikia.mustache',Mustache);}}(window));;define('wikia.browserDetect',function(){'use strict';var appName=navigator.appName,userAgent=navigator.userAgent;function isIE(){var bool=false;if(appName==='Microsoft Internet Explorer'||(appName==='Netscape'&&userAgent.indexOf('Trident/')!==-1)){bool=true;}
return bool;}
function isIPad(){var bool=false;if(userAgent.match(/iPad/i)!==null){bool=true;}
return bool;}
return{isIE:isIE,isIPad:isIPad};});;(function(mw,$){function cat(pre,val,post,raw){if(val===undefined||val===null||val===''){return'';}
return pre+(raw?val:mw.Uri.encode(val))+post;}
var parser={strict:/^(?:([^:\/?#]+):)?(?:\/\/(?:(?:([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?([^:\/?#]*)(?::(\d*))?)?((?:[^?#\/]*\/)*[^?#]*)(?:\?([^#]*))?(?:#(.*))?/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?(?:(?:([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?([^:\/?#]*)(?::(\d*))?((?:\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?[^?#\/]*)(?:\?([^#]*))?(?:#(.*))?/},properties=['protocol','user','password','host','port','path','query','fragment'];mw.UriRelative=function(documentLocation){var defaultUri;function Uri(uri,options){options=typeof options==='object'?options:{strictMode:!!options};options=$.extend({strictMode:false,overrideKeys:false},options);if(uri!==undefined&&uri!==null&&uri!==''){if(typeof uri==='string'){this.parse(uri,options);}else if(typeof uri==='object'){for(var prop in uri){if(uri.hasOwnProperty(prop)){if($.isArray(uri[prop])||$.isPlainObject(uri[prop])){this[prop]=$.extend(true,{},uri[prop]);}else{this[prop]=uri[prop];}}}
if(!this.query){this.query={};}}}else{return defaultUri.clone();}
if(!this.protocol){this.protocol=defaultUri.protocol;}
if(!this.host){this.host=defaultUri.host;if(!this.port){this.port=defaultUri.port;}}
if(this.path&&this.path.charAt(0)!=='/'){throw new Error('Bad constructor arguments');}
if(!(this.protocol&&this.host&&this.path)){throw new Error('Bad constructor arguments');}}
Uri.encode=function(s){return encodeURIComponent(s).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');};Uri.decode=function(s){return decodeURIComponent(s.replace(/\+/g,'%20'));};Uri.prototype={parse:function(str,options){var q,uri=this,matches=parser[options.strictMode?'strict':'loose'].exec(str);$.each(properties,function(i,property){uri[property]=matches[i+1];});q={};if(uri.query){uri.query.replace(/(?:^|&)([^&=]*)(?:(=)([^&]*))?/g,function($0,$1,$2,$3){var k,v;if($1){k=Uri.decode($1);v=($2===''||$2===undefined)?null:Uri.decode($3);if(options.overrideKeys||q[k]===undefined){q[k]=v;}else{if(typeof q[k]==='string'){q[k]=[q[k]];}
if($.isArray(q[k])){q[k].push(v);}}}});}
this.query=q;},getUserInfo:function(){return cat('',this.user,cat(':',this.password,''));},getHostPort:function(){return this.host+cat(':',this.port,'');},getAuthority:function(){return cat('',this.getUserInfo(),'@')+this.getHostPort();},getQueryString:function(){var args=[];$.each(this.query,function(key,val){var k=Uri.encode(key),vals=$.isArray(val)?val:[val];$.each(vals,function(i,v){if(v===null){args.push(k);}else if(k==='title'){args.push(k+'='+mw.util.wikiUrlencode(v));}else{args.push(k+'='+Uri.encode(v));}});});return args.join('&');},getRelativePath:function(){return this.path+cat('?',this.getQueryString(),'',true)+cat('#',this.fragment,'');},toString:function(){return this.protocol+'://'+this.getAuthority()+this.getRelativePath();},clone:function(){return new Uri(this);},extend:function(parameters){$.extend(this.query,parameters);return this;}};defaultUri=new Uri(documentLocation);return Uri;};if(document&&document.location&&document.location.href){mw.Uri=mw.UriRelative(document.location.href);}}(mediaWiki,jQuery));;


var ScriptWriter=function(document,log,window,loader){'use strict';var module='wikia.scriptwriter',postscribeLoaded=!!window.postscribe,library=window.wgUsePostScribe?'postscribe':'ghostwriter',queue=[],queueCompleted=false,impl,implLoading=false,implGw={},implPs={},endCallbacks=[];function escapeHtml(str){return str.replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function getElement(elementOrElementId){if(elementOrElementId&&elementOrElementId.getElementsByTagName){return elementOrElementId;}
if(typeof elementOrElementId==='string'){var el=document.getElementById(elementOrElementId);if(el){return el;}}
throw'wikia.scriptwriter: Not a valid element or element id '+elementOrElementId;}
function callLater(callback){if(typeof callback!=='function'){throw'wikia.scriptwriter: callLater requires function as the first argument';}
setTimeout(function(){if(queue.length>0){log('callLater registered','debug',module);endCallbacks.push(callback);}else{log('No queued script writer requests. Calling callLater directly','debug',module);callback();}},0);}
function processQueue(){log('processQueue','debug',module);var item,args,callback;if(queue.length===0){queueCompleted=true;log(['processQueue','Queue completed'],'debug',module);while(true){callback=endCallbacks.shift();if(typeof callback==='function'){log('Calling callLater now','debug',module);callback();log('Actual callLater called','debug',module);}else{break;}}
return;}
item=queue[0];args=item.args;callback=item.callback;args.push(function(){log(['Done writing',args],'debug',module);if(typeof callback==='function'){log(['Calling done callback',args],'debug',module);callback();log(['Done callback called',args],'debug',module);}
queue.shift();log(['processQueue','Item processed. Going on'],'debug',module);processQueue();});log(['Start writing',args],'debug',module);impl[item.type].apply(impl,args);}
function loadImpl(){var url;if(implLoading){return;}
implLoading=true;log('loadImpl '+library,'debug',module);if(library==='postscribe'){url='/resources/wikia/libraries/postscribe/postscribe.min.js';impl=implPs;if(postscribeLoaded){log(['loadImpl','postscribe already loaded, processing queue'],'debug',module);processQueue();return;}}else{url='/resources/wikia/libraries/ghostwriter/gw.min.js';impl=implGw;}
if(loader){loader(url).done(processQueue);}else{require(['wikia.loader'],function(loader){loader(url).done(processQueue);});}}
function push(type,args,callback){log(['push',type,args,callback],'debug',module);queue.push({type:type,args:args,callback:callback});if(queueCompleted&&queue.length===1){processQueue();}
loadImpl();}
function psBeforeWrite(str){log(['psBeforeWrite',str],'trace_l3',module);return str.replace(/<\/embed>/gi,'');}
implPs.url=function(element,url,callback){window.postscribe(element,'<script src="'+escapeHtml(url)+'"></script>',{beforeWrite:psBeforeWrite,done:callback});};implPs.text=function(element,text,callback){window.postscribe(element,'<script>'+text+'</script>',{beforeWrite:psBeforeWrite,done:callback});};function gwFlushLoadHandlersAndCall(callback){return function(){window.ghostwriter.flushloadhandlers();callback();};}
implGw.url=function(element,url,callback){window.ghostwriter(element,{insertType:'append',script:{src:url},done:gwFlushLoadHandlersAndCall(callback)});};implGw.text=function(element,text,callback){window.ghostwriter(element,{insertType:'append',script:{text:text},done:gwFlushLoadHandlersAndCall(callback)});};return{injectScriptByUrl:function(elementOrElementId,url,callback){push('url',[getElement(elementOrElementId),url],callback);},injectScriptByText:function(elementOrElementId,text,callback){push('text',[getElement(elementOrElementId),text],callback);},callLater:callLater};};if(this.define&&define.amd){define('wikia.scriptwriter',['wikia.document','wikia.log','wikia.window','wikia.loader'],ScriptWriter);};window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);Krux.load=function(confid){var k=document.createElement('script');k.type='text/javascript';k.async=true;var m,src=(m=location.href.match(/\bkxsrc=([^&]+)\b/))&&decodeURIComponent(m[1]);k.src=src||(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag?confid='+confid;var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);};if(window.wgEnableKruxTargeting){(function(){function retrieve(n){var m,k='kx'+n;if(window.localStorage){return window.localStorage[k]||"";}else if(navigator.cookieEnabled){m=document.cookie.match(k+'=([^;]*)');return(m&&unescape(m[1]))||"";}else{return'';}}
var kvs=[];Krux.user=retrieve('user');if(Krux.user){kvs.push('u='+Krux.user);}
Krux.segments=retrieve('segs')&&retrieve('segs').split(',')||[];for(var i=0;i<Krux.segments.length;i++){kvs.push('ksgmnt='+Krux.segments[i]);}
Krux.dartKeyValues=kvs.length?kvs.join(';')+';':'';})();}else{Krux.dartKeyValues='';};var SlotTweaker=function(log,document,window){'use strict';var logGroup='SlotTweaker',addDefaultHeight,removeClass,removeDefaultHeight,hide,show,removeTopButtonIfNeeded,defaultHeightClass='default-height',rclass=/[\t\r\n]/g,isLeaderboard,isStandardLeaderboardSize,adjustLeaderboardSize,standardLeaderboardSizeClass='standard-leaderboard';removeClass=function(element,cls){var elClasses=' '+element.className.replace(rclass,' ')+' ',newClasses=elClasses.replace(' '+cls+' ',' ');log(['removeClass '+cls,element],8,logGroup);element.className=newClasses;};removeDefaultHeight=function(slotname){var slot=document.getElementById(slotname);log('removeDefaultHeight '+slotname,6,logGroup);if(slot){removeClass(slot,defaultHeightClass);}};isLeaderboard=function(slotname){return slotname.indexOf('LEADERBOARD')!==-1;};isStandardLeaderboardSize=function(slotname){var slot=document.getElementById(slotname),isStandardSize;if(slot){isStandardSize=slot.offsetHeight>=90&&slot.offsetHeight<=95&&slot.offsetWidth<=728;log(['isStandardLeaderboardSize',slotname,slot.offsetWidth+'x'+slot.offsetHeight,isStandardSize],3,logGroup);return isStandardSize;}
log('isStandardLeaderboardSize: '+slotname+' missing',3,logGroup);};addDefaultHeight=function(slotname){var slot=document.getElementById(slotname);log('addDefaultHeight '+slotname,6,logGroup);if(slot){slot.className+=' '+defaultHeightClass;}};adjustLeaderboardSize=function(slotname){var slot=document.getElementById(slotname);if(isLeaderboard(slotname)&&isStandardLeaderboardSize(slotname)){slot.className+=' '+standardLeaderboardSizeClass;}};removeTopButtonIfNeeded=function(slotname){if(isLeaderboard(slotname)&&!isStandardLeaderboardSize(slotname)){log('removing TOP_BUTTON(_WIDE)',3,logGroup);hide('TOP_BUTTON');hide('TOP_BUTTON_WIDE');}
if(isLeaderboard(slotname)&&isStandardLeaderboardSize(slotname)){log('pushing TOP_BUTTON(_WIDE).force to Liftium2 queue',2,logGroup);window.adslots2.push(['TOP_BUTTON.force',null,'Liftium2']);window.adslots2.push(['TOP_BUTTON_WIDE.force',null,'Liftium2']);}};hide=function(slotname,usingClass){log('hide '+slotname+(usingClass?' using class hidden':' using display: none'),6,logGroup);var slot=document.getElementById(slotname);if(slot){if(usingClass){slot.className+=' hidden';}else{slot.style.display='none';}}};show=function(slotname,usingClass){log('hide '+slotname+(usingClass?' using class hidden':' using display: none'),6,logGroup);var slot=document.getElementById(slotname);if(slot){if(usingClass){removeClass(slot,'hidden');}else{throw'Showing slot not based on hidden class unsupported';}}};return{addDefaultHeight:addDefaultHeight,removeDefaultHeight:removeDefaultHeight,removeTopButtonIfNeeded:removeTopButtonIfNeeded,adjustLeaderboardSize:adjustLeaderboardSize,hide:hide,show:show};};;var AdEngine2=function(log,LazyQueue){'use strict';var module='AdEngine2',run;run=function(adConfig,adslots){log('run',5,module);log('initial queue',7,module);log(adslots,7,module);log('initializing LazyQueue on the queue',7,module);LazyQueue.makeQueue(adslots,function(slot){log('fillInSlot',5,module);log(slot,5,module);var slotname=slot[0],provider=adConfig.getProvider(slot);log('calling '+provider.name+'.fillInSlot for '+slotname,3,module);provider.fillInSlot([slotname]);});log('launching queue on adslots',7,module);adslots.start();log('initial queue handled',6,module);};return{run:run};};;var AdTracker=function(log,tracker){'use strict';var logGroup='AdTracker',maxTrackedTime=5,trackedSize={CORP_TOP_LEADERBOARD:'728x90',CORP_TOP_RIGHT_BOXAD:'300x250',EXIT_STITIAL_BOXAD_1:'300x250',HOME_TOP_LEADERBOARD:'728x90',HOME_TOP_RIGHT_BOXAD:'300x250',HUB_TOP_LEADERBOARD:'728x90',INCONTENT_BOXAD_1:'300x250',INVISIBLE_1:'0x0',INVISIBLE_2:'0x0',INVISIBLE_SKIN:'1x1',LEFT_SKYSCRAPER_2:'160x600',LEFT_SKYSCRAPER_3:'160x600',MODAL_INTERSTITIAL:'300x250',MODAL_INTERSTITIAL_1:'300x250',MODAL_INTERSTITIAL_2:'300x250',MODAL_INTERSTITIAL_3:'300x250',MODAL_INTERSTITIAL_4:'300x250',MODAL_RECTANGLE:'300x100',PREFOOTER_LEFT_BOXAD:'300x250',PREFOOTER_RIGHT_BOXAD:'300x250',SEVENONEMEDIA_FLUSH:'0x0',TOP_BUTTON_WIDE:'292x90',TOP_LEADERBOARD:'728x90',TOP_RIGHT_BOXAD:'300x250',WIKIA_BAR_BOXAD_1:'300x50'};function formatTrackTime(t){var formatted;log(['formatTrackTime',t],'debug',logGroup);if(isNaN(t)){log(['formatTrackTime',t,'Error, time tracked is NaN'],'warning',logGroup);return'NaN';}
if(t<0){log(['formatTrackTime',t,'Error, time tracked is a negative number'],'warning',logGroup);return'negative';}
formatted=t/1000;if(formatted>maxTrackedTime){formatted='more_than_'+maxTrackedTime;log(['formatTrackTime',t,formatted],'debug',logGroup);return formatted;}
formatted=formatted.toFixed(1);log(['formatTrackTime',t,formatted],'debug',logGroup);return formatted;}
function trackInit(provider,slotname,slotsize){log(['trackInit',slotname,slotsize],'debug',logGroup);tracker.track({eventName:'liftium.slot3',ga_category:'slot3/'+slotsize.split(',')[0],ga_action:slotname,ga_label:provider,trackingMethod:'ad'});}
function trackEnd(provider,category,slotname,hopTime,reason){log(['trackEnd',category,slotname,hopTime],'debug',logGroup);var labelPrefix='';if(reason){labelPrefix=reason+'/';}
tracker.track({eventName:'liftium.hop3',ga_category:category+'3/'+provider,ga_action:'slot '+slotname,ga_label:labelPrefix+formatTrackTime(hopTime),trackingMethod:'ad'});}
function trackSlot(provider,slotname){var slotStart,slotsize=trackedSize[slotname]||'unknown';return{init:function(){slotStart=new Date().getTime();trackInit(provider,slotname,slotsize);},success:function(){var slotEnd=new Date().getTime();if(!slotStart){throw'AdTracker: call init before success';}
trackEnd(provider,'success',slotname,slotEnd-slotStart);},hop:function(reason){var slotEnd=new Date().getTime();if(!slotStart){throw'AdTracker: call init before hop';}
trackEnd(provider,'hop',slotname,slotEnd-slotStart,reason);}};}
return{trackSlot:trackSlot};};;if(window.iam_data){var scriptWriter=ScriptWriter(document,Wikia.log,window);scriptWriter.injectScriptByUrl('ivw2_placeholder','https://script.ioam.de/iam.js',function(){scriptWriter.injectScriptByText('ivw2_placeholder','iom.c(iam_data);');});};require(['wikia.window','wikia.tracker'],function(window,tracker){var wikia=window.Wikia=window.Wikia||{};wikia.fliteOoyalaTracker=function(id){tracker.track({action:'content-begin',category:'video-player-stats',label:'ooyala',trackingMethod:'internal',title:id||'',clickSource:'ad'});};});;var DartUrl=function(){'use strict';var logGroup='DartUrlUtils';function trimParam(kvs,limit){if(!limit||limit===true){limit=500;}
kvs=kvs||'';kvs=kvs.substr(0,limit).replace(/;[^;]*$/,';');if(!kvs.match(/;$/)){kvs='';}
return kvs;}
function decorateParam(key,value){var ret='',i;if(value){if(!(value instanceof Array)){value=[value];}
for(i=0;i<value.length;i+=1){if(value[i]){ret+=key+'='+encodeURIComponent(value[i]+'')+';';}}}
return ret;}
function urlBuilder(domain,path){var params='';function toString(){return'http://'+domain+'/'+path+';'+params;}
function addString(str,limit){if(limit){str=trimParam(str,limit);}
params+=str;}
function addParam(key,value,limit){addString(decorateParam(key,value),limit);}
return{addParam:addParam,addString:addString,toString:toString};}
return{decorateParam:decorateParam,trimParam:trimParam,urlBuilder:urlBuilder};};(function(context){'use strict';if(context.define&&context.define.amd){context.define('wikia.darturl',DartUrl);}}(this));;var WikiaDartHelper=function(log,adLogicPageLevelParams,dartUrl,adLogicDartSubdomain){'use strict';var logGroup='WikiaDartHelper',getUrl,ord=Math.round(Math.random()*23456787654),tile=1,categoryStrMaxLength=300;getUrl=function(params){var slotname=params.slotname,size=params.slotsize,adType=params.adType||'adj',src=params.src||'driver',localTile,localOrd=params.ord||ord,url,subdomain=params.subdomain||(adLogicDartSubdomain&&adLogicDartSubdomain.getSubdomain()),pageParams=adLogicPageLevelParams.getPageLevelParams(),name,value;if(adType==='jwplayer'){adType='pfadx';}
if(params.tile){localTile=params.tile;}else{localTile=tile;tile+=1;}
log(['getUrl',slotname,size],5,logGroup);url=dartUrl.urlBuilder(subdomain+'.doubleclick.net',adType+'/'+'wka.'+pageParams.s0+'/'+pageParams.s1+'/'+pageParams.s2);for(name in pageParams){if(pageParams.hasOwnProperty(name)){value=pageParams[name];if(value){if(name==='cat'){url.addParam(name,value,categoryStrMaxLength);}else if(name==='ksgmnt'){url.addParam(name,value,true);}else{url.addParam(name,value);}}}}
url.addParam('src',src);url.addString('mtfIFPath=/extensions/wikia/AdEngine/;');url.addParam('mtfInline','true');url.addParam('pos',params.slotname);url.addParam('loc',params.loc);url.addParam('dcopt',params.dcopt);url.addParam('sz',size);url.addParam('tile',localTile);url.addString('endtag=$;');url.addString('ord='+localOrd+'?');log(url.toString(),5,logGroup);return url.toString();};return{getUrl:getUrl};};(function(context){'use strict';if(context.define&&context.define.amd){context.define('ext.wikia.adengine.darthelper',['wikia.log','wikia.adlogicpageparams','wikia.darturl','ext.wikia.adengine.adlogic.subdomain'],context.WikiaDartHelper);}}(this));;define('ext.wikia.adengine.dartvideohelper',['wikia.log','wikia.location','wikia.adlogicpageparams'],function(log,location,adLogicPageLevelParams){'use strict';var logGroup='adengine.dartvideohelper',ord=Math.round(Math.random()*23945290875),pageParams=adLogicPageLevelParams.getPageLevelParams();pageParams.src='ooyala';function getCustParams(){var key,vals,params=[],urlEncodedVals,valIndex;for(key in pageParams){if(pageParams.hasOwnProperty(key)&&key!==''){vals=pageParams[key];if(vals){if(!(vals instanceof Array)){vals=[vals];}
urlEncodedVals=[];if(vals.length){for(valIndex=0;valIndex<vals.length;valIndex+=1){urlEncodedVals.push(encodeURIComponent(vals[valIndex].toString()));}
params.push(key+'='+urlEncodedVals.join(','));}}}}
return params.join('&');}
function getUrl(){log('getUrl',5,logGroup);var out='http://pubads.g.doubleclick.net/gampad/ads?'+'env=vp&gdfp_req=1&impl=s&output=xml_vast2&'+'iu=/5441/wka.'+pageParams.s0+'//'+pageParams.s1+'//'+pageParams.s2+'&'+'sz=320x240&'+'unviewed_position_start=1&'+'url='+encodeURIComponent(location.href)+'&'+'cust_params='+encodeURIComponent(getCustParams())+'&'+'correlator='+ord;log(out,5,logGroup);return out;}
return{getUrl:getUrl};});;var WikiaFullGptHelper=function(log,window,document,adLogicPageLevelParams){'use strict';var logGroup='WikiaFullGptHelper',gptLoaded=false,pageLevelParams=adLogicPageLevelParams.getPageLevelParams(),path='/5441/wka.'+pageLevelParams.s0+'/'+pageLevelParams.s1+'//'+pageLevelParams.s2,slotQueue=[],doneCallbacks={},slotMap,gptSlots={},dataAttribs={},googletag;pageLevelParams.src='gpt';function init(paramSlotMap){slotMap=paramSlotMap;}
function triggerDone(slotnameGpt){var callback=doneCallbacks[slotnameGpt];log(['triggerDone',slotnameGpt],3,logGroup);if(callback){delete doneCallbacks[slotnameGpt];setTimeout(callback,0);}}
function convertSizesToGpt(slotsize){log(['convertSizeToGpt',slotsize],9,logGroup);var tmp1=slotsize.split(','),sizes=[],tmp2,i;for(i=0;i<tmp1.length;i+=1){tmp2=tmp1[i].split('x');sizes.push([parseInt(tmp2[0],10),parseInt(tmp2[1],10)]);}
return sizes;}
function loadGpt(){if(!gptLoaded){log('loadGpt',7,logGroup);var gads=document.createElement('script'),node=document.getElementsByTagName('script')[0];gptLoaded=true;window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];gads.async=true;gads.type='text/javascript';gads.src='//www.googletagservices.com/tag/js/gpt.js';log('Appending GPT script to head',7,logGroup);node.parentNode.insertBefore(gads,node);googletag=window.googletag;log(['loadGpt','googletag.cmd.push','bind to GPT events'],4,logGroup);googletag.cmd.push(function(){var debug_log=googletag.debug_log,oldLog=debug_log.log;googletag.debug_log.log=function(level,message,service,slot){var domId,doneMessageId=5;try{domId=slot&&slot.getSlotId().getDomId();if(domId&&typeof message==='object'&&message.getMessageId){if(message.getMessageId()===doneMessageId){triggerDone(domId);}}}catch(e){}
return oldLog.apply(debug_log,arguments);};});log(['loadGpt','googletag.cmd.push','page level targeting'],4,logGroup);googletag.cmd.push(function(){var name,value,pubads=googletag.pubads(),slotname,slotnameGpt,sizes,slot,slotItem,slotPath,slotParams;pubads.collapseEmptyDivs();log(['loadGpt','pageLevelParams',pageLevelParams],9,logGroup);for(name in pageLevelParams){if(pageLevelParams.hasOwnProperty(name)){value=pageLevelParams[name];if(value){log(['pubads.setTargeting',name,value],9,logGroup);pubads.setTargeting(name,value);}}}
for(slotname in slotMap){if(slotMap.hasOwnProperty(slotname)&&slotMap[slotname].size){log(['loadGpt','defining slot',slotname],9,logGroup);slotnameGpt=slotname+'_gpt';slotItem=slotMap[slotname];sizes=convertSizesToGpt(slotItem.size);slotPath=path+'/'+slotname;log(['googletag.defineSlot',slotPath,sizes,slotnameGpt],9,logGroup);slot=googletag.defineSlot(slotPath,sizes,slotnameGpt);slot.addService(googletag.pubads());slotParams={pos:slotname,loc:slotItem.loc};for(name in slotParams){if(slotParams.hasOwnProperty(name)){value=slotParams[name];if(value){log(['slot.setTargeting',name,value],9,logGroup);slot.setTargeting(name,value);}}}
gptSlots[slotname]=slot;dataAttribs[slotname]={'data-gpt-page-params':JSON.stringify(pageLevelParams),'data-gpt-slot-params':JSON.stringify(slotParams),'data-gpt-slot-sizes':JSON.stringify(sizes)};log(['loadGpt','defined slot',slotname,slot],9,logGroup);}}
log(['loadGpt','all slots defined'],9,logGroup);googletag.pubads().enableSingleRequest();googletag.pubads().disableInitialLoad();googletag.enableServices();log(['loadGpt','services enabled'],9,logGroup);});}}
function pushAd(slotname,success,error){var slotnameGpt=slotname+'_gpt',slotDiv=document.createElement('div');loadGpt();slotDiv.id=slotnameGpt;document.getElementById(slotname).appendChild(slotDiv);log(['pushAd',slotname],9,logGroup);googletag.cmd.push(function(){var attrName;log(['googletag.display',slotnameGpt],9,logGroup);googletag.display(slotnameGpt);slotQueue.push(gptSlots[slotname]);doneCallbacks[slotnameGpt]=function(){var status,height;if(window.adDriver2ForcedStatus&&window.adDriver2ForcedStatus[slotname]){status=window.adDriver2ForcedStatus[slotname];log(['doneCallback',slotname,'forced status',status],4,logGroup);if(status==='success'&&typeof success==='function'){success();}}else{height=slotDiv.offsetHeight;log(['doneCallback',slotname,'height',height],4,logGroup);if(height<=1){log(['doneCallback',slotname,'running error callback (hop)'],4,logGroup);if(typeof error==='function'){error();}}else{log(['doneCallback',slotname,'running success callback'],4,logGroup);if(typeof success==='function'){success();}}}};for(attrName in dataAttribs[slotname]){if(dataAttribs[slotname].hasOwnProperty(attrName)){slotDiv.setAttribute(attrName,dataAttribs[slotname][attrName]);}}});}
function flushAds(){if(!gptLoaded){log(['flushAds','done','no slots to flush'],4,logGroup);return;}
googletag.cmd.push(function(){var i,len,callback;log(['flushAds','start'],4,logGroup);log(['flushAds','refresh',slotQueue],9,logGroup);if(slotQueue.length){googletag.pubads().refresh(slotQueue);slotQueue=[];}
for(i=0,len=doneCallbacks.length;i<len;i+=1){callback=doneCallbacks.shift();callback();}
log(['flushAds','done'],4,logGroup);});}
return{init:init,pushAd:pushAd,flushAds:flushAds};};;var SevenOneMediaHelper=function(adLogicPageLevelParams,scriptWriter,log,window,$,tracker){'use strict';var logGroup='SevenOneMediaHelper',postponedContainerId='seven-one-media-ads-postponed',$postponedContainer,myAd,initialized=false,pageLevelParams=adLogicPageLevelParams.getPageLevelParams(),targetingParamKeys=['pform','media','gnre','egnre'],slotVars={'popup1':{SOI_PU1:true,SOI_PL:true,SOI_PU:false,SOI_FA:false},'fullbanner2':{SOI_FB2:true,SOI_PB:true,SOI_PD:true,SOI_BB:true,SOI_WP:true,SOI_FP:true},'rectangle1':{SOI_RT1:true,SOI_HP:true},'skyscraper1':{SOI_SC1:true,SOI_SB:true},'promo1':{SOI_PB1:true},'promo2':{SOI_PB2:true},'promo3':{SOI_PB3:true}},slotsQueue=[];function track(action){log(['track',action],'info',logGroup);tracker.track({eventName:'liftium.71m',ga_category:'71m',ga_action:action,trackingMethod:'ad'});}
function insertAd(item){var slotname,beforeFinish,afterFinish,postponedSlotId,$postponedSlot,script;slotname=item.slotname;beforeFinish=item.params&&item.params.beforeFinish;afterFinish=item.params&&item.params.afterFinish;log(['insertAd',slotname],'info',logGroup);postponedSlotId='ad-'+slotname+'-postponed';$postponedSlot=$('<div/>').attr('id',postponedSlotId);$postponedContainer.append($postponedSlot);if(slotname==='trackEnd'){script='';}else{script='window.myAd && myAd.insertAd('+JSON.stringify(slotname)+');';}
scriptWriter.injectScriptByText(postponedSlotId,script,function(){if(!myAd){return;}
log(['insertAd',slotname,'myAd.insertAd done'],'debug',logGroup);if(typeof beforeFinish==='function'){log(['insertAd',slotname,'calling beforeFinish'],'debug',logGroup);beforeFinish({slotname:slotname});}
if(slotname!=='trackEnd'){log(['insertAd',slotname,'calling myAd.finishAd'],'debug',logGroup);myAd.finishAd(slotname,'move');log(['insertAd',slotname,'myAd.finishAd done'],'debug',logGroup);}
if(typeof afterFinish==='function'){var info={slotname:slotname,isSpecialAd:myAd.isSpecialAd(slotname)};log(['insertAd',slotname,'calling afterFinish',info],'debug',logGroup);afterFinish(info);}
log(['insertAd',slotname,'myAd.insertAd done callback executed'],'debug',logGroup);});}
function setVars(vars){var varName;log(['setVars',vars],'debug',logGroup);for(varName in vars){if(vars.hasOwnProperty(varName)){window[varName]=vars[varName];}}}
function injectJavaScripts(slotname,done,error){var javaScriptsPlaceHolder='ad-'+slotname;scriptWriter.injectScriptByUrl(javaScriptsPlaceHolder,window.wgAdDriverSevenOneMediaCombinedUrl,function(){if(!window.SEVENONEMEDIA_CSS){error('sevenonemedia_css');return;}
if(!window.myAd){error('my_ad_integration');return;}
log('myAd loaded','info',logGroup);myAd=window.myAd;if(window.SOI_IDENTIFIER!=='wikia'){error('wikia');return;}
log('Sites/wikia.js loaded','info',logGroup);myAd.loaded.site=true;if(!window.SoiAP){error('globalV6');return;}
log('globalV6.js loaded','info',logGroup);myAd.loaded.global=true;done();});}
function generateSoiKeyValue(){var i,len,key,ret={};for(i=0,len=targetingParamKeys.length;i<len;i+=1){key=targetingParamKeys[i];if(pageLevelParams[key]&&pageLevelParams[key][0]){ret[key]=pageLevelParams[key][0].substr(0,10);}}
return ret;}
function initialize(firstSlotname){var subsite=window.cscoreCat&&window.cscoreCat.toLowerCase(),sub2site=pageLevelParams.s1.replace('_',''),sub3site=subsite==='lifestyle'&&window.cityShort;initialized=true;log(['initialize'],'debug',logGroup);setVars({SOI_SITE:'wikia',SOI_SUBSITE:subsite,SOI_SUB2SITE:sub2site,SOI_SUB3SITE:sub3site,SOI_CONTENT:'content',SOI_WERBUNG:true});setVars({SOI_KEYVALUE:generateSoiKeyValue()});$postponedContainer=$('<div/>').attr('id',postponedContainerId).hide();$('body').append($postponedContainer);track('stage/init');injectJavaScripts(firstSlotname,function(){log('injectJavaScript success','info',logGroup);track('stage/scripts');$('head').append('<style>'+window.SEVENONEMEDIA_CSS+'</style>');$('#WikiaTopAds').hide();},function(what){log(['injectJavaScript failed',what],'error',logGroup);track('error/scripts1');});}
function flushAds(){if(!initialized){return;}
while(slotsQueue.length>0){insertAd(slotsQueue.shift());}}
function pushAd(slotname,params){log(['pushAd',slotname,params],'info',logGroup);if(!initialized){initialize(slotname);}
setVars(slotVars[slotname]);slotsQueue.push({slotname:slotname,params:params});}
function trackEnd(){log('trackEnd','info',logGroup);insertAd({slotname:'trackEnd',params:{afterFinish:function(){track('stage/ads');}}});}
return{pushAd:pushAd,flushAds:flushAds,trackEnd:trackEnd};};;var EvolveHelper=function(log,window){'use strict';var logGroup='EvolveHelper',getSect;getSect=function(){log('getSect',5,logGroup);var kv=window.wgDartCustomKeyValues||'',hub=window.cscoreCat||'',sect;if(window.wgDBname==='wikiaglobal'){sect='home';if(window.wgPageName==='Video_Games'){sect='gaming';}
if(window.wgPageName==='Entertainment'){sect='entertainment';}}else if(kv.indexOf('movie')!==-1){sect='movies';}else if(kv.indexOf('tv')!==-1){sect='tv';}else if(hub==='Entertainment'){sect='entertainment';}else if(hub==='Gaming'){sect='gaming';}else{sect='ros';}
log(sect,7,logGroup);return sect;};return{getSect:getSect};};;var AdProviderEvolve=function(adLogicPageLevelParamsLegacy,scriptWriter,adTracker,log,window,document,Krux,evolveHelper,slotTweaker){'use strict';var slotMap,logGroup='AdProviderEvolve',ord=Math.round(Math.random()*23456787654),slotForSkin='INVISIBLE_1',hoppedSlots={},slotTrackers={},iface,undef;slotMap={'HOME_TOP_LEADERBOARD':{'tile':1,'size':'728x90','dcopt':'ist'},'HOME_TOP_RIGHT_BOXAD':{'tile':2,'size':'300x250,300x600'},'HUB_TOP_LEADERBOARD':{'tile':1,'size':'728x90','dcopt':'ist'},'LEFT_SKYSCRAPER_2':{'tile':3,'size':'160x600'},'TOP_LEADERBOARD':{'tile':1,'size':'728x90','dcopt':'ist'},'TOP_RIGHT_BOXAD':{'tile':2,'size':'300x250,300x600'},'INVISIBLE_1':{'size':'0x0'}};function hasEmbed(slot){log(['hasEmbed',slot],5,logGroup);var embedNo=slot.getElementsByTagName('embed').length;log(['hasEmbed',slot,embedNo],5,logGroup);return!!embedNo;}
function getHeight(slot){var margins=0,height,undef;log(['getHeight',slot],5,logGroup);if(window.getComputedStyle){height=parseInt(window.getComputedStyle(slot).getPropertyValue('height'),10);log(['getHeight (regular browser version)',slot,height],5,logGroup);}
if(height===undef&&slot.currentStyle){margins+=parseInt('0'+slot.currentStyle.marginTop,10);margins+=parseInt('0'+slot.currentStyle.marginBottom,10);margins+=parseInt('0'+slot.currentStyle.paddingTop,10);margins+=parseInt('0'+slot.currentStyle.paddingBottom,10);height=slot.offsetHeight-margins;log(['getHeight (IE version)',slot,height],5,logGroup);}
return height;}
function getKv(slotname){var sect=evolveHelper.getSect();return sect+';'+'sect='+sect+';'+'mtfInline=true;'+'pos='+slotname+';'+'s1=_'+(window.wgDBname||'wikia').replace('/[^0-9A-Z_a-z]/','_')+';'+
adLogicPageLevelParamsLegacy.getCustomKeyValues()+
adLogicPageLevelParamsLegacy.getKruxKeyValues();}
function getReskinAndSilverScript(slotname){log('getReskinSilverScript',5,logGroup);var script='',kv=getKv(slotname);script+="getTrigger('8057');"+'\n';script+="if ((typeof(f406815)=='undefined' || f406815 > 0) ) {"+'\n';script+="document.write('<scr'+'ipt src=\"http://n4403ad.doubleclick.net/adj/gn.wikia4.com/";script+=kv+";sz=1000x1000;tile=1;ord="+ord+"?\" type=\"text/javascript\"></scr'+'ipt>');"+'\n';script+='}'+'\n';script+="if ((typeof(f406785)=='undefined' || f406785 > 0) ) {"+'\n';script+="document.write('<scr'+'ipt src=\"http://n4403ad.doubleclick.net/adj/gn.wikia4.com/";script+=kv+";sz=47x47;tile=2;ord="+ord+"?\" type=\"text/javascript\"></scr'+'ipt>');"+'\n';script+='}'+'\n';log(script,7,logGroup);return script;}
function getUrl(slotname){log('getUrl '+slotname,5,'AdProviderEvolve');var url,dcopt=slotMap[slotname].dcopt,size=slotMap[slotname].size,tile=slotMap[slotname].tile;url='http://'+'n4403ad'+'.doubleclick.net/'+'adj'+'/'+'gn.wikia4.com'+'/'+
getKv(slotname)+
adLogicPageLevelParamsLegacy.getDomainKV()+
adLogicPageLevelParamsLegacy.getHostnamePrefix()+'sz='+size+';'+
(dcopt?'dcopt='+dcopt+';':'')+'type=pop;type=int;'+'tile='+tile+';'+'ord='+ord+'?';log(url,7,'AdProviderEvolve');return url;}
function sanitizeSlotname(slotname){log('sanitizeSlotname',5,'AdProviderEvolve');log(slotname,5,'AdProviderEvolve');var re=new RegExp('[A-Z1-9_]+'),out=re.exec(slotname),undef;log(out,8,'AdProviderEvolve');if(out){out=out[0];}
if(slotMap[out]===undef){log('error, unknown slotname',1,'AdProviderEvolve');out='';}
log(out,7,'AdProviderEvolve');return out;}
function hop(slotname,method){method=method||'hop';log(['hop',slotname],5,'AdProviderEvolve');slotname=sanitizeSlotname(slotname);hoppedSlots[slotname]=true;slotTrackers[slotname].hop(method);window.adslots2.push([slotname,undef,'Liftium2Dom']);}
function fillInSlot(slot){log('fillInSlot',5,'AdProviderEvolve');log(slot,5,'AdProviderEvolve');var slotname=slot[0];slotTrackers[slotname]=adTracker.trackSlot('evolve',slotname);slotTrackers[slotname].init();if(slotname===slotForSkin){scriptWriter.injectScriptByUrl(slot[0],'http://cdn.triggertag.gorillanation.com/js/triggertag.js',function(){log('(invisible triggertag) ghostwriter done',5,logGroup);scriptWriter.injectScriptByText(slotname,getReskinAndSilverScript(slotname),function(){if(document.body.style.backgroundImage.search(/http:\/\/cdn\.assets\.gorillanation\.com/)!==-1){document.body.style.cssText=document.body.style.cssText.replace(document.body.style.backgroundImage,document.body.style.backgroundImage+' !important');document.body.style.cssText=document.body.style.cssText.replace(document.body.style.backgroundColor,document.body.style.backgroundColor+' !important');}});});}else{scriptWriter.injectScriptByUrl(slotname,getUrl(slotname),function(){var slot=document.getElementById(slotname),height;if(!hoppedSlots[slotname]){slotTweaker.removeDefaultHeight(slotname);height=getHeight(slot);if(height===undef||height>1||hasEmbed(slot)){slotTweaker.removeTopButtonIfNeeded(slotname);}else{slotTweaker.addDefaultHeight(slotname);log('Evolve did not hop, but returned 1x1 ad instead for slot '+slotname,1,'AdProviderEvolve');hop(slotname,'1x1');}}});}}
function canHandleSlot(slot){var slotname=slot[0];log('canHandleSlot',5,'AdProviderEvolve');log([slotname],5,'AdProviderEvolve');if(slotMap[slotname]){return true;}
if(slotname===slotForSkin){return true;}
return false;}
iface={name:'Evolve',fillInSlot:fillInSlot,canHandleSlot:canHandleSlot,hop:hop};if(window.wgInsideUnitTest){iface.sanitizeSlotname=sanitizeSlotname;iface.getUrl=getUrl;}
return iface;};;var AdProviderGamePro=function(adLogicPageLevelParamsLegacy,ScriptWriter,adTracker,log,window,slotTweaker){'use strict';var ord=Math.round(Math.random()*23456787654),slotMap={'HOME_TOP_LEADERBOARD':{'size':'728x90','tile':1,'pos':'leadfull','dcopt':'ist'},'HOME_TOP_RIGHT_BOXAD':{'size':'300x250,300x600','tile':3,'pos':'mpu'},'HUB_TOP_LEADERBOARD':{'size':'728x90','tile':1,'pos':'leadfull','dcopt':'ist'},'LEFT_SKYSCRAPER_2':{'size':'160x600','tile':2,'pos':'sky'},'PREFOOTER_LEFT_BOXAD':{'size':'300x250','tile':4,'pos':'mpu2'},'TOP_LEADERBOARD':{'size':'728x90','tile':1,'pos':'leadfull','dcopt':'ist'},'TOP_RIGHT_BOXAD':{'size':'300x250,300x600','tile':3,'pos':'mpu'}};function canHandleSlot(slot){var slotname=slot[0];log('canHandleSlot',5,'AdProviderGamePro');log([slotname],5,'AdProviderGamePro');if(slotMap[slotname]){return true;}
return false;}
function getUrl(slotname){log(['getUrl',slotname],5,'AdProviderGamePro');var url='http://ad-emea.doubleclick.net/N7503/adj/DE-OW-netzwerk/wikia;'+'s1='+'_'+window.wgDBname+';'+'pos='+slotMap[slotname].pos+';'+
adLogicPageLevelParamsLegacy.getCustomKeyValues()+'tile='+slotMap[slotname].tile+';'+
(slotMap[slotname].dcopt?'dcopt='+slotMap[slotname].dcopt+';':'')+'sz='+slotMap[slotname].size+';'+'ord='+ord+'?';log(url,7,'AdProviderGamePro');return url;}
function fillInSlot(slot){log('fillInSlot',5,'AdProviderGamePro');log(slot,5,'AdProviderGamePro');var slotname=slot[0];adTracker.trackSlot('gamepro',slotname).init();ScriptWriter.injectScriptByUrl(slotname,getUrl(slotname),function(){slotTweaker.removeTopButtonIfNeeded(slotname);slotTweaker.removeDefaultHeight(slotname);});}
return{name:'GamePro',fillInSlot:fillInSlot,canHandleSlot:canHandleSlot};};;var AdProviderSevenOneMedia=function(log,window,adTracker,$,sevenOneMedia){'use strict';var logGroup='AdProviderSevenOneMedia',slotMap={TOP_RIGHT_BOXAD:'rectangle1',HOME_TOP_RIGHT_BOXAD:'rectangle1',TOP_LEADERBOARD:'topAds',HOME_TOP_LEADERBOARD:'topAds',HUB_TOP_LEADERBOARD:'topAds',SEVENONEMEDIA_FLUSH:'trackEnd'};function canHandleSlot(slot){log(['canHandleSlot',slot],'debug',logGroup);var slotname=slot[0];if(slotMap[slotname]){log(['canHandleSlot',slot,true],'debug',logGroup);return true;}
log(['canHandleSlot',slot,false],'debug',logGroup);return false;}
function makeTopAds(){$('#TOP_BUTTON_WIDE').remove();$('#WikiaTopAds').after(['<div id="ads-outer" class="noprint">',' <div id="ad-popup1" class="ad-wrapper"></div>',' <div id="TOP_BUTTON_WIDE"></div>',' <div id="ad-fullbanner2-outer">','  <div id="ad-fullbanner2" class="ad-wrapper" style="visibility: hidden"></div>',' </div>',' <div id="ad-skyscraper1-outer">','  <div id="ad-skyscraper1" class="ad-wrapper" style="display: none"></div>',' </div>','</div>'].join(''));}
function handleTopButton(info){if(info.slotname==='fullbanner2'&&!info.isSpecialAd){log('fullbanner2 is not a special ad','debug',logGroup);var $slot=$('#ad-fullbanner2'),height=$slot.height(),width=$slot.width();if(height>=90&&height<=95&&width===728){log('fullbanner2 has standard size, enabling TOP_BUTTON_WIDE','debug',logGroup);window.adslots2.push(['TOP_BUTTON_WIDE.force']);}}}
function fillInSlot(slot){log(['fillInSlot',slot],'info',logGroup);var slotname=slot[0],slotDeName=slotMap[slotname],$slot,slotTracker=adTracker.trackSlot('sevenonemedia',slotname);function clearDefaultHeight(){$('#'+slotname).removeClass('default-height');}
slotTracker.init();if(slotDeName==='topAds'){makeTopAds();sevenOneMedia.pushAd('popup1');sevenOneMedia.pushAd('fullbanner2',{afterFinish:handleTopButton});sevenOneMedia.pushAd('skyscraper1',{afterFinish:slotTracker.success});sevenOneMedia.flushAds();}
if(slotDeName.match(/^(rectangle1|promo[123])$/)){$slot=$('<div class="ad-wrapper" style="display: none"></div>');$slot.attr('id','ad-'+slotDeName);$('#'+slotname).append($slot);sevenOneMedia.pushAd(slotDeName,{beforeFinish:clearDefaultHeight,afterFinish:slotTracker.success});sevenOneMedia.flushAds();}
if(slotDeName==='trackEnd'){sevenOneMedia.trackEnd(slotname);}}
return{name:'SevenOneMedia',fillInSlot:fillInSlot,canHandleSlot:canHandleSlot};};;var AdProviderGpt=function(adTracker,log,window,Geo,slotTweaker,cacheStorage,adLogicHighValueCountry,wikiaGpt){'use strict';var logGroup='AdProviderGpt',slotMap,forgetAdsShownAfterTime=3600,country=Geo.getCountryCode(),now=window.wgNow||new Date(),maxCallsToDART,isHighValueCountry,leaderboardCalled=false,gptConfig,gptFlushed=false;maxCallsToDART=adLogicHighValueCountry.getMaxCallsToDART(country);isHighValueCountry=adLogicHighValueCountry.isHighValueCountry(country);slotMap={'CORP_TOP_LEADERBOARD':{'size':'728x90,1030x130,1030x65,1030x250,970x250,970x90,970x66','tile':2,'loc':'top','dcopt':'ist'},'CORP_TOP_RIGHT_BOXAD':{'size':'300x250,300x600,300x1050','tile':1,'loc':'top'},'EXIT_STITIAL_BOXAD_1':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'exit'},'HOME_TOP_LEADERBOARD':{'size':'728x90,1030x130,1030x65,1030x250,970x250,970x90,970x66','tile':2,'loc':'top','dcopt':'ist'},'HOME_TOP_RIGHT_BOXAD':{'size':'300x250,300x600,300x1050','tile':1,'loc':'top'},'HUB_TOP_LEADERBOARD':{'size':'728x90,1030x130,1030x65,1030x250,970x250,970x90,970x66','tile':2,'loc':'top','dcopt':'ist'},'INVISIBLE_SKIN':{'size':'1x1','loc':'top','gptOnly':true},'LEFT_SKYSCRAPER_2':{'size':'160x600','tile':3,'loc':'middle'},'LEFT_SKYSCRAPER_3':{'size':'160x600','tile':6,'loc':'footer'},'MODAL_INTERSTITIAL':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'modal'},'MODAL_INTERSTITIAL_1':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'modal'},'MODAL_INTERSTITIAL_2':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'modal'},'MODAL_INTERSTITIAL_3':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'modal'},'MODAL_INTERSTITIAL_4':{'size':'300x250,600x400,800x450,550x480','tile':2,'loc':'modal'},'MODAL_RECTANGLE':{'size':'300x100','tile':2,'loc':'modal'},'TEST_TOP_RIGHT_BOXAD':{'size':'300x250,300x600,300x1050','tile':1,'loc':'top'},'TEST_HOME_TOP_RIGHT_BOXAD':{'size':'300x250,300x600,300x1050','tile':1,'loc':'top'},'TOP_LEADERBOARD':{'size':'728x90,1030x130,1030x65,1030x250,970x250,970x90,970x66','tile':2,'loc':'top','dcopt':'ist'},'TOP_RIGHT_BOXAD':{'size':'300x250,300x600,300x1050','tile':1,'loc':'top'},'WIKIA_BAR_BOXAD_1':{'size':'320x50,320x70,320x100','tile':4,'loc':'bottom'},'GPT_FLUSH':'flushonly'};gptConfig={CORP_TOP_LEADERBOARD:'wait',HUB_TOP_LEADERBOARD:'wait',TOP_LEADERBOARD:'wait',HOME_TOP_LEADERBOARD:'wait',INVISIBLE_SKIN:'wait',CORP_TOP_RIGHT_BOXAD:'flush',TOP_RIGHT_BOXAD:'flush',HOME_TOP_RIGHT_BOXAD:'flush',GPT_FLUSH:'flushonly'};wikiaGpt.init(slotMap);function incrementItemInStorage(storageKey){log('incrementItemInStorage '+storageKey,5,logGroup);var numCallForSlot=cacheStorage.get(storageKey,now)||0;numCallForSlot+=1;cacheStorage.set(storageKey,numCallForSlot,forgetAdsShownAfterTime,now);return numCallForSlot;}
function canHandleSlot(slotinfo){log(['canHandleSlot',slotinfo],5,logGroup);return!!slotMap[slotinfo[0]];}
function flushGpt(){log('flushGpt',5,logGroup);gptFlushed=true;wikiaGpt.flushAds();}
function fillInSlot(slot){log(['fillInSlot',slot],5,logGroup);if(gptConfig[slot[0]]==='flushonly'){flushGpt();return;}
var slotname=slot[0],noAdStorageKey='dart_noad_'+slotname,numCallForSlotStorageKey='dart_calls_'+slotname,noAdLastTime=cacheStorage.get(noAdStorageKey,now)||false,numCallForSlot=cacheStorage.get(numCallForSlotStorageKey,now)||0,dontCallDart=false,slotTracker=adTracker.trackSlot('addriver2',slotname),error=function(){log(slotname+' was not filled by DART',2,logGroup);cacheStorage.set(noAdStorageKey,true,forgetAdsShownAfterTime,now);if(isHighValueCountry&&!dontCallDart){slotTracker.hop();}
slot[2]='Liftium2';window.adslots2.push(slot);},success=function(){slotTweaker.removeDefaultHeight(slotname);slotTweaker.removeTopButtonIfNeeded(slotname);slotTweaker.adjustLeaderboardSize(slotname);if(slotname.search('LEADERBOARD')>-1){slotTracker.success();}};if(!isHighValueCountry){error();return;}
if(slotname==='INVISIBLE_SKIN'){if(!leaderboardCalled){dontCallDart=true;}}else if(!slotname.match(/^MODAL_INTERSTITIAL/)){if(noAdLastTime&&numCallForSlot>=maxCallsToDART){log('There was no ad for this slot last time and reached max number of calls to DART',5,logGroup);log({slot:slotname,numCalls:numCallForSlot,maxCalls:maxCallsToDART,geo:country},6,logGroup);dontCallDart=true;}}
if(dontCallDart){if(gptConfig[slotname]==='flush'){flushGpt();}
error();return;}
if(slotname.search('LEADERBOARD')>-1){leaderboardCalled=true;}
incrementItemInStorage(numCallForSlotStorageKey);cacheStorage.del(noAdStorageKey);slotTracker.init();wikiaGpt.pushAd(slotname,success,error);if(gptConfig[slotname]==='flush'||gptFlushed){flushGpt();}}
return{name:'Gpt',fillInSlot:fillInSlot,canHandleSlot:canHandleSlot};};;var AdProviderLater=function(log,queueForLateAds){'use strict';var fillInSlot=function(slot){log('fillInSlot',5,'AdProviderLater');log(slot,5,'AdProviderLater');queueForLateAds.push(slot);};return{name:'Later',fillInSlot:fillInSlot};};;var AdProviderNull=function(log,slotTweaker){var module='AdProviderNull',canHandleSlot,fillInSlot;canHandleSlot=function(slot){return true;};fillInSlot=function(slot){var slotname=slot[0];log('fillInSlot',5,module);log(slot,7,module);slotTweaker.hide(slotname);return;};return{name:'Null',canHandleSlot:canHandleSlot,fillInSlot:fillInSlot};};;define('ext.wikia.adengine.template.skin',['wikia.document','wikia.window','wikia.log','wikia.backgroundchanger'],function(document,window,log,backgroundchanger)
{'use strict';var logGroup='ext.wikia.adengine.template.skin';function show(params){log(params,'debug',logGroup);var adSkin=document.getElementById('ad-skin'),adSkinStyle=adSkin.style,wikiaSkin=document.getElementById('WikiaPageBackground'),wikiaSkinStyle=wikiaSkin.style,i,len,pixelElement,pixelUrl,bcParams;params=params||{};if(window.wgOasisResponsive){bcParams={skinImage:params.skinImage,skinImageWidth:1700,skinImageHeight:800,backgroundTiled:false,backgroundFixed:true,backgroundDynamic:true};if(params.backgroundColor){bcParams.backgroundColor='#'+params.backgroundColor;}
if(params.middleColor){bcParams.backgroundMiddleColor='#'+params.middleColor;}
backgroundchanger.load(bcParams);}else{adSkinStyle.background='url("'+params.skinImage+'") no-repeat top center #'+params.backgroundColor;}
adSkinStyle.position='fixed';adSkinStyle.height='100%';adSkinStyle.width='100%';adSkinStyle.left=0;adSkinStyle.top=0;adSkinStyle.zIndex=0;adSkinStyle.cursor='pointer';wikiaSkinStyle.opacity=1;adSkin.onclick=function(){log('Click on skin','user',logGroup);window.open(params.destUrl);};window.wgAdSkinPresent=true;log('Skin set',5,logGroup);if(params.pixels){for(i=0,len=params.pixels.length;i<len;i+=1){pixelUrl=params.pixels[i];if(pixelUrl){log('Adding tracking pixel '+pixelUrl,'debug',logGroup);pixelElement=document.createElement('img');pixelElement.src=pixelUrl;pixelElement.width=1;pixelElement.height=1;adSkin.appendChild(pixelElement);}}}
log('Pixels added','debug',logGroup);}
return{show:show};});;var AdLogicDartSubdomain=function(Geo){'use strict';function getSubdomain(){switch(Geo.getContinentCode()){case'AF':case'EU':return'ad-emea';case'AS':switch(Geo.getCountryCode()){case'AE':case'CY':case'BH':case'IL':case'IQ':case'IR':case'JO':case'KW':case'LB':case'OM':case'PS':case'QA':case'SA':case'SY':case'TR':case'YE':return'ad-emea';default:return'ad-apac';}
case'OC':return'ad-apac';default:return'ad';}}
return{getSubdomain:getSubdomain};};(function(context){'use strict';if(context.define&&context.define.amd){context.define('ext.wikia.adengine.adlogic.subdomain',['wikia.geo'],context.AdLogicDartSubdomain);}}(this));;var AdLogicHighValueCountry=function(window){'use strict';var highValueCountries,defaultHighValueCountries,isHighValueCountry,getMaxCallsToDART;defaultHighValueCountries={'CA':3,'DE':3,'DK':3,'ES':3,'FI':3,'FR':3,'GB':3,'IT':3,'NL':3,'NO':3,'SE':3,'UK':3,'US':3};highValueCountries=window.wgHighValueCountries||defaultHighValueCountries;isHighValueCountry=function(country){if(country&&highValueCountries){return!!highValueCountries[country.toUpperCase()];}
return false;};getMaxCallsToDART=function(country){if(country&&highValueCountries){return highValueCountries[country.toUpperCase()]||0;}
return false;};return{isHighValueCountry:isHighValueCountry,getMaxCallsToDART:getMaxCallsToDART};};;var AdLogicPageLevelParams=function(log,window,Krux,adLogicPageDimensions,abTest){'use strict';var logGroup='AdLogicPageLevelParams',hostname=window.location.hostname.toString(),maxNumberOfCategories=3,maxNumberOfKruxSegments=27;function getDartHubName(){if(window.cscoreCat==='Entertainment'){return'ent';}
if(window.cscoreCat==='Gaming'){return'gaming';}
return'life';}
function getDomain(){var lhost,pieces,sld='',np;lhost=hostname.toLowerCase();pieces=lhost.split('.');np=pieces.length;if(pieces[np-2]==='co'){sld=pieces[np-3]+'.'+pieces[np-2]+'.'+pieces[np-1];}else{sld=pieces[np-2]+'.'+pieces[np-1];}
return sld.replace(/\./g,'');}
function getHostname(){var lhost=hostname.toLowerCase(),pieces=lhost.split('.');if(pieces.length){return pieces[0];}}
function getCategories(){if(window.wgCategories instanceof Array&&window.wgCategories.length>0){var categories=window.wgCategories.slice(0,maxNumberOfCategories);return categories.join('|').toLowerCase().replace(/ /g,'_').split('|');}}
function getAb(){var experiments,experimentsNumber,i,ab=[];if(abTest){experiments=abTest.getExperiments();experimentsNumber=experiments.length;for(i=0;i<experimentsNumber;i+=1){ab.push(experiments[i].id+'_'+experiments[i].group.id);}}
return ab;}
function extend(target,obj){var key;for(key in obj){if(obj.hasOwnProperty(key)){target[key]=obj[key];}}
return target;}
function decodeLegacyDartParams(dartString){var params={},kvs,kv,key,value,i,len;log(['decodeLegacyDartParams',dartString],9,logGroup);if(typeof dartString==='string'){kvs=dartString.split(';');for(i=0,len=kvs.length;i<len;i+=1){kv=kvs[i].split('=');key=kv[0];value=kv[1];params[key]=params[key]||[];params[key].push(value);}}
return params;}
function getPageLevelParams(){log('getPageLevelParams',9,logGroup);var site,zone1,zone2,params;if(window.wikiaPageIsHub){site='hub';zone1='_'+getDartHubName()+'_hub';zone2='hub';}else{site=window.cityShort;zone1='_'+(window.wgDBname||'wikia').replace('/[^0-9A-Z_a-z]/','_');zone2=window.wikiaPageType||'article';}
params={s0:site,s1:zone1,s2:zone2,artid:window.wgArticleId&&window.wgArticleId.toString(),dmn:getDomain(),hostpre:getHostname(),wpage:window.wgPageName&&window.wgPageName.toLowerCase(),lang:window.wgContentLanguage||'unknown',cat:getCategories(),ab:getAb()};if(adLogicPageDimensions&&adLogicPageDimensions.hasPreFooters()){params.hasp='yes';}else{params.hasp='no';}
if(Krux&&!window.wgWikiDirectedAtChildren){params.u=Krux.user;params.ksgmnt=Krux.segments&&Krux.segments.slice(0,maxNumberOfKruxSegments);}
extend(params,decodeLegacyDartParams(window.wgDartCustomKeyValues));extend(params,decodeLegacyDartParams(window.amzn_targs));log(params,9,logGroup);return params;}
return{getPageLevelParams:getPageLevelParams};};(function(context){'use strict';if(context.define&&context.define.amd){context.define('wikia.adlogicpageparams',['wikia.log','wikia.window'],AdLogicPageLevelParams);}}(this));;var AdLogicPageLevelParamsLegacy=function(log,window,adLogicPageLevelParams,Krux,dartUrl){'use strict';var logGroup='AdLogicPageLevelParamsLegacy',pageParams=adLogicPageLevelParams.getPageLevelParams(),getCustomKeyValues,getDomainKV,getHostnamePrefix,getKruxKeyValues;getCustomKeyValues=function(){if(window.wgDartCustomKeyValues){return dartUrl.trimParam(window.wgDartCustomKeyValues+';');}
return'';};getDomainKV=function(){return dartUrl.decorateParam('dmn',pageParams.dmn);};getHostnamePrefix=function(){return dartUrl.decorateParam('hostpre',pageParams.hostpre);};getKruxKeyValues=function(){if(Krux&&Krux.dartKeyValues){return dartUrl.trimParam(Krux.dartKeyValues);}
return'';};return{getCustomKeyValues:getCustomKeyValues,getDomainKV:getDomainKV,getHostnamePrefix:getHostnamePrefix,getKruxKeyValues:getKruxKeyValues};};;var AdLogicPageDimensions=function(window,document,log,slotTweaker){'use strict';var logGroup='ext.wikia.adengine.logic.shortpage',initCalled=false,wrappedAds={},preFootersThreshold=2400,slotsOnlyOnLongPages={LEFT_SKYSCRAPER_2:2400,LEFT_SKYSCRAPER_3:4000,PREFOOTER_LEFT_BOXAD:preFootersThreshold,PREFOOTER_RIGHT_BOXAD:preFootersThreshold},pageHeight,mediaQueriesToCheck={oneColumn:'screen and (max-width: 1023px)',noTopButton:'screen and (max-width: 1030px)',noSkins:'screen and (max-width: 1260px)'},slotsToHideOnMediaQuery={TOP_BUTTON_WIDE:'noTopButton','TOP_BUTTON_WIDE.force':'noTopButton',TOP_RIGHT_BOXAD:'oneColumn',HOME_TOP_RIGHT_BOXAD:'oneColumn',LEFT_SKYSCRAPER_2:'oneColumn',LEFT_SKYSCRAPER_3:'oneColumn',INCONTENT_BOXAD_1:'oneColumn',INVISIBLE_SKIN:'noSkins'},mediaQueriesMet,matchMedia;function matchMediaMoz(query){return window.matchMedia(query).matches;}
function matchMediaIe(query){return window.styleMedia.matchMedium(query);}
matchMedia=window.matchMedia&&matchMediaMoz;matchMedia=matchMedia||(window.styleMedia&&window.styleMedia.matchMedium&&matchMediaIe);matchMedia=matchMedia||(window.media&&window.media.matchMedium);if(!matchMedia){log('No working matchMedia implementation found','user',logGroup);}
function shouldBeShown(slotname){var longEnough=false,wideEnough=false,conflictingMediaQuery;if(pageHeight){longEnough=!slotsOnlyOnLongPages[slotname]||pageHeight>slotsOnlyOnLongPages[slotname];}
if(mediaQueriesMet){if(slotsToHideOnMediaQuery[slotname]){conflictingMediaQuery=slotsToHideOnMediaQuery[slotname];wideEnough=!mediaQueriesMet[conflictingMediaQuery];}else{wideEnough=true;}}
return longEnough&&wideEnough;}
function refresh(ad){if(shouldBeShown(ad.slotname)){if(ad.state==='none'||ad.state==='ready'){log(['Loading ad in slot '+ad.slotname,ad],'info',logGroup);slotTweaker.show(ad.slotname,true);ad.provider.fillInSlot(ad.slotinfo);ad.state='shown';}else if(ad.state==='hidden'){log(['Reshowing slot '+ad.slotname,ad],'info',logGroup);slotTweaker.show(ad.slotname,true);ad.state='shown';}}else{if(ad.state==='none'){log(['Hiding empty slot '+ad.slotname,ad],'info',logGroup);slotTweaker.hide(ad.slotname,true);ad.state='ready';}else if(ad.state==='shown'){log(['Hiding slot '+ad.slotname,ad],'info',logGroup);slotTweaker.hide(ad.slotname,true);ad.state='hidden';}}}
function add(slotname,slotinfo,provider){log(['add',slotname,slotinfo,provider],'debug',logGroup);wrappedAds[slotname]={slotname:slotname,state:'none',slotinfo:slotinfo,provider:provider};refresh(wrappedAds[slotname]);}
function onResize(){var slotname,mediaQueryIndex;pageHeight=document.documentElement.scrollHeight;if(window.wgOasisResponsive){if(matchMedia){mediaQueriesMet={};for(mediaQueryIndex in mediaQueriesToCheck){if(mediaQueriesToCheck.hasOwnProperty(mediaQueryIndex)){mediaQueriesMet[mediaQueryIndex]=matchMedia(mediaQueriesToCheck[mediaQueryIndex]);}}}}else{mediaQueriesMet={};for(mediaQueryIndex in mediaQueriesToCheck){if(mediaQueriesToCheck.hasOwnProperty(mediaQueryIndex)){mediaQueriesMet[mediaQueryIndex]=false;}}}
for(slotname in wrappedAds){if(wrappedAds.hasOwnProperty(slotname)){refresh(wrappedAds[slotname]);}}}
function init(){log('init','debug',logGroup);if(window.addEventListener){onResize();window.addEventListener('resize',onResize);}else{log('No support for addEventListener. No dimension-dependent ads will be shown','error',logGroup);}}
function isApplicable(slotinfo){log(['isApplicable',slotinfo],'debug',logGroup);var slotname=slotinfo[0];return!!(slotsOnlyOnLongPages[slotname]||slotsToHideOnMediaQuery[slotname]);}
function hasPreFooters(){log('hasPreFooters','debug',logGroup);return pageHeight<preFootersThreshold;}
function getProxy(provider){log(['getProxy',provider],'debug',logGroup);function canHandleSlot(slotinfo){log(['canHandleSlot',slotinfo,provider],'debug',logGroup);return provider.canHandleSlot(slotinfo);}
function fillInSlot(slotinfo){log(['fillInSlot',slotinfo,provider],'debug',logGroup);var slotname=slotinfo[0];add(slotname,slotinfo,provider);}
if(!initCalled){initCalled=true;init();}
return{name:'WindowSizeProviderProxy',wrappedProvider:provider,canHandleSlot:canHandleSlot,fillInSlot:fillInSlot};}
return{isApplicable:isApplicable,hasPreFooters:hasPreFooters,getProxy:getProxy};};;var AdConfig2=function(log,window,document,Geo,adLogicPageDimensions,abTest,adProviderGpt,adProviderEvolve,adProviderGamePro,adProviderLater,adProviderNull){'use strict';var logGroup='AdConfig2',cityLang=window.wgContentLanguage,country=Geo.getCountryCode(),defaultHighValueSlots,highValueSlots,useSevenOneMedia=window.wgAdDriverUseSevenOneMedia;defaultHighValueSlots={'CORP_TOP_LEADERBOARD':true,'CORP_TOP_RIGHT_BOXAD':true,'EXIT_STITIAL_BOXAD_1':true,'HOME_TOP_LEADERBOARD':true,'HOME_TOP_RIGHT_BOXAD':true,'HUB_TOP_LEADERBOARD':true,'INVISIBLE_SKIN':true,'LEFT_SKYSCRAPER_2':true,'MIDDLE_RIGHT_BOXAD':true,'MODAL_RECTANGLE':true,'MODAL_INTERSTITIAL':true,'MODAL_INTERSTITIAL_1':true,'MODAL_INTERSTITIAL_2':true,'MODAL_INTERSTITIAL_3':true,'MODAL_INTERSTITIAL_4':true,'TEST_HOME_TOP_RIGHT_BOXAD':true,'TEST_TOP_RIGHT_BOXAD':true,'TOP_LEADERBOARD':true,'TOP_RIGHT_BOXAD':true,'WIKIA_BAR_BOXAD_1':true,'GPT_FLUSH':true};highValueSlots=defaultHighValueSlots;function getBackEndProvider(slot){var slotname=slot[0];log('getProvider',5,logGroup);log(slot,5,logGroup);if(slot[2]==='GamePro'){return adProviderGamePro;}
if(slot[2]==='Evolve'){return adProviderEvolve;}
if(slot[2]==='AdDriver2'){return adProviderGpt;}
if(slot[2]==='AdDriver'){return adProviderGpt;}
if(slot[2]==='Liftium2'){return adProviderLater;}
if(slot[2]==='Liftium2Dom'){return adProviderLater;}
if(slotname==='WIKIA_BAR_BOXAD_1'&&adProviderGpt.canHandleSlot(slot)){return adProviderGpt;}
if(useSevenOneMedia){return adProviderLater;}
if(highValueSlots[slotname]){if(cityLang==='de'){if(adProviderGamePro.canHandleSlot(slot)){return adProviderGamePro;}}}
if(country==='AU'||country==='CA'||country==='NZ'){if(adProviderEvolve.canHandleSlot(slot)){return adProviderEvolve;}}
if(highValueSlots[slotname]&&adProviderGpt.canHandleSlot(slot)){return adProviderGpt;}
return adProviderLater;}
function getProvider(slot){var provider=getBackEndProvider(slot);if(provider===adProviderNull){return provider;}
if(provider!==adProviderNull&&adLogicPageDimensions.isApplicable(slot)){return adLogicPageDimensions.getProxy(provider);}
return provider;}
return{getProvider:getProvider};};;(function(log,tracker,window,document,Geo,LazyQueue,Cookies,Cache,Krux,abTest){'use strict';var module='AdEngine2.run',adConfig,adEngine,adTracker,adLogicDartSubdomain,adLogicHighValueCountry,adLogicPageLevelParams,adLogicPageLevelParamsLegacy,adLogicPageDimensions,scriptWriter,dartUrl,wikiaDart,wikiaFullGpt,evolveHelper,adProviderGpt,adProviderEvolve,adProviderGamePro,adProviderLater,adProviderNull,slotTweaker,queueForLateAds,adConfigForLateAds,ie8=window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.match(/MSIE [6-8]\./);window.wgAdDriverUseSevenOneMedia=!ie8&&window.wgAdDriverUseSevenOneMedia&&abTest.inGroup('SEVENONEMEDIA_ADS','ENABLED');window.wgUsePostScribe=window.wgUsePostScribe||window.wgAdDriverUseSevenOneMedia;if(window.wgUsePostScribe){window.wgEnableKruxTargeting=false;}
adEngine=AdEngine2(log,LazyQueue);adTracker=AdTracker(log,tracker);slotTweaker=SlotTweaker(log,document,window);dartUrl=DartUrl();adLogicDartSubdomain=AdLogicDartSubdomain(Geo);adLogicHighValueCountry=AdLogicHighValueCountry(window);adLogicPageDimensions=AdLogicPageDimensions(window,document,log,slotTweaker);adLogicPageLevelParams=AdLogicPageLevelParams(log,window,Krux,adLogicPageDimensions,abTest);adLogicPageLevelParamsLegacy=AdLogicPageLevelParamsLegacy(log,window,adLogicPageLevelParams,Krux,dartUrl);scriptWriter=ScriptWriter(document,log,window);wikiaDart=WikiaDartHelper(log,adLogicPageLevelParams,dartUrl,adLogicDartSubdomain);wikiaFullGpt=WikiaFullGptHelper(log,window,document,adLogicPageLevelParams);evolveHelper=EvolveHelper(log,window);adProviderGpt=AdProviderGpt(adTracker,log,window,Geo,slotTweaker,Cache,adLogicHighValueCountry,wikiaFullGpt);adProviderEvolve=AdProviderEvolve(adLogicPageLevelParamsLegacy,scriptWriter,adTracker,log,window,document,Krux,evolveHelper,slotTweaker);adProviderGamePro=AdProviderGamePro(adLogicPageLevelParamsLegacy,scriptWriter,adTracker,log,window,slotTweaker);adProviderNull=AdProviderNull(log,slotTweaker);queueForLateAds=[];adProviderLater=AdProviderLater(log,queueForLateAds);adConfig=AdConfig2(log,window,document,Geo,adLogicPageDimensions,abTest,adProviderGpt,adProviderEvolve,adProviderGamePro,adProviderLater,adProviderNull);window.wgAfterContentAndJS.push(function(){log('work on window.adslots2 according to AdConfig2',1,module);tracker.track({eventName:'liftium.init',ga_category:'init2/init',ga_action:'init',ga_label:'adengine2',trackingMethod:'ad'});window.adslots2=window.adslots2||[];adEngine.run(adConfig,window.adslots2);});window.LiftiumDART={getUrl:function(slotname,slotsize){return wikiaDart.getUrl({slotname:slotname,slotsize:slotsize,adType:'adi',src:'liftium'});}};window.evolve_hop=function(slotname){adProviderEvolve.hop(slotname);};window.AdEngine_setLateAdsConfig=function(adConfig){adConfigForLateAds=adConfig;};window.AdEngine_loadLateAds=function(){if(adConfigForLateAds){log('launching late ads now',1,module);log('work on queueForLateAds according to AdConfig2Late',1,module);tracker.track({eventName:'liftium.init',ga_category:'init2/init',ga_action:'init',ga_label:'adengine2 late',trackingMethod:'ad'});adEngine.run(adConfigForLateAds,queueForLateAds);}else{log('ERROR, AdEngine_loadLateAds called before AdEngine_setLateConfig!',1,module);tracker.track({eventName:'liftium.errors',ga_category:'errors2/no_late_config',ga_action:'no_late_config',ga_label:'adengine2 late',trackingMethod:'ad'});}};window.AdEngine_loadKruxLater=function(Krux){if(window.wgAdsShowableOnPage){scriptWriter.callLater(function(){log('Loading Krux code',8,module);Krux.load(window.wgKruxCategoryId);});}};window.wikiaDartHelper=wikiaDart;window.loadCustomAd=function(params){log('loadCustomAd','debug',module);var adModule='ext.wikia.adengine.template.'+params.type;log('loadCustomAd: loading '+adModule,'debug',module);require([adModule],function(adTemplate){log('loadCustomAd: module '+adModule+' required','debug',module);adTemplate.show(params);});};}(Wikia.log,Wikia.Tracker,window,document,Geo,Wikia.LazyQueue,Wikia.Cookies,Wikia.Cache,Krux,Wikia.AbTest));;

jQuery.fn.placeholder=function(){var a="placeholder" in document.createElement("input");return this.each(function(){if(a){return}var b=$(this);var c=b.attr("placeholder");if(b.val()==""){b.addClass("placeholder").val(c)}b.focus(function(){if(b.val()==c){b.val("")}b.removeClass("placeholder")});b.blur(function(){if(b.val()==""){b.addClass("placeholder").val(c)}});b.closest("form").submit(function(){if(b.val()==c){b.val("")}})})};$(function(){$("input[placeholder], textarea[placeholder]").placeholder()});(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d,c){var b,a;c=c||0;for(b=c,a=this.length;b<a;b++){if(this[b]===d){return b}}return -1}}if(!Array.prototype.filter){Array.prototype.filter=function(b,e){var d,a,c=[];for(d=0,a=this.length;d<a;d++){if(b.call(e,this[d],d,this)){c[c.length]=this[d]}}return c}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(c){if(this==null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var e=a;if(arguments.length>1){e=Number(arguments[1]);if(e!=e){e=0}else{if(e!=0&&e!=(1/0)&&e!=-(1/0)){e=(e>0||-1)*Math.floor(Math.abs(e))}}}var b=e>=0?Math.min(e,a-1):a-Math.abs(e);for(;b>=0;b--){if(b in d&&d[b]===c){return b}}return -1}}}());(function(f,b,g){var d=b.getElementsByTagName("head")[0],a=/loaded|complete/,e={},c=0,h;g.getCSS=function(k,j,m){if(g.isFunction(j)){m=j;j={}}var l=b.createElement("link");l.rel="stylesheet";l.type="text/css";l.media=j.media||"screen";l.href=k;if(j.charset){l.charset=j.charset}if(j.title){m=(function(n){return function(){l.title=j.title;n(l,"success")}})(m)}if(l.readyState){l.onreadystatechange=function(){if(a.test(l.readyState)){l.onreadystatechange=null;m(l,"success")}}}else{if(l.onload===null&&l.all){l.onload=function(){l.onload=null;m(l,"success")}}else{e[l.href]=function(){m(l,"success")};if(!c++){h=f.setInterval(function(){var s,p,r=b.styleSheets,n,o=r.length;while(o--){p=r[o];if((n=p.href)&&(s=e[n])){try{s.r=p.cssRules;throw"SECURITY"}catch(q){if(/SECURITY/.test(q)||/SECURITY/i.test(q.name)){s(l,"success");delete e[n];if(!--c){h=f.clearInterval(h)}}}}}},13)}}}d.appendChild(l)}})(this,this.document,this.jQuery);var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{};jaaulde.utils.cookies=(function(){var d=[];var b={hoursToLive:null,path:"/",domain:null,secure:false};var g=function(h){var j;if(typeof h!=="object"||h===null){j=b}else{j={hoursToLive:(typeof h.hoursToLive==="number"&&h.hoursToLive!==0?h.hoursToLive:b.hoursToLive),path:(typeof h.path==="string"&&h.path!==""?h.path:b.path),domain:(typeof h.domain==="string"&&h.domain!==""?h.domain:b.domain),secure:(typeof h.secure==="boolean"&&h.secure?h.secure:b.secure)}}return j};var a=function(h){var j=new Date();j.setTime(j.getTime()+(h*60*60*1000));return j.toGMTString()};var f=function(h){h=g(h);return((typeof h.hoursToLive==="number"?"; expires="+a(h.hoursToLive):"")+"; path="+h.path+(typeof h.domain==="string"?"; domain="+h.domain:"")+(h.secure===true?"; secure":""))};var e=function(){d={};var m,j,l,h=document.cookie.split(";");for(var k=0;k<h.length;k=k+1){m=h[k].split("=");j=m[0].replace(/^\s*/,"").replace(/\s*$/,"");l=decodeURIComponent(m[1]);d[j]=l}return d};var c=function(){};c.prototype.get=function(k){var h;e();if(typeof k==="string"){h=(typeof d[k]!=="undefined")?d[k]:null}else{if(typeof k==="object"&&k!==null){h={};for(var j in k){if(typeof d[k[j]]!=="undefined"){h[k[j]]=d[k[j]]}else{h[k[j]]=null}}}else{h=d}}return h};c.prototype.filter=function(h){var j={};e();if(typeof h==="string"){h=new RegExp(h)}for(var k in d){if(k.match(h)){j[k]=d[k]}}return j};c.prototype.set=function(l,j,h){if(typeof j==="undefined"||j===null){if(typeof h!=="object"||h===null){h={}}j="";h.hoursToLive=-8760}var k=f(h);document.cookie=l+"="+encodeURIComponent(j)+k};c.prototype.del=function(l,k){var h={};if(typeof k!=="object"||k===null){k={}}if(typeof l==="boolean"&&l===true){h=this.get()}else{if(typeof l==="string"){h[l]=true}}for(var j in h){if(typeof j==="string"&&j!==""){this.set(j,null,k)}}};c.prototype.test=function(){var j=false,h="cT",k="data";this.set(h,k);if(this.get(h)===k){this.del(h);j=true}return j};c.prototype.setOptions=function(h){if(typeof h!=="object"){h=null}b=g(h)};return new c()})();(function(){if(window.jQuery){(function(b){b.cookies=jaaulde.utils.cookies;var a={cookify:function(c){return this.each(function(){var g,e=false,d=false,f="",k="",j=["name","id"],l,h;for(g in j){if(!isNaN(g)){f=b(this).attr(j[g]);if(typeof f==="string"&&f!==""){e=true;break}}}if(e){l=this.nodeName.toLowerCase();if(l!=="input"&&l!=="textarea"&&l!=="select"&&l!=="img"){k=b(this).html();d=true}else{h=b(this).attr("type");if(typeof h==="string"&&h!==""){h=h.toLowerCase()}if(h!=="radio"&&h!=="checkbox"){k=b(this).val();d=true}}if(d){if(typeof k!=="string"||k===""){k=null}b.cookies.set(f,k,c)}}})},cookieFill:function(){return this.each(function(){var e,c=false,d="",h,g=["name","id"],f=0,j;for(e in g){if(!isNaN(e)){d=b(this).attr(g[e]);if(typeof d==="string"&&d!==""){c=true;break}}}if(c){h=b.cookies.get(d);if(h!==null){j=this.nodeName.toLowerCase();if(j==="input"||j==="textarea"||j==="select"){b(this).val(h)}else{b(this).html(h)}}}f=0})},cookieBind:function(c){return this.each(function(){b(this).cookieFill().change(function(){b(this).cookify(c)})})}};b.each(a,function(c){b.fn[c]=this})})(window.jQuery)}})();(function(d){function f(g){return(new Date().getTime()-g.getTime())}function c(g){return e.inWords(f(g))}function b(){var g=a(this);if(!isNaN(g.datetime)){d(this).text(c(g.datetime))}return this}function a(g){g=d(g);if(!g.data("timeago")){g.data("timeago",{datetime:e.datetime(g)});var h=d.trim(g.text());if(h.length>0){g.attr("title",h)}}return g.data("timeago")}d.timeago=function(g){if(g instanceof Date){return c(g)}else{if(typeof g==="string"){return c(d.timeago.parse(g))}else{return c(d.timeago.datetime(g))}}};var e=d.timeago;d.extend(d.timeago,{settings:{refreshMillis:60000,allowFuture:true,strings:window.wgTimeAgoi18n||{}},inWords:function(l){var m=this.settings.strings,p=false;if(this.settings.allowFuture){if(l<0){p=true}l=Math.abs(l)}var o=l/1000;var g=o/60;var n=g/60;var q=n/24;var j=q/365;function h(s,t){var r=m[p?(s+"-from-now"):s]||"";return r.replace(/%d/i,t)}var k=(o<45&&h("seconds",Math.round(o)))||(o<90&&h("minute",1))||(g<45&&h("minutes",Math.round(g)))||(g<90&&h("hour",1))||(n<24&&h("hours",Math.round(n)))||(n<48&&h("day",1))||(q<30&&h("days",Math.floor(q)))||(q<60&&h("month",1))||(q<365&&h("months",Math.floor(q/30)))||(j<2&&h("year",1))||h("years",Math.floor(j));return k},parse:function(h){var g=d.trim(h);g=g.replace(/\.\d\d\d+/,"");g=g.replace(/-/,"/").replace(/-/,"/");g=g.replace(/T/," ").replace(/Z/," UTC");g=g.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(g)},datetime:function(j){var h=d(j);var k=h.get(0).tagName.toLowerCase()==="time";var g=k?h.attr("datetime"):h.attr("title");return e.parse(g)}});d.fn.timeago=function(){var h=this;h.each(b);var g=e.settings;if(g.refreshMillis>0){setInterval(function(){h.each(b)},g.refreshMillis)}return h};document.createElement("abbr");document.createElement("time")}(jQuery));(function(a){a.store=function(e,b){var d=this;this.encoders=[];this.decoders=[];if(typeof e=="string"){if(a.store.drivers[e]){this.driver=a.store.drivers[e]}else{throw new Error("Unknown driver "+e)}}else{if(typeof e=="object"){var c=!a.isFunction(e.init)||!a.isFunction(e.get)||!a.isFunction(e.set)||!a.isFunction(e.del)||!a.isFunction(e.flush);if(c){throw new Error("The specified driver does not fulfill the API requirements")}this.driver=e}else{a.each(a.store.drivers,function(){if(!a.isFunction(this.available)||!this.available()){return true}d.driver=this;if(d.driver.init()===false){d.driver=null;return true}return false})}}if(!b){b=a.store.serializers}this.serializers={};a.each(b,function(f,g){if(!a.isFunction(this.init)){return true}d.serializers[f]=this;d.serializers[f].init(d.encoders,d.decoders)})};a.extend(a.store.prototype,{get:function(b){var c=this.driver.get(b);return this.driver.encodes?c:this.unserialize(c)},set:function(b,c){this.driver.set(b,this.driver.encodes?c:this.serialize(c))},del:function(b){this.driver.del(b)},flush:function(){this.driver.flush()},driver:undefined,serialize:function(c){var b=this;a.each(this.encoders,function(){var d=b.serializers[this+""];if(!d||!d.encode){return true}try{c=d.encode(c)}catch(f){}});return c},unserialize:function(c){var b=this;if(!c){return c}a.each(this.decoders,function(){var d=b.serializers[this+""];if(!d||!d.decode){return true}c=d.decode(c)});return c}});a.store.drivers={localStorage:{ident:"$.store.drivers.localStorage",scope:"browser",available:function(){try{return !!window.localStorage}catch(b){return false}},init:a.noop,get:function(b){return window.localStorage.getItem(b)},set:function(c,d){try{window.localStorage.setItem(c,d)}catch(b){}},del:function(b){window.localStorage.removeItem(b)},flush:function(){window.localStorage.clear()}},userData:{ident:"$.store.drivers.userData",element:null,nodeName:"userdatadriver",scope:"browser",initialized:false,available:function(){try{return !!(document.documentElement&&document.documentElement.addBehavior)}catch(b){return false}},init:function(){if(this.initialized){return}try{this.element=document.createElement(this.nodeName);document.documentElement.insertBefore(this.element,document.getElementsByTagName("title")[0]);this.element.addBehavior("#default#userData");this.initialized=true}catch(b){return false}},get:function(b){this.element.load(this.nodeName);return this.element.getAttribute(b)},set:function(b,c){this.element.setAttribute(b,c);this.element.save(this.nodeName)},del:function(b){this.element.removeAttribute(b);this.element.save(this.nodeName)},flush:function(){this.element.expires=(new Date()).toUTCString();this.element.save(this.nodeName)}},windowName:{ident:"$.store.drivers.windowName",scope:"window",cache:{},encodes:true,available:function(){return true},init:function(){this.load()},save:function(){window.name=a.store.serializers.json.encode(this.cache)},load:function(){this.cache=a.store.serializers.json.decode(window.name+"")},get:function(b){return this.cache[b]},set:function(b,c){this.cache[b]=c;this.save()},del:function(b){try{delete this.cache[b]}catch(c){this.cache[b]=undefined}this.save()},flush:function(){window.name="{}"}}};a.store.serializers={json:{ident:"$.store.serializers.json",init:function(c,b){c.push("json");b.push("json")},encode:function(b){try{return JSON.stringify(b)}catch(c){return""}},decode:function(b){try{return JSON.parse(b)}catch(c){return{}}}}}})(jQuery);$.storage=new $.store();
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,k,j){var h,d=0;if(typeof f!=="boolean"){j=k;k=f;f=c}function g(){var p=this,n=+new Date()-d,o=arguments;function m(){d=+new Date();k.apply(p,o)}function l(){h=c}if(j&&!h){m()}h&&clearTimeout(h);if(j===c&&n>e){m()}else{if(f!==true){h=setTimeout(j?l:m,j===c?e-n:e)}}}if($.guid){g.guid=k.guid=k.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*
 * jQuery Floating Scrollbar - v0.5 - 09/05/2013
 * http://benalman.com/
 *
 * Copyright (c) 2011 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(d,k){var h=d(k),a=d([]),j,e,f=d('<div id="floating-scrollbar"><div/></div>'),b=f.children();function g(m){f.toggle(!!m)}function l(){if(j){f.scrollLeft(j.scrollLeft())}}function c(){e=j;j=null;a.each(function(){var t=d(this),u=t.offset().top,q=u+t.height(),s=h.scrollTop()+h.height()-d.floatingScrollbarOptions.bottom,r=30;if(u+r<s&&q>s){j=t;return false}});if(!j){g();return}var n=j.scrollLeft(),m=j.scrollLeft(90019001).scrollLeft(),p=j.innerWidth(),o=p+m;j.scrollLeft(n);if(o<=p){g();return}g(true);if(!e||e[0]!==j[0]){if(e){e.unbind("scroll",l)}j.scroll(l).after(f)}f.css({bottom:d.floatingScrollbarOptions.bottom,left:j.offset().left-h.scrollLeft(),width:p}).scrollLeft(n);b.width(o)}f.hide().css({position:"fixed",bottom:0,height:"30px",overflowX:"auto",overflowY:"hidden"}).scroll(function(){if(j){j.scrollLeft(f.scrollLeft())}});b.css({border:"1px solid #fff",opacity:0.01});d.fn.floatingScrollbar=function(m){if(m===false){a=a.not(this);this.unbind("scroll",l);if(!a.length){f.detach();h.unbind("resize scroll",c)}}else{if(this.length){if(!a.length){h.resize(c).scroll(c)}a=a.add(this)}}c();return this};d.floatingScrollbarUpdate=c;d.floatingScrollbarOptions={bottom:0}})(jQuery,this);(function(window,$){$.getSassURL=function(rootURL,scssFilePath,params){return rootURL+wgAssetsManagerQuery.replace("%1$s","sass").replace("%2$s",scssFilePath).replace("%3$s",encodeURIComponent($.param(params||window.sassParams))).replace("%4$d",wgStyleVersion)};$.getSassCommonURL=function(scssFilePath,params){return $.getSassURL(wgCdnRootUrl,scssFilePath,params)};$.getSassLocalURL=function(scssFilePath,params){return $.getSassURL(wgServer,scssFilePath,params)};$.getAssetManagerGroupUrl=function(groups,params){if(typeof groups=="string"){groups=[groups]}params=params||{};if(window.wgDevelEnvironment){params.minify=0}return wgAssetsManagerQuery.replace("%1$s","groups").replace("%2$s",groups.join(",")).replace("%3$s",$.isEmptyObject(params)?"-":encodeURIComponent($.param(params))).replace("%4$d",wgStyleVersion)};$.ajaxSetup({cache:true});$.getScript=function(url,callback,failureFn){return $.ajax({type:"GET",url:url,success:function(xhr){if(typeof callback=="function"){try{callback()}catch(e){eval(xhr);callback();$().log("eval() fallback applied for "+url,"getScript")}}},error:(typeof failureFn=="function"?failureFn:$.noop),dataType:"script"})};$.fn.log=function(msg,group){Wikia.log(msg,Wikia.log.levels.info,group);return this};$.fn.exists=function(){return this.length>0};$.fn.getModal=function(url,id,options){$.get(url,function(html){$("body").append(html);if(typeof options=="object"&&typeof options.callbackBefore=="function"){options.callbackBefore()}if(typeof id=="string"){$(id).makeModal(options);$().log("getModal: "+id+" modal made")}if(typeof options=="object"&&typeof options.callback=="function"){options.callback()}})};$.showModal=function(title,content,options){options=(typeof options!="object")?{}:options;var header=$("<h1>").text(title),dialog=$("<div>"),wrapper;if(typeof options.rawHTML!="undefined"&&options.rawHTML===true){dialog.get(0).innerHTML=content}else{dialog.html(content)}dialog.prepend(header).appendTo("body");if(typeof options.callbackBefore=="function"){options.callbackBefore()}wrapper=dialog.makeModal(options);if(typeof options.callback=="function"){options.callback(wrapper)}return wrapper};$.confirm=function(options){options=(typeof options!="object")?{}:options;options.id="WikiaConfirm";var html="";if(options.title){html+="<h1>"+options.title+"</h1>"}html+="<p>"+(options.content||"")+'</p><div class="neutral modalToolbar"><button id="WikiaConfirmCancel" class="wikia-button secondary">'+(options.cancelMsg||$.msg("cancel"))+'</button><button id="WikiaConfirmOk" class="wikia-button">'+(options.okMsg||$.msg("ok"))+"</button></div>";var dialog=$("<div>").appendTo("body").html(html).attr("title",options.title||"");if(typeof options.callbackBefore=="function"){options.callbackBefore()}$("#WikiaConfirmOk").click(function(){$("#WikiaConfirm").closeModal();if(typeof options.onOk=="function"){options.onOk()}});$("#WikiaConfirmCancel").click(function(){$("#WikiaConfirm").closeModal();if(typeof options.onCancel==="function"){options.onCancel()}});dialog.makeModal(options);if(typeof options.callback=="function"){options.callback()}};$.showCustomModal=function(title,content,options){options=(typeof options!="object")?{}:options;var buttons="";if(options.buttons){buttons=$('<div class="neutral modalToolbar"></div>');for(var buttonNo=0;buttonNo<options.buttons.length;buttonNo++){var button='<a id="'+options.buttons[buttonNo].id+'" class="wikia-button'+(options.buttons[buttonNo].defaultButton?"":" secondary")+'">'+options.buttons[buttonNo].message+"</a>";$(button).bind("click",options.buttons[buttonNo].handler).appendTo(buttons)}}var dialog=$("<div>").html(content).attr("title",title).append(buttons);$("body").append(dialog);if(typeof options.callbackBefore=="function"){options.callbackBefore()}var modal=dialog.makeModal(options);if(typeof options.callback=="function"){options.callback(modal)}return modal};$.postJSON=function(u,d,callback){return $.post(u,d,callback,"json")};$.extend({_urlVars:null,getUrlVars:function(){if($._urlVars===null){var hash,hashes=window.location.search.slice(window.location.search.indexOf("?")+1).split("&");$._urlVars={};for(var i=0,j=hashes.length;i<j;i++){hash=hashes[i].split("=");$._urlVars[hash[0]]=hash[1]}}return $._urlVars},getUrlVar:function(name){return $.getUrlVars()[name]}});$.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments)};$.fn.isChrome=function(){if($.browser.webkit&&!$.browser.opera&&!$.browser.msie&&!$.browser.mozilla){var userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf("chrome")>-1){return true}}return false};$.fn.isTouchscreen=function(){return("ontouchstart" in window)};$.fn.hasParent=function(selector){return this.first().parent().closest(selector).exists()};$.fn.startThrobbing=function(){return this.append('<div class="wikiaThrobber"></div>')};$.fn.stopThrobbing=function(){return this.find(".wikiaThrobber").remove()};$.preloadThrobber=function(){var img=new Image();img.src=stylepath+"/common/images/ajax.gif"};$.thumbUrl2ThumbUrl=function(url,type,width,height){return Wikia.Thumbnailer.getThumbURL(url,type,width,height)};$.htmlentities=function(s){return String(s).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;")};$.createClass=function(sc,o){var constructor=o.constructor;if(typeof constructor!="function"||constructor==Object.prototype.constructor){constructor=function(){sc.apply(this,arguments)}}var bc=constructor;var f=function(){};f.prototype=sc.prototype||{};bc.prototype=new f();if(typeof o.statics=="object"){bc=$.extend(bc,o.statics);delete o.statics}for(var m in o){bc.prototype[m]=o[m]}bc.prototype.constructor=bc;bc.superclass=sc.prototype;return bc};$.proxyBind=function(fn,thisObject,baseArgs){return function(){var args=baseArgs.slice(0).concat(Array.prototype.call(arguments,0));return fn.apply(thisObject,args)}};var Observable=$.createClass(Object,{constructor:function(){Observable.superclass.constructor.apply(this,arguments);this.events={}},bind:function(e,cb,scope){if(typeof e=="object"){scope=cb;for(var i in e){if(i!=="scope"){this.bind(i,e[i],e.scope||scope)}}}else{if($.isArray(cb)){for(var i=0;i<cb.length;i++){this.bind(e,cb[i],scope)}}else{scope=scope||this;this.events[e]=this.events[e]||[];this.events[e].push({fn:cb,scope:scope})}}return true},unbind:function(e,cb,scope){if(typeof e=="object"){scope=cb;var ret=false;for(var i in e){if(i!=="scope"){ret=this.unbind(i,e[i],e.scope||scope)||ret}}return ret}else{if($.isArray(cb)){var ret=false;for(var i=0;i<cb.length;i++){ret=this.unbind(e,cb[i],scope)||ret}return ret}else{if(!this.events[e]){return false}scope=scope||this;for(var i in this.events[e]){if(this.events[e][i].fn==cb&&this.events[e][i].scope==scope){delete this.events[e][i];return true}}return false}}},on:function(e,cb){this.bind.apply(this,arguments)},un:function(e,cb){this.unbind.apply(this,arguments)},relayEvents:function(o,e,te){te=te||e;o.bind(e,function(){var a=[te].concat(arguments);this.fire.apply(this,a)},this)},fire:function(e){var a=Array.prototype.slice.call(arguments,1);if(!this.events[e]){return true}var ee=this.events[e];for(var i=0;i<ee.length;i++){if(typeof ee[i].fn=="function"){var scope=ee[i].scope||this;if(ee[i].fn.apply(scope,a)===false){return false}}}return true},proxy:function(func){return $.proxy(func,this)},debugEvents:function(list){var fns=list?list:["bind","unbind","fire","relayEvents"];for(var i=0;i<fns.length;i++){(function(fn){if(typeof this["nodebug-"+fn]=="undefined"){var f=this["nodebug-"+fn]=this[fn];this[fn]=function(){window.console&&console.log&&console.log(this,fn,arguments);return f.apply(this,arguments)}}}).call(this,fns[i])}}});var GlobalTriggers=(function(){var GlobalTriggersClass=$.createClass(Observable,{fired:null,constructor:function(){GlobalTriggersClass.superclass.constructor.apply(this);this.fired={}},bind:function(e,cb,scope){GlobalTriggersClass.superclass.bind.apply(this,arguments);if(typeof e=="object"||$.isArray(cb)){return}if(typeof this.fired[e]!="undefined"){var a=this.fired[e].slice(0);setTimeout(function(){for(i=0;i<a.length;i++){cb.apply(scope||window,a[i])}},10)}},fire:function(e){var a=Array.prototype.slice.call(arguments,1);this.fired[e]=this.fired[e]||[];this.fired[e].push(a);GlobalTriggersClass.superclass.fire.apply(this,arguments)}});return new GlobalTriggersClass()})();var Timer=$.createClass(Object,{callback:null,timeout:1000,timer:null,constructor:function(callback,timeout){this.callback=callback;this.timeout=(typeof timeout=="number")?timeout:this.timeout},run:function(){this.callback.apply(window)},start:function(timeout){this.stop();timeout=(typeof timeout=="number")?timeout:this.timeout;this.timer=setTimeout(this.callback,timeout)},stop:function(){if(this.timer!=null){clearTimeout(this.timer);this.timer=null}}});$.extend(Timer,{create:function(callback,timeout){var timer=new Timer(callback,timeout);return timer},once:function(callback,timeout){var timer=Timer.create(callback,timeout);timer.start();return timer}});$.openPopup=function(url,name,moduleName,width,height){if(wgUserName){window.open(url,name,"width="+width+",height="+height+",menubar=no,status=no,location=no,toolbar=no,scrollbars=no,resizable=yes")}else{showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){$(".modalWrapper").children().not(".close").not(".modalContent").not("h1").remove();$.nirvana.sendRequest({controller:moduleName,method:"AnonLoginSuccess",format:"html",type:"get",callback:function(html){$(".modalContent").html(html)}})}},false)}};$(function(){if(typeof wgNow!="undefined"){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log("DOM ready after "+loadTime+" ms",window.skin)}window.wgWikiaDOMReady=true;if(typeof $.fn.timeago!="undefined"){$(".timeago").timeago()}});var $window=$(window);$window.bind("load",function(){if(typeof wgNow!="undefined"){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log("window onload after "+loadTime+" ms",window.skin)}});$window.on("scroll",$.debounce(100,function(event){$window.trigger("scrollstop",[event])}));$.toJSON=JSON.stringify;$.evalJSON=$.secureEvalJSON=JSON.parse;window.GlobalTriggers=GlobalTriggers;window.Observable=Observable;window.Timer=Timer})(window,jQuery);(function(b,a){b.fn.carousel=function(f){var k=b(this);var m={transitionSpeed:500,itemsShown:3,activeIndex:0,nextClass:"next",prevClass:"previous",attachBlindImages:false,itemClick:false,trackProgress:false,beforeMove:false,afterMove:false};f=b.extend(m,f);var w={wrapper:k,carousel:k.find(".carousel"),items:k.find(".carousel > li"),container:k.children("div:first"),next:k.siblings("."+f.nextClass),previous:k.siblings("."+f.prevClass)};var A={viewPortWidth:k.outerWidth(),itemWidth:l(),carouselWidth:0,minLeft:0};var h={browsing:false,enable_next:false,enable_previous:false,currIndex:0,left:0};function s(){if(h.browsing==false&&h.enable_next==true){h.browsing=true;j(h.currIndex+f.itemsShown)}return false}function n(){if(h.browsing==false&&h.enable_previous==true){h.browsing=true;j(h.currIndex-1)}return false}function j(B){if(!q(B)){if(B>(w.items.length-f.itemsShown)){B=w.items.length-f.itemsShown}if(h.currIndex>B){var C=B-f.itemsShown+1;if(C<0){C=0}B=C}var D=A.itemWidth*B*-1;h.currIndex=B;p(D)}else{r()}}function p(B){h.left=B;if(typeof f.beforeMove=="function"){f.beforeMove()}w.carousel.animate({left:B},f.transitionSpeed,function(){h.browsing=false;r()})}function r(){d();u();if(typeof f.trackProgress=="function"){e(f.trackProgress)}if(typeof f.afterMove=="function"){f.afterMove(h.currIndex+f.itemsShown)}}function q(B){return B>=h.currIndex&&B<(h.currIndex+f.itemsShown)}function x(B){if(B>-1){w.items.removeClass("active");w.items.eq(B).addClass("active");j(B)}else{d()}}function e(E){var D=w.items.length,C=Math.floor(h.currIndex)+1,B=Math.floor(h.currIndex)+(f.itemsShown>D?D:f.itemsShown);if(B>D){B=D}E(C,B,D)}function d(){if(w.items.length<=f.itemsShown){o();y();return}var B=parseInt(w.carousel.css("left"));if(isNaN(B)){B=0}if(B<A.minLeft+A.itemWidth/2){o();t()}else{if(B==0){y();v()}else{t();v()}}}function u(){var E=h.currIndex-f.itemsShown,C=h.currIndex,B=h.currIndex+f.itemsShown*2;E=E<0?0:E;var D=w.items.slice(C,B).find("img[data-src]"),F=w.items.slice(E,C).find("img[data-src]");c(D);c(F)}function c(B){B.each(function(){var C=b(this);C.attr("src",C.attr("data-src")).removeAttr("data-src")})}function z(){if(!A.itemWidth){A.itemWidth=l()}var C=A.itemWidth*w.items.length;w.carousel.css("width",C);var B=(C-A.viewPortWidth)*-1;A.carouselWidth=C;A.minLeft=B}function g(){if(w.carousel.find("li").length==5){w.carousel.append("<li class='blind'></li>")}else{if(w.carousel.find("li").length==4){w.carousel.append("<li class='blind'></li>");w.carousel.append("<li class='blind'></li>")}}w.carousel.find("li").first().addClass("first-image");w.carousel.find("li").last().addClass("last-image")}function o(){h.enable_next=false;w.next.addClass("disabled")}function v(){h.enable_next=true;w.next.removeClass("disabled")}function y(){h.enable_previous=false;w.previous.addClass("disabled")}function t(){h.enable_previous=true;w.previous.removeClass("disabled")}function l(){return w.items.first().outerWidth(true)}this.updateCarouselItems=function(){w.items=w.carousel.find("li");u()};this.updateCarouselWidth=function(){z()};this.updateCarouselArrows=function(){d()};this.resetPosition=function(){w.carousel.css("left",0);h.currIndex=0};return this.each(function(){if(typeof f.attachBlindImages=="function"){g()}w.next.click(s);w.previous.click(n);z();x(f.activeIndex);if(f.itemClick){w.carousel.on("click","li",function(B){x(b(this).index());f.itemClick.call(this,B)})}u()})}})(jQuery,this);$.fn.extend({getModalTopOffset:function(){var b=Math.max((($(window).height()-this.outerHeight())/2),20);var a=this.data("settings");if(a&&typeof a.topMaximum=="number"){b=Math.min(b,a.topMaximum)}return $(window).scrollTop()+b},makeModal:function(o){var g={showCloseButton:true,width:400,height:"auto",topOffset:50,escapeToClose:true};if(o){$.extend(g,o)}var k=Math.round((new Date()).getTime()/1000),d=g.id||($(this).attr("id")||k)+"Wrapper",c;if(skin=="oasis"){c=$("<section>",{"class":"modalWrapper",id:d}).append($("<section>",{"class":"modalContent"}).append(this)).appendTo("body")}else{this.wrap('<div class="modalWrapper" id="'+d+'"></div>');c=this.closest(".modalWrapper");c.appendTo("#positioned_elements")}if(g.className){c.addClass(g.className)}var n=g.zIndex?parseInt(g.zIndex):(2000000001+($("body").children(".blackout").length)*2);c.data("settings",g);if(!g.noHeadline){var e=c.find("h1:first");if(e.exists()){e.remove()}else{e=$("<h1>").html($(this).attr("title")||"")}e.prependTo(c)}if(skin=="oasis"){var a=c.find(".modal-tabs");if(a.exists()){a.insertBefore(c.find(".modalContent"))}if(o.width!="auto"){var h=$("#WikiaMainContent").width();if(typeof o.width!="undefined"){h=o.width+40}}else{h="auto"}c.css({left:"50%",top:$(window).scrollTop()+g.topOffset,width:h,height:o.height,zIndex:n+1}).css("margin-left",-c.outerWidth(false)/2)}else{c.width(g.width).css({marginLeft:-c.outerWidth(false)/2,top:c.getModalTopOffset(),zIndex:n+1}).fadeIn("fast")}if(g.showCloseButton){c.prepend('<button class="close wikia-chiclet-button"><img src="'+stylepath+'/oasis/images/icon_close.png"></button>')}c.log("makeModal: #"+d);this.removeAttr("title");var f=(typeof g.persistent=="boolean")?g.persistent:false;var m=(typeof g.onClose=="function")?g.onClose:false;var l=(typeof g.closeOnBlackoutClick=="boolean")?g.closeOnBlackoutClick:true;c.find(".close").bind("click",function(){var q=$(this).closest(".modalWrapper");var p=q.data("settings");if(typeof p.onClose=="function"){if(p.onClose({click:1})==false){return}}if(f){q.hideModal()}else{q.closeModal()}});if(g.escapeToClose){$(window).bind("keydown.modal"+d,function(p){if(p.keyCode==27){if(typeof g.onClose=="function"){if(g.onClose({keypress:1})==false){return}}if(f){c.hideModal()}else{c.closeModal()}return false}})}$(window).bind("resize.modal",function(){if(window.skin=="oasis"){return}c.css("top",c.getModalTopOffset());$(".blackout:last").height($(document).height())});var b=0.65;if(g.blackoutOpacity){b=g.blackoutOpacity}var j=$("<div>").addClass("blackout").attr("data-opacity",b);j.css({zIndex:n}).fadeTo("fast",b).bind("click",function(){if(!l){return}if(typeof g.onClose=="function"){if(g.onClose({click:1})==false){return}}if(f){c.hideModal()}else{c.closeModal()}});if(skin=="oasis"){j.appendTo("body")}else{j.appendTo("#positioned_elements")}c.data("blackout",j);if(typeof g.onCreate=="function"){g.onCreate(this,c)}$(document.body).addClass("modalShown");return c},closeModal:function(){$(window).unbind(".modal"+this.attr("id"));this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).remove()});var b=$(this).data("blackout"),a=$(this).data("settings");b.fadeOut("fast",function(){$(this).remove();var c=a&&a.onAfterClose;if($.isFunction(c)){c()}});$(document.body).removeClass("modalShown")},hideModal:function(){var b=$(this).data("blackout"),a=$(this).data("settings");b.fadeOut("fast").addClass("blackoutHidden");this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).hide();var c=a&&a.onAfterClose;if($.isFunction(c)){c()}});$(document.body).removeClass("modalShown")},showModal:function(){var d=this.closest(".modalWrapper");var c=2000000001+($("body").children(".blackout").length)*2;var b=$(this).data("blackout");var a=b.attr("data-opacity");if(!a){a=0.65}b.css({display:"block",opacity:a,zIndex:c}).removeClass("blackoutHidden");d.css({top:d.getModalTopOffset(),zIndex:c+1,opacity:1,display:"block"}).log("showModal: #"+this.attr("id"));$(document.body).addClass("modalShown")},resizeModal:function(a){a=parseInt(a);var b=this.closest(".modalWrapper");b.width(a).css("marginLeft",-b.outerWidth(false)>>1).log("resizeModal: #"+this.attr("id")+" resized to "+a+"px")},isModalShown:function(){return $(document.body).hasClass("modalShown")},getModalWrapper:function(){return $(".modalWrapper")}});$.expiryStorage=new $.store();$.expiryStorage.get=function(a){var c=this.driver.get(a);if(!c){return}var b=this.driver.encodes?c:this.unserialize(c);c=null;var e=new Date();if(b.expires>=e.getTime()){c=b.value}else{this.del(a)}return c};$.expiryStorage.set=function(b,e,a){var f;if(typeof a=="number"){f=new Date();f.setTime(f.getTime()+(a))}else{if(typeof a=="object"&&a.toUTCString){f=a}else{throw"expires is not in a valid form"}}var c={value:e,expires:f.getTime()};this.driver.set(b,this.driver.encodes?c:this.serialize(c))};(function(a){a.fn.focusNoScroll=function(){var b=a(window).scrollLeft(),c=a(window).scrollTop();a(this).focus();a(window).scrollLeft(b).scrollTop(c);return this}})(jQuery);(function(b,c){var a=(function(){var d=new RegExp(b.wgAssetsManagerQuery.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&").replace(/\//g,"\\/").replace("%1\\$s","groups?").replace(/%\d\\\$(?:s|d)/g,"(.*)")),f=/(js|s?css)/,e=/\.(js|s?css)$/;return function(k,s,h){var o,j,q,p,t=new c.Deferred();var g=function(){p--;if(p<1){if(typeof s=="function"){s()}t.resolve()}};if(!c.isArray(k)){k=[k]}if(!(o=p=k.length)){g()}for(j=0;j<o;j++){var m=k[j],r=typeof m;if(r=="object"){if(m.type&&m.url){r=m.type;m=m.url}}else{if(r=="string"){q=m.match(d);q=q?q[3].match(f):m.match(e);r=q?q[1]:"unknown"}}if(r=="js"){c.getScript(m,g,h)}else{if(r=="css"||r=="scss"){c.getCSS(m,g)}else{if(r=="function"){m.call(c,g)}else{c().log("getResources: unknown type "+m);t.reject({error:"Unknown type",resource:m})}}}}return t.promise()}}());c.getResources=c.getResource=a})(window,jQuery);$.loadLibrary=function(d,e,b,f,c){var a=new jQuery.Deferred();if(b==="undefined"){$().log("loading "+d,"loadLibrary");e=(typeof e=="string")?[e]:e;$.getResources(e,function(){$().log(d+" loaded","loadLibrary");if(typeof f=="function"){f()}},c).then(function(){a.resolve()}).fail(function(){a.reject()})}else{$().log(d+" already loaded","loadLibrary");if(typeof f=="function"){f()}a.resolve()}return a.promise()};$.loadYUI=function(a){return mw.loader.use("wikia.yui").done(a)};$.loadModalJS=function(a){if(typeof a==="function"){a()}};$.loadJQueryUI=function(a){return mw.loader.use("wikia.jquery.ui").done(a)};$.loadJQueryAutocomplete=function(a){return mw.loader.use("jquery.autocomplete").done(a)};$.loadJQueryAIM=function(a){return mw.loader.use("wikia.aim").done(a)};$.loadMustache=function(a){return mw.loader.use("jquery.mustache").done(a)};$.loadGoogleMaps=function(c){var a=new jQuery.Deferred(),b=function(){if(typeof c==="function"){c()}a.resolve()};if(typeof(window.google&&window.google.maps)!="undefined"){b()}else{window.onGoogleMapsLoaded=function(){delete window.onGoogleMapsLoaded;b()};$.loadLibrary("GoogleMaps",[{url:"http://maps.googleapis.com/maps/api/js?sensor=false&callback=onGoogleMapsLoaded",type:"js"}],typeof(window.google&&window.google.maps)).fail(function(){a.reject()})}return a.promise()};$.loadFacebookAPI=function(a){return $.loadLibrary("Facebook API",window.fbScript||"//connect.facebook.net/en_US/all.js",typeof window.FB,function(){if(window.onFBloaded){window.onFBloaded()}if(typeof a==="function"){a()}})};$.loadGooglePlusAPI=function(a){return $.loadLibrary("Google Plus API","//apis.google.com/js/plusone.js",typeof(window.gapi&&window.gapi.plusone),a)};$.loadTwitterAPI=function(a){return $.loadLibrary("Twitter API","//platform.twitter.com/widgets.js",typeof(window.twttr&&window.twttr.widgets),a)};jQuery(function(g){var d=g("#WikiaArticle"),f=d.find("table"),e=g("#WikiaBarWrapper"),c='<div class="table-wrapper table-is-wide"><div class="table-scrollable"></div></div>';function a(){f.each(function(){var h=g(this),k=h.parent(".table-scrollable"),j=h.width()>d.width();if(j&&!k.length){h.wrap(c);k=h.parent(".table-scrollable")}else{if(!j&&k.length){h.unwrap().unwrap()}}k.floatingScrollbar(j)})}function b(){var h=e.length&&!e.hasClass("hidden")?e.height():0;g("#floating-scrollbar").css("bottom",h);g.floatingScrollbarOptions.bottom=h}a();g(window).on("resize",g.debounce(50,a)).on("wikiaTabClicked WideTablesScan",a).on("WikiaBarStateChanged WikiaBarReady UpdateFloatingScrollbar",b)});define("wikia.backgroundchanger",function(){function a(d){var f=new Image(),c={"background-dynamic":d.backgroundDynamic||false,"background-image":d.skinImage||"","background-image-width":d.skinImageWidth||0,"background-image-height":d.skinImageHeight||0,"color-body":d.backgroundColor,"color-body-middle":d.backgroundMiddleColor||d.backgroundColor},e=$.extend({},window.wgSassParams,c),b=$.getSassCommonURL("/skins/oasis/css/core/background.scss",e);f.src=d.skinImage;$.getCSS(b,function(){if(d.skinImage!==""&&d.skinImageWidth>0&&d.skinImageHeight>0){if((d.backgroundFixed===undefined)||!!d.backgroundFixed){$("body").addClass("background-fixed")}else{$("body").removeClass("background-fixed")}if((d.backgroundTiled!==undefined)&&!!d.backgroundTiled){$("body").removeClass("background-not-tiled")}else{$("body").addClass("background-not-tiled")}if((d.backgroundDynamic===undefined)||!!d.backgroundDynamic){$("body").addClass("background-dynamic")}else{$("body").removeClass("background-dynamic")}}else{$("body").removeClass("background-dynamic background-not-tiled background-fixed")}})}return{load:a}});define("SearchAbTest.DomUpdater",["jquery","wikia.log"],function(d,b){var a=".wikia-paginator a.paginator-page, .search-tabs a, a.paginator-next, a.paginator-prev",c="form.WikiaSearch";return{linkUpdater:{update:function(f){if(!f){return}var e=this;d(a).each(function(){var h=d(this).attr("href");if(!!h){var g=e.modifyLink(h,f);b('Modifying link: "'+h+'" to "'+g+'"',b.levels.debug,"search");d(this).attr("href",g)}})},modifyLink:function(f,h){h=h||{};var e=f;var j="?";if(f.indexOf("?")>-1){j="&"}if(f.indexOf("?")==f.length-1){j=""}for(var g in h){e=e+j+g+"="+h[g];j="&"}return e}},formUpdater:{update:function(h){if(!h){return}var f=d(c);for(var g in h){var e='<input type="hidden" name="'+g+'" value="'+h[g]+'">';f.append(e);b("Add new input: "+e,b.levels.debug,"search")}}}}});define("SearchAbTest.Context",["wikia.window","wikia.log","wikia.querystring"],function(e,d,a){if(!e||!e.Wikia||!e.Wikia.AbTest){d("AbTest is not present. Fallback to dummy SearchAbTest.GroupProvider",d.levels.debug,"search");return{getAbTestGroups:function(){return[]},getAbTestParameters:function(){return{}},getQueryParameters:function(){return{}}}}var b=e.Wikia.AbTest;function c(){var j=[];var h=b.getExperiments();for(var g=0;g<h.length;g++){var f=h[g];if(f&&f.name&&f.name.toUpperCase().indexOf("SEARCH")===0){j.push(f)}}return j}return{getAbTestGroups:function(){var h=c();var f=[];for(var g=0;g<h.length;g++){if(h[g].group){f.push(h[g].group.id)}}d("Found A/B groups: "+f.join(","),d.levels.debug,"search");return f},getQueryParameters:function(){var f=a(e.location.url);return f.getVals()},getAbTestParameters:function(){var g={};var h=this.getQueryParameters();for(var f in h){if(f.indexOf("AbTest.")===0||f=="ab"){g[f]=h[f]}}return g}}});require(["wikia.window","SearchAbTest.Context","SearchAbTest.DomUpdater","wikia.log"],function(j,b,a,g){var e="ab";if(j.Wikia&&j.Wikia.AbTest){g("AbTest is present. Enable Search A/B testing.",g.levels.debug,"search");var l=[a.linkUpdater,a.formUpdater];var d=b.getAbTestGroups();var f={};if(d.length){f[e]=d.join(",")}var c=b.getAbTestParameters();for(var k in c){f[k]=c[k]}for(var h=0;h<l.length;h++){l[h].update(f)}}});var checkElementVisibility=function(b){var d=b.offsetTop,a=(d+b.offsetHeight),e=((window.pageYOffset!==undefined)?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop),c=(e+window.innerHeight);return c>=d&&e<=a};var doTrackImpression=function(a){Wikia.Tracker.track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:"abtest-right-rail",label:a,trackingMethod:"both"},{})};var hookRightRailImpression=function(a){var b=document.getElementById("WikiaRail");if(b){if(checkElementVisibility(b)){doTrackImpression(a)}else{require(["sloth"],function(c){c({on:b,threshold:0,callback:function(d){doTrackImpression(a)}})})}}};$(function(){if(window.wgOasisResponsive){group=window.Wikia.AbTest?Wikia.AbTest.getGroup("DAR_RIGHTRAILPOSITION"):null;switch(group){case"STATIC":hookRightRailImpression("static");break;case"CONTROL":hookRightRailImpression("control");break;default:}}});$(function(){var b=100,c=Wikia.Tracker.buildTrackingFunction({category:"global-navigation",trackingMethod:"ga"});function f(h){var g=$(h.target);if(g.hasClass("sprite")){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_IMAGE,label:"wikia-logo"})}else{if(g.hasClass("wikia-button")){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,label:"start-wiki"})}else{if(g.hasClass("ajaxRegister")){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_TEXT,label:"signup"})}else{if(g.hasClass("login-button")){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,label:"login"})}else{if(g.parents(".topNav").exists()){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_TEXT,label:"hub-name-link"})}else{if(g.parents(".catnav, .subnav").exists()){c({action:Wikia.Tracker.ACTIONS.CLICK_LINK_TEXT,label:"hub-submenu-link"})}}}}}}}function a(h){var g=$(h.target);if(g.parents(".GlobalNavigation").exists()){c({action:Wikia.Tracker.ACTIONS.HOVER,label:"hubs-menu-open"})}else{if(g.parents(".AccountNavigation").exists()){c({action:Wikia.Tracker.ACTIONS.HOVER,label:"user-menu-open"})}else{if(g.parents(".WallNotifications").exists()){c({action:Wikia.Tracker.ACTIONS.HOVER,label:"notifications-menu-open"})}}}}function e(){return b>=Math.floor((Math.random()*100+1))}function d(){var g=window.Wikia.AbTest?Wikia.AbTest.getGroup("DAR_GLOBALNAVIGATIONFIXED"):undefined;return g!==undefined}if(d()&&e()){Wikia.log("Global nav tracking enabled","info","GlobalNav");$("#WikiaHeader").on("click",f);$("#WikiaHeader").on("hovermenu-shown",a)}else{Wikia.log("Global nav tracking disabled","info","GlobalNav")}});window.Wikia=window.Wikia||{};window.Wikia.getMultiTypePackage=function(n){var f={},m=n.styles,e=n.scripts,g=n.messages,k=n.templates,j=n.mustache,l=n.callback,d=n.params,a=n.ttl,c=n.varnishTTL,h=n.browserTTL,b=false;if(typeof m==="string"){f.styles=m;b=true}if(typeof e==="string"){f.scripts=e;b=true}if(typeof g==="string"){f.messages=g;b=true}if(typeof j==="string"){f.mustache=j;b=true}if(typeof k!="undefined"){f.templates=(typeof k==="object")?JSON.stringify(k):k;b=true}if(typeof d==="object"){f=$.extend(f,d)}if(a){f.ttl=~~a}if(c){f.varnishTTL=~~c}if(h){f.browserTTL=~~h}if(b){f.cb=wgStyleVersion;return $.nirvana.getJson("AssetsManagerController","getMultiTypePackage",f,function(o){if(o.messages){wgMessages=$.extend(wgMessages,o.messages)}if(typeof l==="function"){l(o)}})}else{throw"No resources to load specified"}};window.Wikia.processScript=function(c){var a=document.createElement("script"),b=document.head||document.getElementsByTagName("head")[0];a.type="text/javascript";a.text=c;b.appendChild(a)};window.Wikia.processStyle=function(b){var c=document.createElement("style"),a=document.head||document.getElementsByTagName("head")[0];c.type="text/css";if(c.styleSheet){c.styleSheet.cssText=b}else{c.appendChild(document.createTextNode(b))}a.appendChild(c)};window.Wikia.getAMgroups=function(a,b){return $.getScript($.getAssetManagerGroupUrl(a),b)};(function(c){var b=Array.prototype.shift,e=Array.prototype.join;function a(k,j,h){var g=function(){var p=b.call(arguments),n=p;if(h.wgMessages){n=h.wgMessages[p]||n;n=d.process(n,arguments,h.wgUserLanguage);if(n!==p&&arguments.length){for(var o=0,m=arguments.length;o<m;o++){n=n.replace(new RegExp("\\$"+(o+1),"g"),arguments[o])}}}return n};g.get=function(m,o,n){var l=j.Deferred();if(typeof m!="string"){m=e.call(m,",")}n=n||h.wgUserLanguage;k.sendRequest({type:"GET",controller:"JSMessages",method:"getMessages",data:{packages:m,uselang:n,cb:h.wgJSMessagesCB}}).then(function(p){h.wgMessages=j.extend(h.wgMessages||{},p.messages);if(typeof o=="function"){o()}l.resolve()}).fail(function(){l.reject()});return l.promise()};g.getForContent=function(l,m){return g.get(l,m,h.wgContentLanguage)};return g}var d={defaultPluralRule:function(g){return(g!=1)?1:0},pluralRules:{"ay bo cgg dz fa id ja jbo ka kk km ko ky lo ms su th tr tt ug uz vi wo zh zh-hans zh-hant zh-tw":function(){return 0},"ach ak am arn br fil fr gun ln mfe mg mi nso oc pt-br ti wa":function(g){return(g>1)?1:0},"cs sk":function(g){return(g==1)?0:((g>=2&&g<=4)?1:2)},"be bs ru sr uk":function(g){return(g%10==1&&g%100!=11)?0:((g%10>=2&&g%10<=4&&(g%100<10||g%100>=20))?1:2)},jv:function(g){return(g!=0)?1:0},mk:function(g){return(g==1||g%10==1)?0:1},mnk:function(g){return(g==0)?0:g==1?1:2},lv:function(g){return(g%10==1&&g%100!=11)?0:((g!=0)?1:2)},kw:function(g){return(g==1)?0:((g==2)?1:((g==3)?2:3))},ro:function(g){return(g==1)?0:((g==0||(g%100>0&&g%100<20))?1:2)},ga:function(g){return(g==1)?0:((g==2)?1:((g<7)?2:((g<11)?3:4)))},gd:function(g){return(g==1||g==11)?0:(g==2||g==12)?1:(g>2&&g<20)?2:3},sl:function(g){return(g%100==1)?0:((g%100==2)?1:((g%100==3||g%100==4)?2:3))},pl:function(g){return(g==1)?0:((g%10>=2&&g%10<=4&&(g%100<10||g%100>=20))?1:2)},csb:function(g){return(g==1)?0:((g%10>=2&&g%10<=4&&(g%100<10||g%100>=20))?1:2)},lt:function(g){return(g%10==1&&g%100!=11)?0:((g%10>=2&&(g%100<10||g%100>=20))?1:2)},cy:function(g){return(g==0)?0:((g==1)?1:((g==2)?2:((g==3)?3:((g==6)?4:5))))},hr:function(g){return(g%10==1&&g%100!=11)?0:((g%10>=2&&g%10<=4&&(g%100<10||g%100>=20))?1:2)},mt:function(g){return(g==1)?0:((g==0||(g%100>1&&g%100<11))?1:((g%100>10&&g%100<20)?2:3))},ar:function(g){return(g==0)?0:((g==1)?1:((g==2)?2:((g%100>=3&&g%100<=10)?3:((g%100>=11&&g%100<=99)?4:5))))}},getPluralRuleFunction:function(l){if(typeof d.pluralRules[l]==="undefined"){var n=d.defaultPluralRule,k=[l],g=l.split("-"),j;if(g.length>1){k.push(g[0])}for(j=0;(j<k.length)&&(n===d.defaultPluralRule);j++){var h=new RegExp("(?:^| )"+k[j]+"(?: |$)");for(var m in d.pluralRules){if(d.pluralRules.hasOwnProperty(m)){if(h.test(m)){n=d.pluralRules[m];break}}}}d.pluralRules[l]=n}return d.pluralRules[l]},getPlural:function(g,k,j){var h=isNaN(j)?-1:k(j);if((h<0)||(h>=g.length)){h=g.length-1}return g[h]},process:function(h,g,j){h=h.replace(/\{\{PLURAL:\$(\d+)\|([^\{\}]+)\}\}/gi,function(n,m,l){var k=NaN;if((m>0)&&(m<=g.length)){k=g[m-1];if(typeof k!=="number"){k=parseInt(k)}}return d.getPlural(l.split("|"),d.getPluralRuleFunction(j),k)});return h}};if(jQuery){var f=a(jQuery.nirvana,jQuery,c);jQuery.extend(jQuery,{msg:f,getMessages:f.get,getMessagesForContent:f.getForContent})}if(c.define&&c.define.amd){c.define("JSMessages",["wikia.nirvana","jquery","wikia.window"],a)}})(this);(function(a,d,e){var c=a.wgAction,b=a.wgCategorySelect;if(!b||(c!="view"&&c!="purge")){return}d(function(){var h=a.wgArticleId,f=false,g="categorySelectView",j=d("#WikiaArticleCategories");if(!j.hasClass("userCanEdit")){return}j.on("click."+g,".add",function(){j.addClass("editMode").find(".input").focus();if(!f){f=true;d.when(e.loader.use("jquery.ui.autocomplete"),e.loader.use("jquery.ui.sortable"),d.getResources([wgResourceBasePath+"/resources/wikia/libraries/mustache/mustache.js",wgResourceBasePath+"/extensions/wikia/CategorySelect/js/CategorySelect.js"])).done(function(k){j.categorySelect({placement:"right",popover:{hint:true},sortable:{axis:false,forcePlaceholderSize:true,items:".new",revert:200}}).on("add",function(m,l,n){j.find(".last").before(n.element)}).on("click."+g,".cancel",function(){j.removeClass("editMode").trigger("reset").find(".category.new").remove()}).on("click."+g,".save",function(){var m=j.find(".container").startThrobbing(),l=d(this).attr("disabled",true);d.nirvana.sendRequest({controller:"CategorySelectController",data:{articleId:h,categories:j.data("categorySelect").getData(".new")},method:"save"}).done(function(n){m.stopThrobbing();if(n.error){alert(n.error)}else{j.removeClass("editMode").find(".category").remove();j.find(".last").before(n.html);j.find(".input").val("")}})}).on("update",function(){var l=j.find(".category.new").length>0;j.toggleClass("modified",l).find(".save").prop("disabled",!l)})})}})})})(window,window.jQuery,window.mw);var WikiaForm=function(e){this.el=$(e);this.genericError=this.el.find(".general-errors");if(this.genericError.length==0){this.el.find("fieldset").prepend('<div class="input-group general-errors error"><div class="error-msg"></div></div>');this.genericError=this.el.find(".general-errors");this.genericError.hide();this.genericErrorMsg=this.genericError.find(".error-msg")}this.genericSuccess=this.el.find(".general-success");if(this.genericSuccess.length==0){this.el.find("fieldset").prepend('<div class="input-group general-success success"><div class="success-msg"></div></div>');this.genericSuccess=this.el.find(".general-success");this.genericSuccess.hide();this.genericSuccessMsg=this.genericSuccess.find(".success-msg")}this.inputs={};var a=this.el.find("input, select, textarea");for(var d=0;d<a.length;d++){var b=$(a[d]),c=b.attr("name");if(c){this.inputs[c]=b}}this.inputGroups={};this.el.find("[rel=tooltip]").tooltip()};WikiaForm.prototype.showGenericError=function(a){this.genericError.show();this.showErrorMsg(this.genericError,a)};WikiaForm.prototype.showGenericSuccess=function(a){this.genericSuccess.show();this.showSuccessMsg(this.genericSuccess,a)};WikiaForm.prototype.getInputGroup=function(c){var a=this.inputGroups[c];if(!a){a=this.inputs[c].closest(".input-group");if(!a.exists()){var b=this.el.find("input[name="+c+"]");if(b.exists()){a=b.closest(".input-group")}}if(a.exists()){this.inputGroups[c]=a}}return a};WikiaForm.prototype.showInputError=function(b,c){var a=this.getInputGroup(b);if(a){a.addClass("error");this.showErrorMsg(a,c)}};WikiaForm.prototype.clearInputError=function(b){var a=this.getInputGroup(b);a.removeClass("error");this.clearErrorMsg(a)};WikiaForm.prototype.showErrorMsg=function(a,c){var b=a.find(".error-msg");if(!b.length){b='<div class="error-msg"></div>';a.append(b);b=a.find(".error-msg")}b.html(c)};WikiaForm.prototype.showSuccessMsg=function(b,c){var a=b.find(".success-msg");if(!a.length){a='<div class="success-msg"></div>';b.append(a);a=b.find(".success-msg")}a.text(c)};WikiaForm.prototype.clearErrorMsg=function(a){a.find(".error-msg").remove()};WikiaForm.prototype.clearSuccessMsg=function(a){a.find(".success-msg").remove()};WikiaForm.prototype.clearGenericError=function(a){a.hide().find(".error-msg").remove()};WikiaForm.prototype.clearGenericSuccess=function(a){a.hide().find(".success-msg").remove()};WikiaForm.prototype.clearAllInputErrors=function(){for(var a in this.inputGroups){this.clearInputError(a)}};define("wikia.csspropshelper",["wikia.document"],function(b){var d=["Moz","webkit","ms","O"],a=d.length;function g(j){var h=b.documentElement,k,l=j.length;for(k=0;k<l;k++){var m=j[k];if(m in h.style){return m}}return false}function f(m){var j,h=[m],k=m.charAt(0).toUpperCase()+m.slice(1);for(j=0;j<a;j++){var l=d[j]+k;h.push(l)}return h}function e(o){var k,m=o.split("-"),l=m.length,h=[m[0]];for(k=1;k<l;k++){var j=m[k],n=j.charAt(0).toUpperCase()+j.slice(1);h.push(n)}return h.join("")}function c(l){var j=e(l),k=f(j),h=g(k);if(h===false){throw new Error("Requested CSS property - "+l+" is not supported by your browser!")}return h}return{formatName:e,getSupportedProp:c}});define("wikia.fluidlayout",function(){var r=768,t=1300,s=1030,d=20,l=1,e=170,b=1023,f=300;function h(){return r}function c(){return t}function g(){return d}function o(){return l}function m(){return d/2}function j(){return b}function a(){return s}function k(){return s+2*e}function n(){return r}function p(){return t+2*e}function q(){return f}return{getMinArticleWidth:h,getMaxArticleWidth:c,getWidthGutter:g,getArticleBorderWidth:o,getWidthPadding:m,getBreakpointSmall:j,getBreakpointContent:a,getBreakpointFluid:k,getBreakpointMin:n,getBreakpointMax:p,getRightRailWidth:q}});define("wikia.preview",["wikia.window","wikia.nirvana","jquery","wikia.loader","wikia.mustache","JSMessages","wikia.tracker","wikia.csspropshelper","wikia.fluidlayout"],function(j,c,d,l,a,f,e,p,m){var u,x=m.getWidthPadding()+m.getArticleBorderWidth(),g=m.getRightRailWidth(),w=false,o=false,s,b=80,k=null;function v(B,z,C){z=d.extend({callback:function(){var D=d("#EditPageDialog .ArticlePreviewInner");D.bind("click",function(E){var F=d(E.target);F.closest("a").not('[href^="#"]').attr("target","_blank")}).closest(".ArticlePreview").css({height:z.height||(d(j).height()-250),overflow:"auto","overflow-x":"hidden"});if(typeof C=="function"){C(D)}},id:"EditPageDialog",width:680},z);var A='<div class="ArticlePreview"><div class="ArticlePreviewInner"><img src="'+stylepath+'/common/images/ajax.gif" class="loading"></div></div>';d.showCustomModal(B,A,z)}function t(z){w=(z.isRailDropped)?true:false;o=(z.isWidePage)?true:false;k=h(o);var A={buttons:[{id:"close",message:f("back"),handler:function(){d("#EditPageDialog").closeModal()}},{id:"publish",defaultButton:true,message:f("savearticle"),handler:z.onPublishButton}],width:((w===false&&o===false)||!j.wgOasisResponsive)?z.width:z.width-b,className:"preview",onClose:function(){d(j).trigger("EditPagePreviewClosed")}};d(j).trigger("EditPageRenderPreview",[A]);v(f("preview"),A,function(B){u=B;z.getPreviewContent(function(D,C){B.html(D);if(j.wgOasisResponsive){if(w||o){B.width(z.width-x*2)}k.current.value=B.width();s=B.parent().width();s-=z.scrollbarWidth;q(k.current.name);l({type:l.MULTI,resources:{mustache:"extensions/wikia/EditPreview/templates/preview_type_dropdown.mustache"}}).done(function(E){var H=d("#EditPageDialog"),G=E.mustache[0],J={options:[{value:k.current.name,name:f("wikia-editor-preview-current-width")},{value:k.min.name,name:f("wikia-editor-preview-min-width")},{value:k.max.name,name:f("wikia-editor-preview-max-width")}],toolTipMessage:f("wikia-editor-preview-type-tooltip")},F=a.render(G,J);d(F).insertAfter(H.find("h1:first"));d(j).trigger("EditPageAfterRenderPreview",[B]);d("#previewTypeDropdown").on("change",function(K){r(d(K.target).val())});var I={placement:"right"};if(H[0]&&H[0].style&&H[0].style.zIndex){I["z-index"]=parseInt(H[0].style.zIndex,10)}d(".tooltip-icon").tooltip(I)})}B.find(".editsection").each(function(){d(this).appendTo(d(this).next())});y(B,z.width,C);d(j).trigger("EditPageAfterRenderPreview",[B])})})}function y(D,B,F){if(typeof F!=="undefined"){var E=d("<div>",{id:"EditPagePreviewEditSummary"}),z=D.closest(".ArticlePreview"),G=z.height(),A=200;E.width(B).appendTo(z.parent()).html(F);var H=E.height(),C=G-H;if(C>A){z.height(C)}}}function r(z){u.width(k[z].value);e.track({action:Wikia.Tracker.ACTIONS.CLICK,category:"edit-preview",label:"preview-type-changed",trackingMethod:"both",value:z});q(z)}function q(A){var C=k[A].value,D=s/C,B=p.getSupportedProp("transform"),E=p.getSupportedProp("transform-origin"),z="scale("+D+")";n(A,u);if(C>s){u.css(E,"left top");u.css(B,z)}else{u.css(B,"")}u.hide();u.height();u.show()}function n(B,A){var z;switch(B){case"min":z="min";break;case"max":z="max";break;default:z=""}A.attr("data-size",z)}function h(A){var C=m.getMinArticleWidth(),z=m.getMaxArticleWidth(),B={current:{name:"current",value:null},min:{name:"min",value:C-2*x},max:{name:"max",value:z-2*x}};if(A){B.max.value+=g}return B}return{renderPreview:t,renderDialog:v}});!function(b){var a=function(d,c){this.init("tooltip",d,c)};a.prototype={constructor:a,init:function(f,e,d){var g,c;this.type=f;this.$element=b(e);this.options=this.getOptions(d);this.enabled=true;if(this.options.trigger!="manual"){g=this.options.trigger=="hover"?"mouseenter":"focus";c=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(g,this.options.selector,b.proxy(this.enter,this));this.$element.on(c,this.options.selector,b.proxy(this.leave,this))}this.options.selector?(this._options=b.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());if(c.delay&&typeof c.delay=="number"){c.delay={show:c.delay,hide:c.delay}}return c},enter:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show){return c.show()}clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){if(c.hoverState=="in"){c.show()}},c.options.delay.show)},leave:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout)}if(!c.options.delay||!c.options.delay.hide){return c.hide()}c.hoverState="out";this.timeout=setTimeout(function(){if(c.hoverState=="out"){c.hide()}},c.options.delay.hide)},show:function(){var g,c,j,e,h,d,f;if(this.hasContent()&&this.enabled){g=this.tip();this.setContent();if(this.options.animation){g.addClass("fade")}d=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement;c=/in/.test(d);g.remove().css({top:0,left:0,display:"block"}).appendTo(c?this.$element:document.body);if(this.options&&this.options["z-index"]){g.css("z-index",this.options["z-index"])}j=this.getPosition(c);e=g[0].offsetWidth;h=g[0].offsetHeight;switch(c?d.split(" ")[1]:d){case"bottom":f={top:j.top+j.height,left:j.left+j.width/2-e/2};break;case"top":f={top:j.top-h,left:j.left+j.width/2-e/2};break;case"left":f={top:j.top+j.height/2-h/2,left:j.left-e};break;case"right":f={top:j.top+j.height/2-h/2,left:j.left+j.width};break;case"wikiaBar":f={top:j.top-h,right:0};break;case"wikiaBarMessage":f={top:j.top-h,right:0};break}g.css(f).addClass(d).addClass("in")}},isHTML:function(c){return typeof c!="string"||(c.charAt(0)==="<"&&c.charAt(c.length-1)===">"&&c.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(c)},setContent:function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.isHTML(c)?"html":"text"](c);d.removeClass("fade in top bottom left right")},hide:function(){var c=this,d=this.tip();d.removeClass("in");function e(){var f=setTimeout(function(){d.off(b.support.transition.end).remove()},500);d.one(b.support.transition.end,function(){clearTimeout(f);d.remove()})}b.support.transition&&this.$tip.hasClass("fade")?e():d.remove();return this},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("data-original-title"))!="string"){c.attr("data-original-title",c.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},(c?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,c=this.$element,d=this.options;e=c.attr("data-original-title")||(typeof d.title=="function"?d.title.call(c[0]):d.title);return e},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),e=f.data("tooltip"),d=typeof c=="object"&&c;if(!e){f.data("tooltip",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);!function(b){var a=function(d,c){this.init("popover",d,c)};a.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:a,setContent:function(){var e=this.tip(),d=this.getTitle(),c=this.getContent();e.find(".popover-title")[this.isHTML(d)?"html":"text"](d);e.find(".popover-content")[this.isHTML(c)?"html":"text"](c);e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var d,c=this.$element,e=this.options;d=c.attr("data-content")||(typeof e.content=="function"?e.content.call(c[0]):e.content);return d},tip:function(){if(!this.$tip){this.$tip=b(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});b.fn.popover=function(c){return this.each(function(){var f=b(this),e=f.data("popover"),d=typeof c=="object"&&c;if(!e){f.data("popover",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.popover.Constructor=a;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"></div></div></div>'})}(window.jQuery);(function(b,d){var e=function(f){this.settings={mouseoverDelay:300,mouseoutDelay:350};this.mouseoverTimer=null;this.mouseoutTimer=null;this.mouseoverTimerRunning=false;this.event={};this.selector=f;this.menu=d(this.selector);if(!this.menu.find("ul").exists()){d().log("skipping "+this.selector,"HoverMenu");return}this.menu.children("li").hover(d.proxy(this.mouseover,this),d.proxy(this.mouseout,this));this.menu.children("li").children("a").focus(d.proxy(function(g){this.hideNav();this.showNav(d(g.currentTarget).closest("li"))},this));this.menu.find(".subnav a").focus(d.proxy(function(g){this.hideNav();this.showNav(d(g.currentTarget).closest(".subnav").closest("li"))},this));this.menu.children("li").first().children("a").focusout(d.proxy(this.hideNav,this));this.menu.find(".subnav>li:last-child li:last-child a").focusout(d.proxy(this.hideNav,this))};var c=false;e.prototype.mouseover=function(j){this.event=j;this.menu.children("li").children("ul").not(d(j.currentTarget).find("ul")).removeClass("show");clearTimeout(this.mouseoutTimer);if(this.selector=="#GlobalNavigation"&&!c){var f=d(this.selector),g=f.children("li"),h=g.map(function(){return d(this).data("index")}).get();c=true;d.nirvana.sendRequest({controller:"GlobalHeaderController",method:"menuItemsAll",format:"json",type:"GET",data:{hash:f.data("hash"),indexes:h},callback:d.proxy(function(k){d.each(k,function(l,m){g.filter(function(){return d(this).data("index")==l}).find(".subnav").html(m)});if(this.event.type=="mouseover"){this.handleShowNav(j)}},this)})}else{this.handleShowNav(j)}};e.prototype.handleShowNav=function(f){if(d(f.relatedTarget).closest(this.selector).length==0){var g=f.currentTarget;this.mouseoverTimer=setTimeout(d.proxy(function(){this.showNav(g)},this),this.settings.mouseoverDelay);this.mouseoverTimerRunning=true}else{if(this.mouseoverTimerRunning){clearTimeout(this.mouseoverTimer);this.mouseoverTimer=setTimeout(d.proxy(function(){this.showNav(f.currentTarget)},this),this.settings.mouseoverDelay)}else{this.showNav(f.currentTarget)}}};e.prototype.mouseout=function(f){this.event=f;if(d(f.relatedTarget).closest(this.selector).length==0){clearTimeout(this.mouseoverTimer);this.mouseoverTimerRunning=false;this.mouseoutTimer=setTimeout(d.proxy(function(){this.hideNav()},this),this.settings.mouseoutDelay)}else{this.hideNav()}};e.prototype.showNav=function(g){var k,l=d(g).children("ul");b.HoverMenuGlobal.hideAll();this.mouseoverTimerRunning=false;if(l.exists()){l.addClass("show");l.trigger("hovermenu-shown");if(this.selector=="#GlobalNavigation"){var f=d(g).index()+1,j="_SPOTLIGHT_GLOBALNAV_"+f,h=b["fillIframe"+j]||b["fillElem"+j];if(h){h();h=null}}}};e.prototype.hideNav=function(){var f,g=this.menu.find(".subnav");g.removeClass("show");if(g.exists()){g.trigger("hovermenu-hidden")}};var a={menus:[],hideAll:function(){var g=a.menus;for(var f=0;f<g.length;f++){g[f].hideNav()}}};d(function(){a.menus.push(new e("#GlobalNavigation"));a.menus.push(new e("#AccountNavigation"));a.menus.push(new e("#WallNotifications"));d("div.skiplinkcontainer a").focus(function(f){d("body").data("accessible","true");d("#GlobalNavigation .subnav, #WikiHeader .subnav").show()})});b.HoverMenu=e;b.HoverMenuGlobal=a})(this,jQuery);var PageHeader={settings:{mouseoverDelay:300,mouseoutDelay:350},init:function(){if(typeof FB!="undefined"&&typeof FB.Event!="undefined"){FB.Event.subscribe("xfbml.render",function(){var a=$(".commentslikes").children(".likes");a.css("width","auto")})}if(typeof $.browser.msie!="undefined"&&typeof $.browser.version!="undefined"&&$.browser.version&&$.browser.version.substring(0,$.browser.version.indexOf("."))<9){GlobalTriggers.bind("fbinit",function(){$(".likes").each(function(){var b=$(this),a=b.html();b.html("").append(a);FB.XFBML.parse(b.get(0))});$().log("fixed like buttons","FB")})}}};var ProfileSyncButton={init:function(){ProfileSyncButton.attachEventListeners()},attachEventListeners:function(){$("a[data-id=syncprofile]").click(function(){window.location.href=$(this).attr("data-href");return false})}};$(function(){PageHeader.init();ProfileSyncButton.init()});WikiaSearchApp=(function(){function a(b){this.id=b;this.searchForm=$(b);this.positionRight=this.searchForm.innerWidth()-this.searchForm.children("input:first-child").outerWidth()+4;this.searchField=this.searchForm.children("input[placeholder]");this.ads=$("[id$='TOP_RIGHT_BOXAD']");if(!this.searchForm.hasClass("noautocomplete")){this.searchField.bind({suggestShow:$.proxy(this.hideAds,this),suggestHide:$.proxy(this.showAds,this)});this.searchField.one("focus",$.proxy(this.initSuggest,this))}}a.prototype.track=Wikia.Tracker.buildTrackingFunction({trackingMethod:"internal"});a.prototype.hideAds=function(){this.ads.each(function(){$(this).children().css("margin-left","-9999px")})};a.prototype.showAds=function(){this.ads.each(function(){$(this).children().css("margin-left","auto")})};a.prototype.initSuggest=function(){$.when($.loadJQueryAutocomplete()).then($.proxy(function(){this.searchField.autocomplete({serviceUrl:wgServer+wgScript+"?action=ajax&rs=getLinkSuggest&format=json",onSelect:$.proxy(function(f,e,d){var c=encodeURIComponent(f.replace(/ /g,"_")),b=wgArticlePath.replace(/\$1/,c).replace(encodeURIComponent("/"),"/");this.track({eventName:"search_start_suggest",sterm:c,rver:0});if(d.button===1||d.metaKey||d.ctrlKey){window.open(b);return false}else{window.location.href=b}},this),appendTo:this.id,deferRequestBy:400,minLength:3,maxHeight:1000,selectedClass:"selected",width:"100%",positionRight:this.positionRight+"px",skipBadQueries:true});if(window.Wikia.newSearchSuggestions){window.Wikia.newSearchSuggestions.setAsMainSuggestions("search")}},this))};return a})();$(function(){new WikiaSearchApp("#WikiaSearch");new WikiaSearchApp("#HeaderWikiaSearch")});var WikiaFooterApp={init:function(){if(window.wgEnableWikiaBarExt){this.footer=$("#WikiaBarWrapper").find(".wikia-bar")}else{this.footer=$("#WikiaFooter")}this.toolbar=this.footer.children(".toolbar");this.gn=$(".global-notification");this.windowObj=$(window);this.originalWidth=this.toolbar.width();if(this.toolbar.exists()||this.gn.exists()){if(!(navigator.platform in {iPad:"",iPhone:"",iPod:""}||(navigator.userAgent.match(/android/i)!==null))){this.addScrollEvent();this.addResizeEvent()}this.tcToolbar=new ToolbarCustomize.Toolbar(this.footer.find(".tools"))}},addScrollEvent:function(){WikiaFooterApp.windowObj.off("scroll.FooterAp");WikiaFooterApp.windowObj.on("scroll.FooterAp",WikiaFooterApp.resolvePosition).triggerHandler("scroll")},addResizeEvent:function(){WikiaFooterApp.windowObj.on("resize",WikiaFooterApp.centerBar).triggerHandler("resize")},centerBar:function(){var a=WikiaFooterApp.windowObj.width();if(a<WikiaFooterApp.originalWidth&&WikiaFooterApp.footer.hasClass("float")){WikiaFooterApp.toolbar.css("width",a+10);if(!WikiaFooterApp.toolbar.hasClass("small")){WikiaFooterApp.toolbar.addClass("small")}}else{if(WikiaFooterApp.toolbar.hasClass("small")){WikiaFooterApp.toolbar.css("width",WikiaFooterApp.originalWidth);WikiaFooterApp.toolbar.removeClass("small")}}WikiaFooterApp.resolvePosition()},resolvePosition:function(){if(window.wgIsEditPage){return}var c=WikiaFooterApp.windowObj.scrollTop(),a=c+WikiaFooterApp.windowObj.height(),b=0;if(WikiaFooterApp.footer.offset()){b=WikiaFooterApp.footer.offset().top+WikiaFooterApp.toolbar.outerHeight()}if(a>b&&WikiaFooterApp.footer.hasClass("float")){WikiaFooterApp.footer.removeClass("float");WikiaFooterApp.centerBar()}else{if(a<b&&!WikiaFooterApp.footer.hasClass("float")){WikiaFooterApp.footer.addClass("float");WikiaFooterApp.centerBar()}}if(window.GlobalNotification&&!window.GlobalNotification.isModal()){window.GlobalNotification.onScroll(c)}}};(function(){window.ToolbarCustomize=window.ToolbarCustomize||{};var a=window.ToolbarCustomize;a.MenuGroup=$.createClass(window.Observable,{showTimer:false,hideTimer:false,showTimeout:300,hideTimeout:350,showing:false,visible:false,constructor:function(){a.MenuGroup.superclass.constructor.call(this);this.showTimer=window.Timer.create($.proxy(this.show,this),this.showTimeout);this.hideTimer=window.Timer.create($.proxy(this.hide,this),this.hideTimeout)},add:function(b){var c=$(b);c.unbind(".menugroup").bind("mouseenter.menugroup",$.proxy(this.delayedShow,this)).bind("mouseleave.menugroup",$.proxy(this.delayedHide,this)).children("a","img").unbind(".menugroup").bind("click.menugroup",$.proxy(this.showOnClick,this))},remove:function(b){$(b).unbind(".menugroup").children("a","img").unbind(".menugroup")},show:function(){this.hideTimer.stop();this.showTimer.stop();if(!this.showing||this.visible===this.showing){return}if(this.visible){this.hide()}if(this.showing){this.visible=this.showing;this.showing=false;this.fire("menushow",this,this.visible,this.visible.children("ul"));this.visible.children("ul").show()}},delayedShow:function(b){this.showing=$(b.currentTarget);if(this.visible){this.show(b)}else{this.hideTimer.stop();this.showTimer.start()}},showOnClick:function(b){b.preventDefault();this.showing=$(b.currentTarget).parent();this.show(b)},hide:function(){this.hideTimer.stop();this.showTimer.stop();if(this.visible){this.fire("menuhide",this,this.visible,this.visible.children("ul"));this.visible.children("ul").hide();this.visible=false}},delayedHide:function(){this.hideTimer.stop();if(this.visible){this.hideTimer.start()}else{if(this.showing){this.showing=false;this.showTimer.start()}}}});a.Toolbar=$.createClass(Object,{el:false,more:false,menuGroup:false,constructor:function(b){a.Toolbar.superclass.constructor.call(this);this.el=b;this.menuGroup=new a.MenuGroup();this.menuGroup.bind("menushow",this.onShowMenu,this);this.initialize()},initialize:function(){this.el.find(".tools-customize").click($.proxy(this.openConfiguration,this));this.menuGroup.add(this.el.find("li.menu"));this.handleOverflowMenu()},openConfiguration:function(b){b.preventDefault();var c=new a.ConfigurationLoader(this);c.show()},buildOveflowItem:function(){return this.el.find(".overflow-menu")},generateMediaQuery:function(f,d){var c=true,b="",e=f.length;f.each(function(j,h){var g=$(h).outerWidth(true);b+="@media screen ";if(!c){b+="and (min-width:"+d+"px) "}b+="and (max-width:"+(d+g)+"px) { .WikiaBarWrapper .tools > .overflow:nth-of-type(n + "+(j+1)+") { display:none; } .WikiaBarWrapper .tools .overflow-menu {  display: block; }.WikiaBarWrapper .tools .overflow-menu .overflow:nth-of-type(-n + "+(e-j)+") { display:block; }} ";d+=g;c=false});return b},getMinWidth:function(d){var e=this.el.parents(".wikia-bar:first").find(".arrow"),c=parseInt(this.el.css("padding-left"),10)+e.outerWidth(true),b=d.filter(":not(.overflow)");b.each(function(g,f){c+=$(f).outerWidth(true)});return c},generateSubMenu:function(e){var b=e.last().next(),d=this.buildOveflowItem(),c=d.children("ul").empty();if(b.exists()){b.before(d)}else{this.el.append(d)}e.each(function(g,f){$(f).clone().prependTo(c)});this.menuGroup.add(d,$.proxy(this.onShowMenu,this))},addStyles:function(c){var b=$("#WikiaFooterMediaQueries");if(!b.exists()){b=$(document.createElement("style")).attr({type:"text/css",id:"WikiaFooterMediaQueries"})}b.html(c).appendTo("head")},handleOverflowMenu:function(){var c=this.el.children("li"),d=c.filter(".overflow"),b=this.getMinWidth(c);this.addStyles(this.generateMediaQuery(d,b));this.generateSubMenu(d)},onShowMenu:function(c,b,d){d.css("left",(b.offset().left-this.el.offset().left)+"px");d.css("right","auto")},load:function(b){this.el.children("li").not(".loadtime").remove();this.el.prepend($(b));this.initialize()}});a.ConfigurationLoader=$.createClass(Object,{constructor:function(b){this.toolbar=b},show:function(){$.loadLibrary("ToolbarCustomize",window.stylepath+"/oasis/js/ToolbarCustomize.js",typeof a.Configuration,$.proxy(function(){var b=new a.Configuration(this.toolbar);b.show()},this))}})})();$(function(){WikiaFooterApp.init()});require(["JSMessages","wikia.cookies","wikia.tracker","jquery","wikia.querystring","wikia.window"],function(g,e,d,f,a,c){var b=f(".CorporateFooter ul").first();if(f().isTouchscreen()&&b.exists()){g.get("Oasis-mobile-switch").then(function(){var h=f('<li><a href="#">'+g("oasis-mobile-site")+"</a></li>");h.on("click",function(j){j.preventDefault();j.stopPropagation();e.set("mobilefullsite",null);e.set("useskin","wikiamobile",{domain:c.wgCookieDomain,path:c.wgCookiePath});d.track({category:"corporate-footer",action:d.ACTIONS.CLICK_LINK_BUTTON,label:"mobile-switch",trackingMethod:"both"});a().setVal("useskin","wikiamobile").addCb().goTo()});b.append(h)})}});var WikiaButtons={settings:{delay:350},init:function(a){if(typeof a=="object"){WikiaButtons.menuButtons=$(".wikia-menu-button",a)}else{WikiaButtons.menuButtons=$(".wikia-menu-button")}WikiaButtons.timer=null;WikiaButtons.add(WikiaButtons.menuButtons)},add:function(d,b){var c={click:WikiaButtons.click};var a=$.extend({},c,b||{});d.unbind(".wikiabutton").one("mouseover.wikiabutton",WikiaButtons.setup).bind("mouseenter.wikiabutton",WikiaButtons.mouseover).bind("mouseleave.wikiabutton",WikiaButtons.mouseout);d.filter(".combined").bind("click.wikiabutton",a.click);d.not(".combined").find(".drop").bind("click.wikiabutton",a.click)},setup:function(){$(this).data("menu",$(this).find("ul"))},click:function(c){var a=$(this).closest(".wikia-menu-button");if(!a.attr("disabled")){if(c.target.tagName!=="A"){var b=a.outerWidth();if(b!==a.data("prevWidth")){a.data("prevWidth",b);var d=a.data("menu");b=b-(parseInt(d.css("padding-left"))+parseInt(d.css("padding-right"))+parseInt(d.css("border-left-width"))+parseInt(d.css("border-right-width")));d.css("min-width",b)}a.toggleClass("active")}}else{c.preventDefault();return false}},mouseover:function(){clearTimeout(WikiaButtons.timer)},mouseout:function(b){var a=$(b.target).closest(".wikia-menu-button").attr("data-delay");if((typeof a)!="string"){a=WikiaButtons.settings.delay}WikiaButtons.timer=setTimeout(function(){$(b.currentTarget).removeClass("active")},a)}};$(function(){WikiaButtons.init()});var WikiHeader={lastSubnavClicked:-1,isDisplayed:false,activeL1:null,isTouchScreen:$().isTouchscreen(),settings:{mouseoverDelay:this.isTouchScreen?0:200,mouseoutDelay:this.isTouchScreen?0:350},log:function(a){$().log(a,"WikiHeader")},init:function(c){this.nav=$("#WikiHeader > nav");this.navLI=this.nav.find(".nav-item");this.subnav2=this.nav.find(".subnav-2");this.subnav2LI=this.subnav2.find(".subnav-2-item");this.subnav3=this.nav.find(".subnav-3");this.positionNav();this.navLI.hover($.proxy(this.mouseoverL1,this),$.proxy(this.mouseoutL1,this));this.subnav2LI.hover($.proxy(this.mouseoverL2,this),$.proxy(this.mouseoutL2,this));this.navLI.click($.proxy(this.mouseclickL1,this)).children("a").focus($.proxy(function(g){this.showSubNavL2($(g.target).parent("li"))},this));this.subnav2LI.click($.proxy(this.mouseclickL2,this)).children("a").focus($.proxy(function(g){this.hideNavL3();this.showSubNavL3($(g.target).parent("li"))},this));if((window.wgIsWikiNavMessage)&&(wgAction=="edit")){$("#wpSave").hide()}var e=false;this.subnav3.find("a").bind("mousedown",function(){e=true}).bind("mouseup",function(){e=false}).focus($.proxy(function(g){if(!e){this.hideNavL3();this.showSubNavL3($(g.currentTarget).closest(".subnav").parent("li"))}},this));this.subnav3.find("li:first-child a").focusout(this.hideNavL3);this.subnav3.last().find("li:last-child a").focusout(this.hideNavL3);$(document).mouseout($.proxy(function(g){if(this.isDisplayed){var h=g.relatedTarget||g.toElement;if(!h||h.nodeName=="HTML"){this.hideNavL3()}}},this));if(!c){var d,a,f=this.subnav2LI.height(),b=0;this.subnav2.each(function(g){d=$(this);if(d.height()>f){a=d.children("li").reverse();if(g>0){d.css("visibility","hidden").show()}a.each(function(){var h=$(this),j=h.position();if(j.top===0){return false}else{h.remove();b++}});if(g>0){d.css("visibility","visible").hide()}}});if(b>0){this.log("items removed: "+b)}}},mouseclickL1:function(c){if(!$(c.currentTarget).hasClass("marked")){c.preventDefault();this.subnav2LI.removeClass("marked2");this.navLI.removeClass("marked");this.hideNavL3();$(c.currentTarget).addClass("marked");var a=this.subnav2.not();if($("body").data("accessible")){a.css("top","-9999px")}else{a.hide()}this.activeL1=c.currentTarget;this.showSubNavL2(c.currentTarget)}var b=$(c.target);if(b.is("a")&&b.attr("data-canonical")=="chat"){c.preventDefault();ChatEntryPoint.onClickChatButton(b.attr("href"))}},mouseoverL1:function(b){var a=b.currentTarget;if(this.activeL1===a){return}this.mouseoverTimer=setTimeout($.proxy(function(){this.navLI.removeClass("marked");this.hideNavL3();$(a).addClass("marked");var c=this.subnav2.not();if($("body").data("accessible")){c.css("top","-9999px")}else{c.hide()}this.activeL1=a;this.showSubNavL2(a)},this),this.settings.mouseoverDelay)},mouseoutL1:function(a){clearTimeout(this.mouseoverTimer)},mouseclickL2:function(b){var a=this.subnav3.not($(b.currentTarget).find(".subnav"));if($(b.currentTarget).find(".subnav").exists()&&!$(b.currentTarget).hasClass("marked2")){this.hideNavL3();b.preventDefault();$(b.currentTarget).addClass("marked2");if($("body").data("accessible")){a.css("top","-9999px")}else{a.hide()}this.showSubNavL3(b.currentTarget)}},mouseoverL2:function(b){var a=b.currentTarget;clearTimeout(this.mouseoutTimer);this.mouseoverTimer=setTimeout($.proxy(function(){var c=this.subnav3.not($(a).find(".subnav"));if($("body").data("accessible")){c.css("top","-9999px")}else{c.hide()}$(a).siblings().removeClass("marked2");this.showSubNavL3(a)},this),this.settings.mouseoverDelay)},mouseoutL2:function(){clearTimeout(this.mouseoverTimer);this.mouseoutTimer=setTimeout($.proxy(function(){this.hideNavL3()},this),this.settings.mouseoutDelay)},showSubNavL2:function(a){var b=$(a).children("ul");if(b.exists()){b.show()}},showSubNavL3:function(a){var b=$(a).children("ul");if(b.exists()){$(a).addClass("marked2");this.isDisplayed=true;b.css("top",this.navtop).show()}},hideNavL3:function(){this.isDisplayed=false;this.lastSubnavClicked=-1;this.subnav2LI.removeClass("marked2");if($("body").data("accessible")){this.subnav3.css("top","-9999px")}else{this.subnav3.hide()}},positionNav:function(){this.navtop=this.nav.height()-7},firstMenuValidator:function(){var c=0,b=true,a=$(".ArticlePreview #WikiHeader > nav > ul > li");a.reverse().each($.proxy(function(d,f){var e=$(f),g=e.position();if(g.top===0){return false}else{b=false;this.log("menu level #1 not valid")}},this));a.each(function(d,e){c+=$(e).width()});if(c>550){b=false;this.log("menu level #1 not valid")}return b},secondMenuValidator:function(){var d=0,b=true,c=$("#WikiaPage").width()-280,a=$(".ArticlePreview #WikiHeader .subnav-2");$.each(a,$.proxy(function(e,f){var g=$(f);g.show();$.each(g.children("li"),function(){d+=$(this).width()});g.hide();if(d>c){b=false;this.log("menu level #2 not valid")}d=0},this));a.eq(0).show();return b}};jQuery(function(a){WikiHeader.init();if(window.wgIsWikiNavMessage){a.getMessages("Oasis-navigation-v2").done(function(){a("#EditPageRail .module_page_controls .module_content").append('<div class="preview-validator-desc">'+a.msg("oasis-navigation-v2-validation-caption")+"</div>")});a(window).bind("EditPageRenderPreview",function(c,b){b.width=(a("#WikiaPage").width()-271)+32});a(window).bind("EditPageAfterRenderPreview",function(f,c){c.removeClass("WikiaArticle");WikiHeader.init(true);var e=WikiHeader.firstMenuValidator(),g=WikiHeader.secondMenuValidator(),b=!!c.find("nav > ul").attr("data-parse-errors"),h=[];if(b){h.push(a.msg("oasis-navigation-v2-magic-word-validation"))}if(!e&&!g){h.push(a.msg("oasis-navigation-v2-level12-validation"))}else{if(!e){h.push(a.msg("oasis-navigation-v2-level1-validation"))}else{if(!g){h.push(a.msg("oasis-navigation-v2-level2-validation"))}}}if(h.length>0){a("#publish").remove();var d='<div class="global-notification error"><div class="msg">'+h.join("</br>")+"</div></div>";a(".modalContent .ArticlePreview").prepend(d)}c.find("nav > ul a").click(function(){if(a(this).attr("href")=="#"){return false}});c.find(".msg > a").click(function(){window.location=this.href})});a("#wpPreview").parent().removeClass("secondary");a("#EditPageMain").addClass("editpage-wikianavmode")}});(function(b){var a={node:false,init:function(){this.node=b(".WikiaArticleInterlang");b(".more-link",this.node).click(b.proxy(this.showAll,this))},showAll:function(c){c.preventDefault();b(".more-link",this.node).hide();b(".more",this.node).show()}};b(function(){a.init()})}(jQuery));var WikiaNotificationsApp={purgeCurrentPage:function(){$.post(wgScript,{action:"purge",title:wgPageName})},track:Wikia.Tracker.buildTrackingFunction({category:"sitewidemessages",trackingMethod:"internal"}),init:function(){var a=this,b=$("#WikiaNotifications");b.find(".close-notification").click(function(e){var g=$(this).parent();var f=parseInt(g.attr("data-type"));switch(f){case 1:$.post(wgScript,{action:"ajax",rs:"wfDismissWikiaNewtalks"},WikiaNotificationsApp.purgeCurrentPage);g.parent().remove();break;case 2:$.post(wgScript,{action:"ajax",rs:"CommunityMessagesAjax",method:"dismissMessage"},WikiaNotificationsApp.purgeCurrentPage);g.parent().remove();break;case 5:var d=parseInt(g.attr("id").substr(4));var h=g.next();$.post(wgScript,{title:"Special:SiteWideMessages",action:"dismiss",mID:d},WikiaNotificationsApp.purgeCurrentPage);a.track({action:Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,browserEvent:e,label:"swm-dismiss",value:d});g.remove();h.css("display","block");if(h.length){var c=parseInt(h.attr("id").substr(4));a.track({action:Wikia.Tracker.ACTIONS.IMPRESSION,label:"swm-impression",value:c})}break;case 10:$.post($(this).attr("data-url"),WikiaNotificationsApp.purgeCurrentPage);g.parent().remove();break;default:g.parent().remove();break}})}};$(function(){WikiaNotificationsApp.init()});(function(b){var a={scrollThreshold:30,lastScroll:0,init:function(){b(window).scroll(b.proxy(this.analyze,this)).mousedown(b.proxy(this.cancelTimer,this))},analyze:function(){if(window.getSelection().toString()){var c=b(window).scrollTop();if(c>this.lastScroll+this.scrollThreshold){this.adjust()}this.lastScroll=c}},adjust:function(){b(window).scrollTop(b(window).scrollTop()+this.scrollThreshold);this.anchorOffset=window.getSelection().anchorOffset;if(!this.timer){this.timer=setInterval(this.monitorHighlight,250)}},monitorHighlight:function(){if(window.getSelection().anchorOffset!=this.anchorOffset){if(this.timer){this.adjust()}}},cancelTimer:function(){if(this.timer){clearInterval(this.timer);this.timer=null}}};if(b.browser.mozilla){b(function(){if(b("#WikiaFooter .toolbar").exists()){a.init()}})}}(jQuery));if($().isTouchscreen()){$.getResources([$.getSassCommonURL("/skins/oasis/css/touchScreen.scss"),stylepath+"/oasis/js/touchScreen.js"])}jQuery(function(a){a("body").on("click",".tabs a",function(b){if(a(this).parent().hasClass("disabled")){return}var c=a(this).parent().data("tab");if(a('[data-tab-body="'+c+'"]').length>0){b.preventDefault();var d=a(this).closest("ul").find(".selected").removeClass("selected").data("tab");a(this).closest("li").addClass("selected");a('[data-tab-body="'+d+'"]').removeClass("selected");a('[data-tab-body="'+c+'"]').addClass("selected");a(window).trigger("wikiaTabClicked",[c])}else{a().log('Tried to switch to tab but could not find data-tab-body: "'+c+'"')}})});jQuery(function(e){var c,b=e("#WikiHeader"),d=b.find(".share-button");function a(g){d.addClass("share-enabled");var f=window.wgOasisGrid?3:0;if(window.wgOasisResponsive){f=2}require(["wikia.loader","mw"],function(h,j){h({type:h.MULTI,resources:{scripts:"sharingtoolbar_js",templates:[{controller:"SharingToolbar",method:"Index",params:{pagename:j.config.get("wgPageName")}}]}},{type:h.SCSS,resources:"/skins/oasis/css/core/SharingToolbar.scss",params:{widthType:f}}).done(function(k){h.processScript(k.scripts);c=e(k.templates.SharingToolbar_Index);b.append(c.addClass("loading"));Wikia.SharingToolbar.init({button:d,event:g,toolbar:c});Wikia.ShareButtons.process().done(function(){Wikia.SharingToolbar.toggleToolbar(g)})})})}if(Wikia.AbTest&&Wikia.AbTest.getGroup("SHARE_BUTTON")=="ON"){a(e.Event())}else{d.one("click",a)}});jQuery(function(f){var e=f("body"),a=f("#WikiaArticle"),k=f("#WikiaRail"),b=f("#WikiHeader"),d=/&diff=\d+/,h=/&action=history/;var c=Wikia.Tracker.buildTrackingFunction({action:Wikia.Tracker.ACTIONS.CLICK,trackingMethod:"ga"});var g=function(m){if(m.type==="mousedown"&&m.which!==1){return}c({browserEvent:m},m.data)};var l=(function(){var m=Array.prototype.slice;return function(){var o=window.WikiaEditor&&WikiaEditor.getInstance(),n=Wikia.Tracker.track;if(o&&(!o.config.isMiniEditor||o.plugins.MiniEditor.hasFocus)){n=WikiaEditor.track}n.apply(n,m.call(arguments))}})();(function(){var m="article";if(e.hasClass("ns-special")){return}f("#WikiaPageHeader").on("mousedown","a",function(p){var n,o=f(p.currentTarget),q=o.data("id");if(p.which!==1){return}switch(q){case"comment":n=o.hasClass("talk")?"talk":"comment";break;case"edit":n=q;break;case"delete":case"history":case"move":case"protect":n="edit-"+q;break}if(n!==undefined){c({browserEvent:p,category:m,label:n})}});a.on("mousedown","a",function(p){var n,o=f(p.currentTarget);if(p.which!==1){return}if(o.hasClass("video")){n="video"}else{if(o.hasClass("image")){n="image"}else{if(o.hasClass("external")){n="link-external"}else{if(o.hasClass("wikia-photogallery-add")){n="add-photo-to-gallery"}else{if(o.prop("className")==""){n="link-internal"}}}}}if(n!==undefined){c({browserEvent:p,category:m,label:n})}}).on("mousedown",".editsection a",{category:m,label:"section-edit"},g);f("#WikiaArticleCategories").on("mousedown","a",{category:m,label:"category-name"},g).on("mousedown",".add",{category:m,label:"add-category"},g)})();(function(){var m="category";a.on("mousedown",".category-gallery a",{category:m,label:"category-gallery"},g);f("#mw-pages").on("mousedown","a",{category:m,label:"category-item"},g)})();b.find(".buttons .contribute").on("mousedown","a",function(o){var m,n=f(o.target),p=n.data("id");if(o.which!==1){return}switch(p){case"createpage":m="add-a-page";break;case"edit":m="edit-a-page";break;case"upload":m="add-a-photo";break;case"wikiavideoadd":m="add-a-video";break;case"wikiactivity":m="wiki-activity";break;case"wikinavedit":m="edit-wiki-navigation";break}if(m!==undefined){c({browserEvent:o,category:"contribute",label:m})}});if(e.hasClass("page-Special_RecentChanges")){a.find(".rc-conntent").on("mousedown","a",function(p){var n,o=f(p.target),m=o.attr("href");if(p.which!==1){return}if(d.test(m)){n="diff"}else{if(h.test(m)){n="history"}else{if(o.hasClass("mw-userlink")){n="username"}else{if(!o.parent().is("span")){n="title"}}}}if(n!==undefined){c({browserEvent:p,category:"recent-changes",label:n})}})}(function(){var q="search",m=false,r=f(".top-wiki-articles"),p=f(".category-articles"),o=f(".WikiaSearch"),s=f(".search-suggest"),n=f(".results-wrapper .no-result");s.on("click","li:not(.all)",{category:q,label:"new-search-suggest"},g).on("newSuggestionsEnter",{category:q,label:"new-search-suggest-enter"},g).on("newSuggestionsSearchEnter",{category:q,label:"new-search-after-suggest-enter"},g).on("newSuggestionsSearchClick",{category:q,label:"new-search-after-suggest-button"},g).one("newSuggestionsShow",{action:Wikia.Tracker.ACTIONS.VIEW,category:q,label:"new-search-suggest-show"},function(t){m=true;g(t)});o.on("mousedown",".wikia-button",function(u){if(u.which===1&&u.clientX>0&&window.Wikia.newSearchSuggestions){var t=!m?"new-search-button":"new-search-after-suggest-button";c({category:q,label:t})}}).on("keypress","[name=search]",function(u){if(u.which===13&&window.Wikia.newSearchSuggestions){var t=!m?"new-search-enter":"new-search-after-suggest-enter";c({category:q,label:t})}});o.on("mousedown",".autocomplete",{category:q,label:"search-suggest"},g).on("mousedown",".wikia-button",function(u){if(u.which===1&&u.clientX>0&&!window.Wikia.newSearchSuggestions){var t=!m?"search-button":"search-after-suggest-button";c({category:q,label:t})}}).on("keypress","[name=search]",function(u){if(u.which===13&&f(this).is(":focus")&&!window.Wikia.newSearchSuggestions){var t=!m?"search-enter":"search-after-suggest-enter";c({category:q,label:t})}}).on("suggestEnter",{category:q,label:"search-suggest-enter"},g).one("suggestShow",{action:Wikia.Tracker.ACTIONS.VIEW,category:q,label:"search-suggest-show"},function(t){m=true;g(t)});q="special-search";if(e.hasClass("page-Special_Search")){if(n.length){c({action:Wikia.Tracker.ACTIONS.VIEW,category:q,label:"empty-page"})}o.on("mousedown",".search-tabs a",function(t){c({browserEvent:t,category:q,label:"sidebar-"+f(t.currentTarget).prop("className")})}).on("mousedown",".Results .result-link",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"result-"+(t.data("event")==="search_click_match"?"push-top":"item-"+t.data("pos")),trackingMethod:"both"})}).on("mousedown",".Results .wiki-thumb-tracking",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"result-item-"+t.data("pos")+"-image"+(t.data("event")==="search_click_wiki-no-thumb"?"-placeholder":""),trackingMethod:"both"})}).on("mousedown",".thumb-tracking",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"result-item-image-"+(t.data("event")==="search_click_match"?"push-top":t.data("pos")),trackingMethod:"both"})}).on("mousedown",".image",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"result-"+(t.hasClass("video")?"video":"photo")+((t.parents(".video-addon-results").length>0)?"-video-addon":"")})}).on("mousedown",".video-addon-seach-video",function(t){c({browserEvent:t,category:q,label:"video-addon-results-header"})})}if(r.length){r.on("mousedown",".top-wiki-article-thumbnail a",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"top-module-thumb-"+t.data("pos")})}).on("mousedown",".top-wiki-article-text a",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"top-module-title-"+t.data("pos")})})}if(p.length){p.on("mousedown",".category-articles-thumb a",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"category-module-thumb-"+t.data("pos")})}).on("mousedown",".category-articles-text a",function(u){var t=f(u.currentTarget);c({browserEvent:u,category:q,label:"category-module-title-"+t.data("pos")})})}})();(function(){var m="share";b.on("mousedown",".share-button",{category:m,label:"share-button"},g);b.on("mousedown",".SharingToolbar .email-link",{category:m,label:"email"},g)})();f("#RelatedForumDiscussion").on("mousedown","a",function(o){var m,n=f(o.target);if(o.which!==1){return}if(n.hasClass("forum-thread-title")){m="title"}else{if(n.hasClass("forum-new-post")){m="start-discussion"}else{if(n.parent().hasClass("forum-see-more")){m="see-more"}}}if(m!==undefined){c({browserEvent:o,category:"thread-module",label:m})}});f("#WikiaBarWrapper").on("mousedown",".toolbar a",function(p){var n,o=f(p.target),m=o.data("name");if(p.which!==1){return}switch(m){case"customize":case"follow":case"history":case"whatlinkshere":n=m;break;default:n="custom";break}if(n!==undefined){c({browserEvent:p,category:"toolbar",label:n})}});(function(){var m="top-nav";f("#WikiaHeader").on("mousedown","a",function(p){var n,o=f(p.target),q=o.data("id");if(p.which!==1){return}if(q!==undefined){switch(q){case"facebook":case"register":n=q;break;case"help":case"logout":case"preferences":n="user-menu-"+q;break;case"mytalk":n="user-menu-"+(o.hasClass("message-wall")?"message-wall":"talk");break}}else{if(o.hasClass("logo")){n="wikia-logo"}else{if(o.parent().hasClass("start-a-wiki")){n="start-a-wiki"}else{if(o.closest(".topNav").length>0){n="hub-item"}else{if(o.attr("accesskey")=="."){n="user-menu-profile"}else{if(o.closest(".notifications-for-wiki").length>0){if(f(o.closest(".notifications-for-wiki")).data("wiki-id")==window.wgCityId){n="notification-item-local"}else{n="notification-item-cross-wiki"}}}}}}}if(n!==undefined){c({browserEvent:p,category:m,label:n})}});f("#UserLoginDropdown input[type=submit]").on("mousedown",{category:m,label:"login"},g);f("#wall-notifications-markasread").on("mousedown","span",function(p){var n,o=f(p.target),q=o.attr("id");if(p.which!==1){return}switch(q){case"wall-notifications-markasread-this-wiki":case"wall-notifications-markasread-all-wikis":n=q;break}if(n!==undefined){c({browserEvent:p,category:m,label:n})}})})();if(e.hasClass("page-Special_WikiActivity")){a.find(".activityfeed").on("mousedown","a",function(q){var m,p,o=f(q.target),n=o.parent();if(q.which!==1){return}if(o.hasClass("title")){m="title"}else{if(o.hasClass("username")||o.hasClass("real-name")||n.hasClass("wall-owner")||n.hasClass("subtle")){m="username"}else{if(n.hasClass("activityfeed-diff")){m="diff"}else{p=o.closest("tr").data("type");if(p=="inserted-image"){m="thumbnail-photo"}else{if(p=="inserted-video"){m="thumbnail-video"}}}}}if(m!==undefined){c({browserEvent:q,category:"wiki-activity",label:m})}})}b.on("mousedown","a",function(p){var n,o=f(p.target);if(p.which!==1){return}if(o.closest(".wordmark").length>0){n="wordmark"}else{if(o.closest(".WikiNav").length>0){var m=o.data("canonical");if(m!==undefined){switch(m){case"wikiactivity":n="on-the-wiki-activity";break;case"random":n="on-the-wiki-random";break;case"newfiles":n="on-the-wiki-new-photos";break;case"chat":n="on-the-wiki-chat";break;case"forum":n="on-the-wiki-forum";break;case"videos":n="on-the-wiki-videos";break}}else{if(o.parent().hasClass("nav-item")){n="custom-level-1"}else{if(o.hasClass("subnav-2a")){n="custom-level-2"}else{if(o.hasClass("subnav-3a")){n="custom-level-3"}}}}}}if(n!==undefined){c({browserEvent:p,category:"wiki-nav",label:n})}});function j(){k.find(".ChatModule").on("mousedown",".chat-join",{category:"chat-module",label:"chat-join"},g);k.find(".LatestPhotosModule").on("mousedown","a",function(o){var m,n=f(o.target);if(o.which!==1){return}if(n.hasClass("thumbimage")){m="photos-module-thumbnail"}else{if(n.hasClass("upphotos")){m="photos-module-add"}else{if(n.hasClass("more")){m="photos-module-more"}}}if(m!==undefined){c({browserEvent:o,category:"photos-module",label:m})}});k.find(".WikiaActivityModule").on("mousedown","a",function(o){var m,n=f(o.target);if(o.which!==1){return}if(n.hasClass("more")){m="activity-more"}else{if(n.closest(".edited-by").length>0){m="activity-username"}else{if(n.closest("em").length>0){m="activity-title"}}}if(m!==undefined){c({browserEvent:o,category:"recent-wiki-activity",label:m})}});k.find(".RelatedVideosModule").on("mousedown","a",{category:"related-videos-module",label:"video-thumbnail"},g)}Wikia.trackEditorComponent=l;Wikia.initRailTracking=j});var AdMeldAPIClient={sizes:[],slots:{TOP_RIGHT_BOXAD:{size:"300x250",placement:"%%HUB%%-atf",ad:null,pixels:null},TOP_LEADERBOARD:{size:"728x90",placement:"%%HUB%%-atf",ad:null,pixels:null},LEFT_SKYSCRAPER_2:{size:"160x600",placement:"%%HUB%%-btf",ad:null,pixels:null},PREFOOTER_LEFT_BOXAD:{size:"300x250",placement:"%%HUB%%-btf-left",ad:null,pixels:null},PREFOOTER_RIGHT_BOXAD:{size:"300x250",placement:"%%HUB%%-btf-right",ad:null,pixels:null}}};if(window.cscoreCat==="Gaming"){AdMeldAPIClient.siteHub="gaming"}else{if(window.cscoreCat==="Entertainment"){AdMeldAPIClient.siteHub="entertainment"}else{AdMeldAPIClient.siteHub="lifestyle"}}AdMeldAPIClient.log=function(a,b){if(typeof window.top.Wikia!=="undefined"&&typeof window.top.Wikia.log==="function"){window.top.Wikia.log(a,b,"AdMeldAPIClient")}};AdMeldAPIClient.track=function(c,a){a=a||"admeldapiclient";this.log("track "+c.join("/")+" in "+a,"trace_l3");c[0]="admeldapiclient/"+c[0];var b=c;if(b.length>3){b=[b[0],b[1],b.slice(2).join("/")]}this.log("event: ["+b.join(", ")+"]","trace_l3")};AdMeldAPIClient.getAd=function(a){this.log("getAd "+a,"trace_l2");try{a=a.replace("HOME_","");this.log("slotname HOME_"+a+" replaced with "+a,"trace_l3")}catch(c){}try{return this.slots[a].ad.creative+this.slots[a].pixels.join("\n")}catch(b){this.log("Error in getAd "+a+", returning null","error");this.track(["error","get_ad",a],"error");return null}};AdMeldAPIClient.getBid=function(a){this.log("getBid "+a,"trace_l2");try{a=a.replace("HOME_","");this.log("slotname HOME_"+a+" replaced with "+a,"trace")}catch(c){}try{return this.slots[a].ad.bid}catch(b){this.log("Error in getBid "+a+", returning -1","error");this.track(["error","get_bid",a],"error");return -1}};AdMeldAPIClient.init=function(){this.log("init","info");var c=window.top.wgServer+window.top.wgArticlePath.replace("$1",window.top.wgPageName);for(var d in this.slots){this.log("ask for "+d+" bid","trace_l3");var b=this.slots[d];this.log(b,"trace_l3");var a="http://tag.admeld.com/ad/json?publisher_id="+525+"&site_id=wikia&placement="+b.placement.replace("%%HUB%%",this.siteHub)+"&size="+b.size+"&url="+c+"&callback=AdMeldAPIClient.callback&container="+d;this.log("calling "+a,"trace");this.track(["call",d]);$.ajax({url:a,dataType:"jsonp",timeout:2000});this.slots[d].url=a;this.slots[d].timer=(new Date).getTime();if($.inArray(b.size,this.sizes)==-1){this.sizes.push(b.size)}}};AdMeldAPIClient.callback=function(b){this.log(b,"trace_l3");try{var f=b.ad.container;this.slots[f].ad=b.ad;this.slots[f].pixels=b.pixels}catch(d){this.log("Error in callback, broken ad","error");this.track(["error","callback","ad"],"error");return false}try{var c=(new Date).getTime()-this.slots[f].timer;this.log("callback "+f+" after "+c+" ms","trace_l2");this.slots[f].timer=c;if(c>5000){c=5000}c=(c/1000).toFixed(1);this.track(["callback",f,c])}catch(d){this.log("Error in callback, broken timer","error");this.track(["error","callback","timer"],"error")}try{var a=this.slots[f].ad.bid;this.track(["bid",f,a.toFixed(3)]);this.slots[f].ad.bid=(a*0.875).toFixed(2)}catch(d){this.log("Error in callback, broken bid","error");this.track(["error","callback","bid"],"error");return false}return true};AdMeldAPIClient.adjustLiftiumChain=function(c){this.log(c,"trace_l3");try{if(this.sizes.indexOf(c[0].size)==-1){this.log("adjustLiftiumChain "+c[0].size+" skipped, no tags for this size","trace_l2");return c}this.log("adjustLiftiumChain "+c[0].size,"trace_l3")}catch(h){this.log("Error in adjustLiftiumChain","error");this.track(["error","adjust_liftium_chain"],"error")}for(var f=0;f<c.length;f++){var d=c[f];this.log(d,"trace_l3");if(d.network_id==172){this.log(d,"trace_l3");var g=d.criteria.placement[0];try{g=g.replace("HOME_","");this.log("slotname HOME_"+g+" replaced with "+g,"trace_l2")}catch(h){}var b=this.getBid(g);var a=this.getLiftiumTier(b);c[f].tier=a;c[f].value=b;this.log("AdMeld tag #"+d.tag_id+" adjusted to tier "+a+", value $"+b,"trace_l2");this.track(["liftium",d.tag_id,a,b])}}return c};AdMeldAPIClient.getLiftiumTier=function(a){this.log("getLiftiumTier "+a,"trace_l2");if(a>=2){return 3}if(a>=1){return 4}if(a>=0.8){return 5}if(a>=0.65){return 6}if(a>=0.5){return 7}if(a>=0.35){return 8}if(a>=0.2){return 9}return 10};AdMeldAPIClient.getParamForDART=function(b){this.log("getParamForDART "+b,"trace_l2");var a=this.roundBidForDART(this.getBid(b));this.track(["dart",b,a]);return"admeld="+a+";"};AdMeldAPIClient.roundBidForDART=function(a){this.log("roundBidForDART "+a,"trace_l2");if(a>5){a=5}a=Math.round(a*10)/10;a=a.toFixed(2);return a};if(window.top.wgEnableAdMeldAPIClient){window.top.AdMeldAPIClient.init()}var AdProviderOpenX={url:"",url2:""};AdProviderOpenX.getUrl=function(f,e,b,g,d,a){var c=f;c+="?loc="+escape(window.location);if(typeof document.referrer!="undefined"){c+="&referer="+escape(document.referrer)}if(typeof document.context!="undefined"){c+="&context="+escape(document.context)}if(typeof document.mmm_fo!="undefined"){c+="&mmm_fo=1"}c+="&target=_top";if(typeof AdsCB!="undefined"){c+="&cb="+AdsCB}else{c+="&cb="+Math.floor(Math.random()*99999999)}if(typeof document.MAX_used!="undefined"&&document.MAX_used!=","){c+="&exclude="+document.MAX_used}c+="&hub="+d;c+="&skin_name="+skin;c+="&cont_lang="+wgContentLanguage;c+="&user_lang="+wgUserLanguage;c+="&dbname="+wgDBname;c+="&tags="+wgWikiFactoryTagNames.join(",");c+=a;if(e!=""){c+="&slotname="+e}if(b!=""){c+="&zoneid="+b}if(g!=""){c+="&id="+g}c+="&block=1";AdProviderOpenX.url=c;return AdProviderOpenX.url};AdProviderOpenX.getUrl2=function(){var a="/__spotlights/spc.php";a+="?zones=14|15|16|17|18|19|20|21|22";a+="&source=";a+="&r="+Math.floor(Math.random()*99999999);a+="&loc="+escape(window.location);if(typeof document.referrer!=="undefined"){a+="&referer="+escape(document.referrer)}a+="&target=_top";a+="&cb="+Math.floor(Math.random()*99999999);a+="&hub="+window.cityShort;a+="&skin_name="+skin;a+="&cont_lang="+wgContentLanguage;a+="&user_lang="+wgUserLanguage;a+="&dbname="+wgDBname;a+="&tags="+escape(wgWikiFactoryTagNames.join(","));a+="&block=1";a+=(document.charset?"&charset="+document.charset:(document.characterSet?"&charset="+document.characterSet:""));AdProviderOpenX.url2=a;return AdProviderOpenX.url2};if(!window.wgNoExternals&&window.wgEnableOpenXSPC&&!window.wgIsEditPage){jQuery(function(a){a.getScript(AdProviderOpenX.getUrl2(),function(){var b=new window.Wikia.LazyLoadAds()})})}(function(c,e){var f=e(c),a="scroll.LazyLoadAds",b=c.Wikia||{};var d=function(g){g=e.extend({},d.settings,g);this.ads=e(g.selector).get();this.adsLength=this.ads.length;this.settings=g;if(g.onScroll){f.on(a,e.throttle(100,e.proxy(this.onScroll,this))).trigger(a)}};d.prototype.onScroll=function(){var k,l,m,g=f.height()+f.scrollTop()+this.settings.onScroll.threshold,j=c.OpenXSPC,h=0;if(j&&this.adsLength){for(;h<this.adsLength;h++){k=this.ads[h];if(e(k).offset().top<=g){m=k.nodeName=="IFRAME"?"fillIframe_"+k.id.replace("_iframe",""):"fillElem_"+k.id;if(e.isFunction(l=j[m])){l()}this.ads.splice(h,1);this.adsLength--}}}if(!j||!this.adsLength){f.off(a)}};d.settings={onScroll:{threshold:200},selector:".LazyLoadAd"};b.LazyLoadAds=d;c.Wikia=b})(window,jQuery);var AdProviderLiftium2Dom=function(a,h,c,g,d,f){var k="AdProviderLiftium2",l=200,j,e,b;j={EXIT_STITIAL_BOXAD_1:{size:"300x250"},HOME_TOP_LEADERBOARD:{size:"728x90"},HOME_TOP_RIGHT_BOXAD:{size:"300x250"},INCONTENT_BOXAD_1:{size:"300x250"},INVISIBLE_1:{size:"0x0",useGw:true},INVISIBLE_2:{size:"0x0",useGw:true},LEFT_SKYSCRAPER_2:{size:"160x600"},LEFT_SKYSCRAPER_3:{size:"160x600"},TEST_TOP_RIGHT_BOXAD:{size:"300x250"},TEST_HOME_TOP_RIGHT_BOXAD:{size:"300x250"},TOP_BUTTON_WIDE:{size:"292x90"},"TOP_BUTTON_WIDE.force":"hack",TOP_LEADERBOARD:{size:"728x90"},TOP_RIGHT_BOXAD:{size:"300x250"},PREFOOTER_LEFT_BOXAD:{size:"300x250"},PREFOOTER_RIGHT_BOXAD:{size:"300x250"},WIKIA_BAR_BOXAD_1:{size:"300x250"}};e=function(n){var m=n[0];a("canHandleSlot",5,k);a(n,5,k);if(j[m]){return true}return false};b=function(u){a(["fillInSlot",u],5,k);a(u,5,k);if(u[0]==="TOP_BUTTON"||u[0]==="TOP_BUTTON_WIDE"){a("Tried TOP_BUTTON(_WIDE). Disabled (waiting for leaderboard ads)",2,k);return}if(u[0]==="TOP_BUTTON.force"||u[0]==="TOP_BUTTON_WIDE.force"){a("Forced TOP_BUTTON(_WIDE) call (this means leaderboard is ready and standard)",2,k);u[0]=u[0].replace(".force","")}if(u[0].indexOf("LEADERBOARD")!==-1){a("LEADERBOARD-ish slot handled by Liftium. Running the forced TOP_BUTTON(_WIDE) now",2,k);f.adslots2.push(["TOP_BUTTON_WIDE.force",null,"Liftium2"])}if(!h.getElementById(u[0])){a("No such element in DOM: #"+u[0],2,k);return}var p=u[0],q=j[p].size,t=j[p].useGw,n=h.createElement("div"),r=h.createElement("iframe"),o=q&&q.split("x"),m;if(t){a("using ghostwriter for #"+p,6,k);m="Liftium.callAd("+JSON.stringify(q)+", "+JSON.stringify(p)+");";d.injectScriptByText(p,m)}else{a("using iframe for #"+p,6,k);l+=1;n.id="Liftium_"+q+"_"+l;r.width=o[0];r.height=o[1];r.scrolling="no";r.frameBorder=0;r.marginHeight=0;r.marginWidth=0;r.allowTransparency=true;r.id=p+"_iframe";r.style.display="block";n.appendChild(r);h.getElementById(p).appendChild(n);g.callInjectedIframeAd(q,h.getElementById(p+"_iframe"),p);c.removeDefaultHeight(p)}};return{name:"Liftium2Dom",canHandleSlot:e,fillInSlot:b}};var AdProviderSevenOneMedia=function(c,g,b,d,j){var l="AdProviderSevenOneMedia",k={TOP_RIGHT_BOXAD:"rectangle1",HOME_TOP_RIGHT_BOXAD:"rectangle1",TOP_LEADERBOARD:"topAds",HOME_TOP_LEADERBOARD:"topAds",HUB_TOP_LEADERBOARD:"topAds",SEVENONEMEDIA_FLUSH:"trackEnd"};function f(n){c(["canHandleSlot",n],"debug",l);var m=n[0];if(k[m]){c(["canHandleSlot",n,true],"debug",l);return true}c(["canHandleSlot",n,false],"debug",l);return false}function h(){d("#TOP_BUTTON_WIDE").remove();d("#WikiaTopAds").after(['<div id="ads-outer" class="noprint">','	<div id="ad-popup1" class="ad-wrapper"></div>','	<div id="TOP_BUTTON_WIDE"></div>','	<div id="ad-fullbanner2-outer">','		<div id="ad-fullbanner2" class="ad-wrapper" style="visibility: hidden"></div>',"	</div>",'	<div id="ad-skyscraper1-outer">','		<div id="ad-skyscraper1" class="ad-wrapper" style="display: none"></div>',"	</div>","</div>"].join(""))}function a(p){if(p.slotname==="fullbanner2"&&!p.isSpecialAd){c("fullbanner2 is not a special ad","debug",l);var o=d("#ad-fullbanner2"),m=o.height(),n=o.width();if(m>=90&&m<=95&&n===728){c("fullbanner2 has standard size, enabling TOP_BUTTON_WIDE","debug",l);g.adslots2.push(["TOP_BUTTON_WIDE.force"])}}}function e(r){c(["fillInSlot",r],"info",l);var n=r[0],q=k[n],o,m=b.trackSlot("sevenonemedia",n);function p(){d("#"+n).removeClass("default-height")}m.init();if(q==="topAds"){h();j.pushAd("popup1");j.pushAd("fullbanner2",{afterFinish:a});j.pushAd("skyscraper1",{afterFinish:m.success});j.flushAds()}if(q.match(/^(rectangle1|promo[123])$/)){o=d('<div class="ad-wrapper" style="display: none"></div>');o.attr("id","ad-"+q);d("#"+n).append(o);j.pushAd(q,{beforeFinish:p,afterFinish:m.success});j.flushAds()}if(q==="trackEnd"){j.trackEnd(n)}}return{name:"SevenOneMedia",fillInSlot:e,canHandleSlot:f}};var AdConfig2Late=function(e,f,a,k,b,h){var m="AdConfig2",j=f.wgContentLanguage,d=f.wgAdDriverUseSevenOneMedia?h:a,g={WIKIA_BAR_BOXAD_1:true,TOP_BUTTON_WIDE:true,"TOP_BUTTON_WIDE.force":true},l;function c(o){var n=o[0];e("getProvider",5,m);e(o,5,m);if(o[2]==="Liftium2"||o[2]==="Liftium2Dom"){if(k.canHandleSlot(o)){return k}e("#"+n+" disabled. Forced Liftium2, but it can't handle it",7,m);return b}if(j==="de"){if(n==="PREFOOTER_RIGHT_BOXAD"||n==="LEFT_SKYSCRAPER_3"){return b}if(d.canHandleSlot(o)){return d}}if(f.wgAdDriverUseSevenOneMedia){l=g[o[0]]}else{l=true}if(l&&k.canHandleSlot(o)){return k}return b}return{getProvider:c}};(function(g,e,j,p,f,m,d){var s,n,o,b,a,k,c,l={},u,t,q,r,h;l.callInjectedIframeAd=function(w,x,v){return j.Liftium.callInjectedIframeAd(w,x,v)};k=AdTracker(g,e);a=DartUrl();n=ScriptWriter(p,g,j);o=AdLogicPageLevelParams(g,j,m);b=AdLogicPageLevelParamsLegacy(g,j,o,m,a);c=SlotTweaker(g,p,j);q=AdProviderNull(g,c);h=SevenOneMediaHelper(o,n,g,j,d,e);r=AdProviderSevenOneMedia(g,j,k,d,h);u=AdProviderGamePro(b,n,k,g,j,c);t=AdProviderLiftium2Dom(g,p,c,l,n,j);s=AdConfig2Late(g,j,u,t,q,r);j.AdEngine_setLateAdsConfig(s)}(Wikia.log,Wikia.Tracker,window,document,Geo,Krux,jQuery));var LiftiumOptions=LiftiumOptions||{};if(!window.Liftium){var Liftium={baseUrl:LiftiumOptions.baseUrl||"http://liftium.wikia.com/",chain:[],currents:[],eventsTracked:0,geoUrl:LiftiumOptions.geoUrl||"http://liftium.wikia.com/",loadDelay:100,maxHops:LiftiumOptions.maxHops||5,slotHops:[],rejTags:[],slotPlacements:[],slotTimeouts:0,slotTimer2:[],hopRegister:[],maxLoadDelay:LiftiumOptions.maxLoadDelay||2500,isCalledAfterOnload:LiftiumOptions.isCalledAfterOnload||0,hasMoreCalls:LiftiumOptions.hasMoreCalls||0,slotnames:[],fingerprint:"a"};Liftium._=function(a){return document.getElementById(a)};Liftium.addEventListener=function(b,a,c){if(window.addEventListener){return b.addEventListener(a,c,false)}if(window.attachEvent){return b.attachEvent("on"+a,c)}return false};Liftium.beaconCall=function(c,a){if(window.Wikia&&window.Wikia.AbTest&&window.Wikia.AbTest.inGroup("LIFTIUM_DR","LIFTIUM_DISABLED")){Liftium.d("(Fake) AB experiment LIFTIUM_DR, group LIFTIUM_DISABLED",1);return}var b=new Image(0,0);if(a!==false){c+="&cb="+Math.random().toString().substring(2,8)}if(c.length>1000){Liftium.d("Truncating beacon call url to 1000 characters");c=c.substring(0,1000)}Liftium.d("Beacon call: "+c,7);b.src=c};Liftium.buildChain=function(o){Liftium.slotTimer=Liftium.slotTimer||[];var p=Liftium.getSizeForSlotname(o);var a=new Date();Liftium.slotTimer[o]=a.getTime();var m=[];Liftium.chain[o]=[];if(Liftium.slotPlacements[o]){Liftium.d("Slot placement for "+o+" already set to "+Liftium.slotPlacements[o],7)}else{if(window.LiftiumPlacement){Liftium.slotPlacements[o]=window.LiftiumPlacement;window.LiftiumPlacement=null}else{Liftium.slotPlacements[o]=LiftiumOptions.placement;LiftiumOptions.placement=null}}if(p=="1x1"){p="0x0"}if(Liftium.e(Liftium.config)||Liftium.e(Liftium.config.sizes)){Liftium.d("Error, config is empty in buildChain("+o+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/no_config",ga_action:"buildChain",ga_label:o,trackingMethod:"ad"});return false}if(Liftium.e(Liftium.config.sizes)||Liftium.e(Liftium.config.sizes[p])){Liftium.d("Error, unrecognized size "+p+" ("+o+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/unrecognized_size",ga_action:p,ga_label:o,trackingMethod:"ad"});return false}if(typeof window.top.wgEnableAdMeldAPIClient!="undefined"&&window.top.wgEnableAdMeldAPIClient){Liftium.d("Calling AdMeldAPIClient.adjustLiftiumChain for "+p,3);window.top.AdMeldAPIClient.adjustLiftiumChain(Liftium.config.sizes[p])}Liftium.setAdjustedValues(Liftium.config.sizes[p]);Liftium.config.sizes[p].sort(Liftium.chainSort);var h=Liftium.getRequestVal("liftium_tag");if(!Liftium.e(h)){for(var e=0,c=Liftium.config.sizes[p].length;e<c;e++){var b=Liftium.clone(Liftium.config.sizes[p][e]);if(b.tag_id==h){Liftium.d("Forcing tagid #"+h+" on the front of the chain.",1,b);Liftium.config.sizes[p][e].inChain=true;Liftium.chain[o].push(b);m.push(b.network_name+", #"+b.tag_id)}}}for(var g=0,d=Liftium.config.sizes[p].length;g<d;g++){var n=Liftium.clone(Liftium.config.sizes[p][g]);if(Liftium.isValidCriteria(n,o)){Liftium.config.sizes[p][g].inChain=true;Liftium.chain[o].push(n);m.push(n.network_name+", #"+n.tag_id);if(n.always_fill==1){Liftium.d("Chain complete - last ad is always_fill",2,m);break}else{if(Liftium.chain[o].length==Liftium.maxHops-1){break}}}else{Liftium.rejTags.push(n.tag_id)}}if(Liftium.chain[o].length===0){Liftium.d("Error building chain for "+o+". No matching tags?",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/no_matching_tags",ga_action:o,trackingMethod:"ad"});return false}if(Liftium.chain[o][Liftium.chain[o].length-1].always_fill!=1){var f=Liftium.getAlwaysFillAd(p,o);if(f!==false){Liftium.chain[o].push(f);m.push("AlwaysFill: "+f.network_name+", #"+f.tag_id)}}var k=Liftium.getSampledAd(p);if(k!==false&&Liftium.isValidCriteria(k,o)&&Liftium.chain[o][0].tier!="1"){Liftium.chain[o].reverse();Liftium.chain[o].push(k);Liftium.chain[o].reverse();m.push("Sampled: "+k.network_name+", #"+k.tag_id)}Liftium.d("Chain for "+o+" = ",3,m);return true};Liftium.buildQueryString=function(d,c){if(Liftium.e(d)){return""}if(typeof c=="undefined"){c="&"}var b="";for(var a in d){if(Liftium.e(d[a])){continue}b+=c+encodeURIComponent(a)+"="+encodeURIComponent(d[a])}return b.substring(c.length)};Liftium.callAd=function(e,d){if(window.Wikia&&window.Wikia.AbTest&&window.Wikia.AbTest.inGroup("LIFTIUM_DR","LIFTIUM_DISABLED")){Liftium.d("(Fake) AB experiment LIFTIUM_DR, group LIFTIUM_DISABLED",1);return}if(LiftiumOptions.offline){Liftium.d("Not printing tag because LiftiumOptions.offline is set");return false}if(Liftium.e(Liftium.config)){Liftium.d("Error downloading config ("+e+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/error_downloading_config",ga_action:e,trackingMethod:"ad"});var a=Liftium.fillerAd(e,"Error downloading config");document.write(a.tag);return false}else{if(Liftium.config.error){Liftium.d("Config error "+Liftium.config.error+" ("+e+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/config_error",ga_action:e,ga_label:(Liftium.config.error||"unknown"),trackingMethod:"ad"});var c=Liftium.fillerAd(e,Liftium.config.error);document.write(c.tag);return false}}var b=Liftium.getUniqueSlotname(e);if(d){Liftium.d("Setting placement of slot "+b+" to "+d,3);Liftium.slotPlacements[b]=d}Wikia.Tracker.track({eventName:"liftium.slot",ga_category:"slot/"+e,ga_action:d,ga_label:"liftium js",trackingMethod:"ad"});document.write('<div id="'+b+'">');Liftium._callAd(b);document.write("</div>");return true};Liftium._callAd=function(c,b){Liftium.d("Calling ad for "+c,1);var a=Liftium.getNextTag(c);if(a===false){a=Liftium.fillerAd(c,"getNextTag returned false");if(b){Liftium.clearPreviousIframes(c)}else{document.write("<!-- Liftium Tag #"+a.tag_id+"-->\n");document.write(a.tag)}return false}Liftium.handleNetworkOptions(a);Liftium.d("Ad #"+a.tag_id+" for "+a.network_name+" called in "+c);Liftium.d("Config = ",6,a);try{if(!Liftium.e(b)){Liftium.clearPreviousIframes(c);Liftium.callIframeAd(c,a)}else{Liftium.d("Tag :"+a.tag,5);Liftium.lastTag=a;Liftium.lastSlot=c;document.write(a.tag);Liftium.lastTag=null}}catch(d){Liftium.d("Error loading tag #"+a.tag_id+" ("+c+")",1,d);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/_callAd",ga_action:c,ga_label:"tag "+a.tag_id,trackingMethod:"ad"})}return true};Liftium.callIframeAd=function(e,b,g){Liftium.d("Calling Iframe Ad for "+e,1);var c=Liftium.getIframeUrl(e,b);if(Liftium.e(c)||c=="about:blank"){Liftium.d("Skipping No iframe ad called for No Ad for "+e,3);return}Liftium.slotTimer2[e+"-"+b.tag_id]=Liftium.debugTime();Liftium.d("slotTimer2 begin for #"+b.tag_id+" in "+e,3,Liftium.slotTimer2);if(typeof g=="object"){g.src=c}else{g=document.createElement("iframe");var d=b.size.split("x");g.src=c;g.width=d[0];g.height=d[1];g.scrolling="no";g.frameBorder=0;g.marginHeight=0;g.marginWidth=0;g.allowTransparency=true;g.id=e+"_"+b.tag_id;g.style.display="block";var a=b.tag_name&&b.tag_name.match(/ [0-9]+x[0-9]+ /);if(a){a=a[0].match(/[0-9]+x[0-9]+/);a=a[0].split("x");if(a[0]==g.width&&a[1]==g.height){}else{Liftium.d("Forced size "+a[0]+"x"+a[1]+" for "+e,3);g.className+=" jumbo";g.width=a[0];g.height=a[1];var f=c.match(/;sz=[0-9x,]+;/);if(f){c=c.replace(/;sz=[0-9x,]+;/,";sz="+a[0]+"x"+a[1]+";");Liftium.d("Forced size "+a[0]+"x"+a[1]+" in Dart URL: "+c,3);g.src=c}}}Liftium._(e).appendChild(g)}};Liftium.callInjectedIframeAd=function(f,d,e){Liftium.d("Calling injected Iframe Ad for "+f,1);if(window.Wikia&&window.Wikia.AbTest&&window.Wikia.AbTest.inGroup("LIFTIUM_DR","LIFTIUM_DISABLED")){Liftium.d("(Fake) AB experiment LIFTIUM_DR, group LIFTIUM_DISABLED",1);return}var j=Liftium.getContainingDivId(d);Liftium.d("It's "+d.id+" inside "+j+" div",3);if(e){Liftium.d("Setting placement of slot "+j+" to "+e,3);Liftium.slotPlacements[j]=e}var a=d.id.replace(/_iframe$/,"");Wikia.Tracker.track({eventName:"liftium.slot",ga_category:"slot/"+f,ga_action:a,ga_label:"liftium",trackingMethod:"ad"});var h=Liftium.getNextTag(j);if(!h){Liftium.d("no tag found for "+f+". Collapsing frame.",1);d.width=0;d.height=0;return}var g=Liftium.getIframeUrl(j,h);d.src=g;Liftium.slotTimer2[j+"-"+h.tag_id]=Liftium.debugTime();Liftium.d("slotTimer2 begin for #"+h.tag_id+" in "+j,3,Liftium.slotTimer2);if(g=="about:blank"){Liftium.d("Forced size 0x0 for "+j,3);d.width=0;d.height=0;return}var b=h.tag_name&&h.tag_name.match(/ [0-9]+x[0-9]+ /);if(b){b=b[0].match(/[0-9]+x[0-9]+/);b=b[0].split("x");if(b[0]==d.width&&b[1]==d.height){return}Liftium.d("Forced size "+b[0]+"x"+b[1]+" for "+j,3);d.className+=" jumbo";d.width=b[0];d.height=b[1];var c=g.match(/;sz=[0-9x,]+;/);if(c){g=g.replace(/;sz=[0-9x,]+;/,";sz="+b[0]+"x"+b[1]+";");Liftium.d("Forced size "+b[0]+"x"+b[1]+" in Dart URL: "+g,3);d.src=g}return}};Liftium.catchError=function(f,c,a){try{var b;if(typeof f=="object"){b="Error object: "+Liftium.print_r(f)}else{b="Error on line #"+a+" of "+c+" : "+f}Liftium.d("ERROR! "+b);if(Liftium.e(Liftium.lastTag)){Liftium.reportError(b,"onerror")}else{Liftium.reportError("Tag error for tag "+Liftium.print_r(Liftium.lastTag)+"\n"+b,"tag")}if(!Liftium.e(window.failTestOnError)){window.LiftiumTest.testFailed();alert(f)}}catch(d){}return false};Liftium.chainSort=function(e,c){var h=parseInt(e.tier,10)||0;var f=parseInt(c.tier,10)||0;if(h<f){return -1}else{if(h>f){return 1}else{var d=parseFloat(e.adjusted_value)||0;var g=parseFloat(c.adjusted_value)||0;var k=d+(d*Math.random()*0.75);var j=g+(g*Math.random()*0.75);return j-k}}};Liftium.clearPreviousIframes=function(d){var b=Liftium._(d);if(b===null){return false}var e=b.getElementsByTagName("iframe");for(var c=0,a=e.length;c<a;c++){e[c].style.display="none"}return true};Liftium.clone=function(c){if(typeof c=="object"){if(c==null){Liftium.d("Liftium.clone: obj == null",7);return""}var b=new c.constructor();for(var a in c){b[a]=Liftium.clone(c[a])}return b}else{return c}};Liftium.crossDomainMessage=function(a){XDM.allowedMethods=["Liftium.iframeHop","LiftiumTest.testPassed"];XDM.executeMessage(a.data)};Liftium.cookie=function(b,m,p){if(arguments.length>1){p=p||{};if(Liftium.e(m)){m="";p.expires=-1}var f="";if(p.expires&&(typeof p.expires=="number"||p.expires.toUTCString)){var k;if(typeof p.expires=="number"){k=new Date();Liftium.d("Setting cookie expire "+p.expires+" milliseconds from "+k.toUTCString(),7);k.setTime(k.getTime()+(p.expires))}else{k=p.expires}f="; expires="+k.toUTCString()}var o=p.path?"; path="+(p.path):"";var h=p.domain?"; domain="+(p.domain):"";var a=p.secure?"; secure":"";Liftium.d("Set-Cookie: "+[b,"=",encodeURIComponent(m),f,o,h,a].join(""),6);document.cookie=[b,"=",encodeURIComponent(m),f,o,h,a].join("");return true}else{var e=null;if(!Liftium.e(document.cookie)){var n=document.cookie.split(";");for(var j=0,g=n.length;j<g;j++){var c=n[j].replace(/^\s+|\s+$/g,"");if(c.substring(0,b.length+1)==(b+"=")){e=decodeURIComponent(c.substring(b.length+1));break}}}return e}};Liftium.debug=function(b,c,a){if(Liftium.e(Liftium.debugLevel)){return false}else{if(c>Liftium.debugLevel){return false}}if(typeof console=="object"&&console.dir){console.log(Liftium.debugTime()+" Liftium: "+b);if(arguments.length>2){console.dir(a)}}else{if(typeof console=="object"&&console.log){console.log(Liftium.debugTime()+" Liftium: "+b);if(arguments.length>2){console.log(Liftium.print_r(a))}}}return true};Liftium.d=Liftium.debug;Liftium.debugTime=function(){return new Date().getTime()-Liftium.startTime};Liftium.formatTrackTime=function(b,a){if(isNaN(b)){Liftium.d("Error, time tracked is NaN: "+b,7);return"NaN"}if(b<0){Liftium.d("Error, time tracked is a negative number: "+b,7);return"negative"}b=b/1000;if(b>a){return"more_than_"+a}return b.toFixed(1)};Liftium.dec2hex=function(b){var a=parseInt(b,10).toString(16);if(a.toString()=="0"){return"00"}else{return a.toUpperCase()}};Liftium.empty=function(a){if(typeof a==="object"){for(var b in a){return false}return true}else{return a===undefined||a===""||a===0||a===null||a===false||(typeof a==="number"&&isNaN(a))||false}};Liftium.e=Liftium.empty;Liftium.fillerAd=function(d,f){var b,a="",c=-1;try{b=d.split("_")[1]}catch(g){b="300x250"}if(!Liftium.e(f)){a+='<div class="LiftiumError" style="display:none">Liftium message: '+f+"</div>"}if(b.match(/300x250/)){c=2198}else{if(b.match(/728x90/)){c=2197}else{if(b.match(/160x600/)){c=2199}else{a+='<span style="display: none">No available ads</span>'}}}return{tag_id:c,network_name:"Internal Error",tag:a,size:b}};Liftium.getAdColor=function(b){try{switch(b){case"link":var a=document.getElementsByTagName("a");if(Liftium.e(a)){return null}else{return Liftium.normalizeColor(Liftium.getStyle(a[0],"color"))}case"bg":return Liftium.normalizeColor(Liftium.getStyle(document.body,"background-color"));case"text":return Liftium.normalizeColor(Liftium.getStyle(document.body,"color"));default:return null}}catch(c){Liftium.d("Error in Liftium.getAdColor: "+c.message);return null}};Liftium.getContainingDivId=function(b){var a=b,c=0;while(a&&c<10){if(a.tagName=="DIV"&&a.id){return a.id}else{a=a.parentNode}c++}return false};Liftium.getCookieDomain=function(){var a=document.domain;var b=a.match(/(?:wikia(?:-dev)?\.com|wowwiki\.com|wiki\.ffxiclopedia\.org|memory-alpha\.org|websitewiki\.de|yoyowiki\.org|marveldatabase\.com|www\.jedipedia\.de)$/);if(!Liftium.e(b)){a=b[0]}else{Wikia.Tracker.track({eventName:"liftium.varia",ga_category:"varia/cookie_domain",ga_action:a,trackingMethod:"ad"})}Liftium.d("cookie domain is "+a,7);return a};Liftium.getPageVar=function(a,b){return LiftiumOptions["kv_"+a]||b||""};Liftium.getStyle=function(a,c){var b=c.replace(/\-(\w)/g,function(d,e){return e.toUpperCase()});if(a.currentStyle){return a.currentStyle[b]||""}else{if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(a,"")[b]||""}else{return a.style[b]||""}}};Liftium.getAlwaysFillAd=function(d,e){if(Liftium.e(Liftium.config)||Liftium.e(Liftium.config.sizes)){Liftium.d("Error, config is empty in getAlwaysFillAd("+d+", "+e+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/no_config",ga_action:"getAlwaysFillAd",ga_label:d+"/"+e,trackingMethod:"ad"});return false}for(var c=0,a=Liftium.config.sizes[d].length;c<a;c++){var b=Liftium.config.sizes[d][c];if(b.always_fill==1&&Liftium.isValidCriteria(b,e)){return Liftium.clone(b)}}return false};Liftium.getCountry=function(){if(!Liftium.e(Liftium.getCountryFound)){return Liftium.getCountryFound}var a,b=Liftium.geo||window.Geo;if(!Liftium.e(Liftium.getRequestVal("liftium_country"))){a=Liftium.getRequestVal("liftium_country");Liftium.d("Using liftium_country for geo targeting ("+a+")",8)}else{if(Liftium.e(b)||Liftium.e(b.country)){Liftium.d("Unable to find a country for this IP, defaulting to unknown");return"unknown"}else{a=b.country.toLowerCase()}}if(a==="gb"){a="uk"}Liftium.getCountryFound=a;return a};Liftium.getBrowserLang=function(){var b=window.navigator;var a=b.language||b.systemLanguage||b.browserLanguage||b.userLanguage||"";return a.substring(0,2)};Liftium.getIframeUrl=function(d,b){var a=b.tag?b.tag.match(/<iframe[\s\S]+src="([^"]+)"/):null;var c;if(a!==null){c=a[1].replace(/&amp;/g,"&");Liftium.d("Found iframe in tag, using "+c+" for "+d,3)}else{if(b.network_name=="No Ad"){Liftium.d("Using about:blank for 'No Ad' to avoid iframe in "+d,3);c="about:blank"}else{if(b.network_name=="DART"){c=window.LiftiumDART.getUrl(Liftium.slotPlacements[d],b.size,b.network_options,true)}else{var e={tag_id:b.tag_id,size:b.size,slotname:d,placement:Liftium.slotPlacements[d]};c=Liftium.baseUrl+"tag/?"+Liftium.buildQueryString(e);Liftium.d("No iframe found in tag, using "+c+" for "+d,4)}}}return c};Liftium.getMinutesSinceMidnight=function(){var a=new Date();return(a.getHours()*60)+a.getMinutes()};Liftium.getMinutesSinceReject=function(b){var a=Liftium.getTagStat(b,"m");if(a===null){return null}else{return Liftium.getMinutesSinceMidnight()-a}};Liftium.getNextTag=function(j){if(Liftium.e(Liftium.chain[j])){if(Liftium.buildChain(j)===false){Liftium.reportError("Error building chain "+j,"chain");return false}}Liftium.slotHops[j]=Liftium.slotHops[j]||0;Liftium.slotHops[j]++;if(Liftium.slotHops[j]>10){Liftium.reportError("Maximum number of hops exceeded: 10","chain");return false}var a=new Date();var b=Liftium.chain[j].length;var g=Liftium.currents[j]||0;var h=a.getTime()-Liftium.slotTimer[j];if(h>Liftium.maxHopTime){Liftium.d("Liftium.maxHopTime="+Liftium.maxHopTime,5);Liftium.d("Hop Time of "+Liftium.maxHopTime+" exceeded, it's "+h+" now. Using the always_fill for "+j,2);var f=h/1000;Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/hop_timeout",ga_action:"slot "+j+", net "+Liftium.chain[j][g].network_id+", tag "+Liftium.chain[j][g].tag_id,ga_label:f.toFixed(1),trackingMethod:"ad"});Liftium.slotTimeouts++;var e=b-1;Liftium.currents[j]=e;Liftium.chain[j][e].started=a.getTime();return Liftium.chain[j][e]}else{for(var d=g,c=b;d<c;d++){if(!Liftium.e(Liftium.chain[j][d].started)){continue}else{Liftium.chain[j][d].started=a.getTime();Liftium.currents[j]=d;return Liftium.chain[j][d]}}}Liftium.reportError("No more tags left in the chain - "+j+" Last ad in the chain marked as always fill but actually hopped? :"+Liftium.print_r(Liftium.chain[j][Liftium.chain[j].length-1]),"chain");Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/last_hopped",ga_action:j,trackingMethod:"ad"});return Liftium.fillerAd(j,"No more tags left in the chain")};Liftium.getPagesSinceSearch=function(){var a=Liftium.getReferringKeywords();if(Liftium.e(a)){return null}var b=Liftium.cookie("Lps");if(Liftium.e(b)){b=1}else{b++}Liftium.cookie("Lps",b);return null};Liftium.getPropertyCount=function(d){try{if(typeof d!="object"){return 0}var f=0;for(var a in d){if(d.hasOwnProperty(a)){f++}}return f}catch(b){return 0}};Liftium.getReferrer=function(){return LiftiumOptions.referrer||document.referrer};Liftium.getReferringKeywords=function(){var b=Liftium.getReferrer(),c;var e=b.match(/\?(.*)$/);if(Liftium.e(e)){e=[]}else{e=e[1]}var a=["q","p","query"];for(var d=0;d<a.length;d++){c=Liftium.getRequestVal(a[d],"",e);if(!Liftium.e(c)){break}}var f=Liftium.cookie("Lrk");if(!Liftium.e(c)){Liftium.cookie("Lrk",c);return c}else{if(!Liftium.e(f)){return f}else{return null}}};Liftium.getRequestVal=function(d,c,a){var b=Liftium.parseQueryString(a||document.location.search);if(typeof b[d]!="undefined"){return b[d]}else{if(typeof c!="undefined"){return c}else{return""}}};Liftium.getSampledAd=function(n){if(Liftium.e(Liftium.config)||Liftium.e(Liftium.config.sizes)){Liftium.d("Error, config is empty in getSampledAd("+n+")",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/no_config",ga_action:"getSampledAd",ga_label:n,trackingMethod:"ad"});return false}var h=[],k=0,d=Math.random()*100;for(var e=0,b=Liftium.config.sizes[n].length;e<b;e++){var m=parseFloat(Liftium.config.sizes[n][e].sample_rate);if(Liftium.e(m)){continue}k+=m;Liftium.d("Sample Rate for "+Liftium.config.sizes[n][e].tag_id+" is "+m,7);h.push({upper_bound:k,index:e})}Liftium.d("Sample Array = ",7,h);for(var c=0,a=h.length;c<a;c++){if(d<h[c].upper_bound){var g=h[c].index;return Liftium.clone(Liftium.config.sizes[n][g])}}return false};Liftium.getSlotnameFromElement=function(b){if(typeof b!="object"){return false}var a=b,c=0;while(a&&c<10){if(a.id&&a.id.match(/^Liftium_/)){return a.id}else{a=a.parentNode}c++}return false};Liftium.getStatRegExp=function(a){return new RegExp(Liftium.now.getDay()+"_"+a+"l([0-9]+)r*([0-9]*)m*([0-9]*)")};Liftium.getSizeForSlotname=function(b){var a=b.match(/[0-9]{1,3}x[0-9]{1,3}/);if(a!==null){return a[0]}for(var c in Liftium.config.slotnames){if(typeof Liftium.config.slotnames[c]=="function"){continue}if(c==b){return Liftium.config.slotnames[c]}}return false};Liftium.getTagStat=function(g,e){var d=null;if(Liftium.e(Liftium.tagStats)){Liftium.tagStats=Liftium.getRequestVal("liftium_tag_stats",null)||Liftium.cookie("LTS")||""}var c=Liftium.tagStats.match(Liftium.getStatRegExp(g));if(!Liftium.e(c)){var a=c.length;if(e==="l"&&a>=2){d=c[1]}else{if(e==="r"&&a>=3){d=c[2]}else{if(e==="m"&&a>=4){d=c[3]}else{if(e==="a"){var b=parseInt(c[1],0)||0;var f=parseInt(c[2],0)||0;d=b+f}}}}}if(Liftium.e(d)){if(e=="m"){d=null}else{d=0}}else{d=parseInt(d,10)}Liftium.d("Stats for "+g+" type "+e+" = "+d,9);return d};Liftium.getUniqueSlotname=function(b){Liftium.slotnames=Liftium.slotnames||[];var a="Liftium_"+b+"_"+Liftium.slotnames.length;Liftium.slotnames.push(a);return a};Liftium.handleNetworkOptions=function(a){switch(a.network_id){case"1":for(var b in LiftiumOptions){if(b.match(/^google_/)){Liftium.d(b+" set to "+LiftiumOptions[b],5);window[b]=LiftiumOptions[b]}}return true;default:return true}};Liftium.hop=function(a){if(Liftium.e(a)){a=Liftium.lastSlot}Liftium.d("Liftium.hop() called for "+a);Liftium.markLastAdAsRejected(a);return Liftium._callAd(a)};var LiftiumHop=Liftium.hop;Liftium.iframeHop=function(g){Liftium.d("Liftium.iframeHop() called from "+g,3);if(Liftium.in_array(g,Liftium.hopRegister)){Liftium.d("Hop from "+g+" already registered. Bailing out.",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/last_hopped_2",ga_action:"last_hopped_2",trackingMethod:"ad"});Liftium.reportError("Hop from "+g+" already registered.");return}Liftium.hopRegister.push(g);var j;var e=document.getElementsByTagName("iframe"),h=false,b=[];Liftium.d("iframes:",5,e);for(var d=0,f=e.length;d<f;d++){var a=Math.random();if(!e[d].id){e[d].id=a}else{a=e[d].id}var c=Liftium._(a);if(Liftium.e(c.src)){Liftium.d("myframe.src for #"+d+" ("+a+") is empty, skipping",7);continue}if(g.indexOf(c.src)>=0){h=true;Liftium.d("found iframe match, #"+d+" ("+a+")",5);j=Liftium.getContainingDivId(c);Liftium.debug("Slotname from containing div is "+j,3);if(Liftium.e(j)){Liftium.reportError("Unable to determine slotname from iframe "+g);return}break}b.push(c.src)}if(!h){Liftium.reportError("Unable to find iframe for "+g+"in : "+b.join(", "));return}Liftium.d("slotname is "+j+" in iframeHop",3);Liftium.markLastAdAsRejected(j);Liftium._callAd(j,true)};Liftium.iframeContents=function(b,a){if(typeof b!="object"){return false}if(!b.doc){if(b.contentDocument){b.doc=b.contentDocument}else{if(b.contentWindow){b.doc=b.contentWindow.document}else{if(b.document){b.doc=b.document}}}b.doc.open();b.doc.close()}if(typeof a!="undefined"){b.doc.body.style.backgroundColor="blue";var c=b.doc.createElement("div");c.id="div42";c.innerHTML=a;b.doc.body.appendChild(c);return true}else{return b.doc.getElementById("div42").innerHTML}};Liftium.in_array=function(d,c,a){for(var b in c){if(c[b]==d){return true}else{if(a&&c[b].toString().toLowerCase()==d.toString().toLowerCase()){return true}}}return false};Liftium.init=function(b){if(window.Wikia&&window.Wikia.AbTest&&window.Wikia.AbTest.inGroup("LIFTIUM_DR","LIFTIUM_DISABLED")){Liftium.d("(Fake) AB experiment LIFTIUM_DR, group LIFTIUM_DISABLED",1);return}if(Liftium.e(LiftiumOptions.pubid)){return false}Wikia.Tracker.track({eventName:"liftium.init",ga_category:"init/init",ga_action:"init",ga_label:"liftium",trackingMethod:"ad"});var a=function(){if(typeof b==="function"){b()}if(window.AdEngine_loadLateAds){Liftium.d("AdEngine_run_later",1);window.AdEngine_loadLateAds()}};Liftium.pullGeo();Liftium.pullConfig(a);if(LiftiumOptions.enableXDM!==false){XDM.listenForMessages(Liftium.crossDomainMessage)}if(BrowserDetect.browser=="Opera"){Liftium.iframeOnload=function(f){var c=f.target||f;try{if(typeof c.readyState=="undefined"){c.readyState="complete"}}catch(d){}};Liftium.addEventListener(window,"DOMFrameContentLoaded",Liftium.iframeOnload)}if(Liftium.getRequestVal("liftium_exclude_tag")){LiftiumOptions.exclude_tags=[Liftium.getRequestVal("liftium_exclude_tag")]}Liftium.trackQcseg();return true};Liftium.iframesLoaded=function(){if(Liftium.isCalledAfterOnload&&Liftium.hasMoreCalls){return false}var e=document.getElementsByTagName("iframe");var c=e.length;if(c===0){return true}var a=BrowserDetect.browser;if(Liftium.in_array(a,["Firefox","Gecko","Mozilla"])&&!Liftium.isCalledAfterOnload&&Liftium.pageLoaded){return true}else{if(Liftium.in_array(a,["Explorer","Opera"])&&document.readyState=="complete"){for(var d=0;d<c;d++){if(e[d].document.readyState!="complete"){return false}}if(Liftium.loadDelay<200){return false}else{return true}}else{if(Liftium.loadDelay<1000*Liftium.slotnames.length){return false}else{return true}}}};Liftium.isValidBrowser=function(a){var c=BrowserDetect.OS+" "+BrowserDetect.browser+" "+BrowserDetect.version;var b=new RegExp(a,"i");if(c.match(b)){return true}else{return false}};Liftium.isNetworkInChain=function(d,b){var c=false;for(var a=0;a<Liftium.chain[b].length;a++){if(Liftium.chain[b][a].network_name==d){c=true;break}}return c};Liftium.isHighValueCountry=AdLogicHighValueCountry(window).isHighValueCountry;Liftium.isValidCountry=function(a){var b=Liftium.getCountry();Liftium.d("Checking if '"+b+"' is in:",8,a);if(Liftium.in_array("row",a,true)&&!Liftium.isHighValueCountry(b)){Liftium.d("ROW targetted, and country not high-value",8);return true}if(Liftium.in_array(b,a,true)){return true}return false};Liftium.isValidCriteria=function(d,e){var f="Ad #"+d.tag_id+" from "+d.network_name+" invalid for "+e+": ";if(!Liftium.e(d.inChain)&&!Liftium.e(d.freq_cap)){Liftium.d(f+"it has a freq cap and is already in another chain",3);return false}if(!Liftium.e(LiftiumOptions.exclude_tags)&&Liftium.in_array(d.tag_id,LiftiumOptions.exclude_tags)){Liftium.d(f+"in LiftiumOptions excluded tags list",2);return false}if(!Liftium.e(d.freq_cap)){var b=Liftium.getTagStat(d.tag_id,"a");if(b>=parseInt(d.freq_cap,10)){Liftium.d(f+b+"attempts is >= freq_cap of "+d.freq_cap,5);return false}}if(!Liftium.e(d.rej_time)){var g=Liftium.getMinutesSinceReject(d.tag_id);if(g!==null){Liftium.d(" rej_time = "+d.rej_time+" elapsed = "+g,8);if(g<parseInt(d.rej_time,10)){Liftium.d(f+"tag was rejected sooner than rej_time of "+d.rej_time,5);return false}}}if(!Liftium.e(d.criteria)){for(var c in d.criteria){switch(c){case"country":if(!Liftium.isValidCountry(d.criteria.country)){Liftium.d(f+"Invalid country",6);return false}break;case"browser":if(!Liftium.isValidBrowser(d.criteria.browser[0])){Liftium.d(f+"Invalid browser",6);return false}break;case"domain":LiftiumOptions.domain=LiftiumOptions.domain||document.domain;if(d.criteria.domain[0]!=LiftiumOptions.domain){Liftium.d(f+"Invalid domain",6);return false}break;case"placement":if(!Liftium.in_array(Liftium.slotPlacements[e],d.criteria.placement)){Liftium.d(f+"Invalid placement ("+Liftium.slotPlacements[e]+")",6,d.criteria.placement);return false}break;default:if(c.match(/^kv_/)){if(!Liftium.in_array(LiftiumOptions[c],d.criteria[c])){Liftium.d(f+"key value "+c+" does not match: "+d.criteria[c],6);return false}}break}}}if(!XDM.canPostMessage()&&Liftium.e(Liftium.config.xdm_iframe_path)&&d.tag.toString().match(/iframe/i)&&d.always_fill!=1){Liftium.reportError("Iframe called on HTML 4 browser for publisher without a xdm_iframe_path. tagid #"+d.tag_id,"tag");return false}if(!Liftium.e(d.pacing)&&!Liftium.isValidPacing(d)){Liftium.d(f+" - pacing criteria not met ("+d.pacing+")",5);return false}Liftium.d("Targeting criteria passed for tag #"+d.tag_id,6);return true};Liftium.isValidPacing=function(a){return(Math.random()*100)<a.pacing};Liftium.loadScript=function(b,a,e){Liftium.d("Loading script from "+b+" (not blocking: "+(!Liftium.e(a)?"true":"false")+", with callback: "+(!Liftium.e(e)?"true":"false")+")",5);if(typeof a=="undefined"){Liftium.d("Using document.write",5);document.write('<script type="text/javascript" src="'+b+'"><\/script>');return true}else{if(typeof jQuery=="undefined"||!e){Liftium.d("Using document.createElement(script)",5);var d=document.getElementsByTagName("head").item(0);var c=document.createElement("script");c.src=b;d.appendChild(c);return c}else{Liftium.d("Using $.getScript",5);$.getScript(b,e);return true}}};Liftium.markChain=function(c){Liftium.d("Marking chain for "+c,5);if(Liftium.e(Liftium.chain[c])){Liftium.debug("Skipping marking chain for "+c+", chain was empty");return false}for(var b=0,a=Liftium.chain[c].length;b<a;b++){if(b<Liftium.currents[c]&&Liftium.chain[c][b].started){Liftium.chain[c][b].rejected=true}else{if(b==Liftium.currents[c]){Liftium.chain[c][b].loaded=true;break}}}return b};Liftium.markLastAdAsRejected=function(c){var b=Liftium.currents[c];if(typeof b=="undefined"){Liftium.d("No chain for "+c+" found. Bailing out.",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/no_chain",ga_action:c,trackingMethod:"ad"});return}var e=Liftium.chain[c][b].tag_id;Liftium.d("Marking last ad as rejected for "+c+" (#"+e+")",3);Liftium.chain[c][b].rejected=true;Liftium.setTagStat(e,"r");var d=Liftium.debugTime()-Liftium.slotTimer2[c+"-"+e];Liftium.d("slotTimer2 end for #"+e+" in "+c+" after "+d+" ms",3);var a=Liftium.chain[c][b].network_id;Wikia.Tracker.track({eventName:"liftium.hop",ga_category:"hop/net "+a,ga_action:"tag "+e,ga_label:Liftium.formatTrackTime(d,5),trackingMethod:"ad"})};Liftium.normalizeColor=function(a){a=a||"";if(a=="transparent"){return""}else{if(a.match(/^#[A-F0-9a-f]{6}/)){return a.toUpperCase().replace(/^#/,"")}else{if(a.match(/^#[A-F0-9a-f]{3}$/)){var g=a.substring(1,1);var e=a.substring(2,1);var d=a.substring(3,1);var c=g+g+e+e+d+d;return c.toUpperCase()}else{if(a.match(/^rgb/)){var h=a.replace(/[^0-9,]/g,"");var b=h.split(",");return Liftium.dec2hex(b[0])+Liftium.dec2hex(b[1])+Liftium.dec2hex(b[2])}else{return a.replace(/"/g,"")}}}}};Liftium.onLoadHandler=function(){if(window.Wikia&&window.Wikia.AbTest&&window.Wikia.AbTest.inGroup("LIFTIUM_DR","LIFTIUM_DISABLED")){Liftium.d("(Fake) AB experiment LIFTIUM_DR, group LIFTIUM_DISABLED",1);return}Liftium.pageLoaded=true;if(!Liftium.e(Liftium.config)&&Liftium.iframesLoaded()){Liftium.sendBeacon()}else{if(Liftium.loadDelay<Liftium.maxLoadDelay){Liftium.loadDelay+=Liftium.loadDelay;window.setTimeout(Liftium.onLoadHandler,Liftium.loadDelay)}else{var a=Liftium.e(Liftium.config)?"no config":"config loaded";Liftium.d("Gave up waiting for ads to load ("+a+"), sending beacon now",1);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/gave_up_waiting_for_ads",ga_action:a,trackingMethod:"ad"});Liftium.sendBeacon()}}};Liftium.parseQueryString=function(a){var c=[];if(typeof a!="string"||a===""){return c}if(a.charAt(0)==="?"){a=a.substr(1)}a=a.replace(/\;/g,"&",a);a=a.replace(/\+/g,"%20",a);var f=a.split("&");for(var d=0,b;d<f.length;d++){if(f[d].length===0){continue}var j="",h="";if((b=f[d].indexOf("="))!=-1){try{j=decodeURIComponent(f[d].substr(0,b));h=decodeURIComponent(f[d].substr(b+1))}catch(g){j=unescape(f[d].substr(0,b));h=unescape(f[d].substr(b+1))}}else{j=f[d];h=true}c[j]=h}return c};Liftium.pullConfig=function(c){if(Liftium.config){return}var b={pubid:LiftiumOptions.pubid,v:1.2,country:Liftium.getCountry()};if(!Liftium.e(LiftiumOptions.config_delay)){b.config_delay=LiftiumOptions.config_delay;b.cb=Math.random()}if(window.location.hostname.indexOf(".dev.liftium.com")>-1){Liftium.baseUrl="/"}var a=Liftium.baseUrl+"config?"+Liftium.buildQueryString(b);Liftium.d("Loading config from "+a,2);if(c){Liftium.loadScript(a,true,c)}else{Liftium.loadScript(a)}};Liftium.pullGeo=function(){if(Liftium.geo){return}Liftium.d("Loading geo data from cookie",3);var a=decodeURIComponent(Liftium.cookie("Geo"));if(!Liftium.e(a)){try{Liftium.geo=JSON.parse(a)||{}}catch(b){Liftium.geo={}}Liftium.d("Geo data loaded:",7,Liftium.geo);return}Liftium.d("Loading geo data from "+Liftium.geoUrl,3);Liftium.loadScript(Liftium.geoUrl)};Liftium.print_r=function(d,f){if(d===null){return"*null*"}f=f||0;if(f>6){return false}var e="";for(var b=1;b<f+1;b++){e+="	"}switch(typeof d){case"string":return d===""?"*empty string*":d;case"undefined":return"*undefined*";case"boolean":return d===true?"*boolean true*":"*boolean false*";case"function":return"*function*";case"object":var a=[];for(var c in d){if(typeof d[c]=="object"){a.push(e+"'"+c+"' ...\n");a.push(Liftium.print_r(d[c],f+1))}else{a.push(e+"'"+c+"' => \""+Liftium.print_r(d[c])+'"\n')}}if(Liftium.e(a)){return"*empty object*"}else{return a.join("")}default:return d.toString()}};Liftium.recordEvents=function(f){var g="";for(var d=0,b=Liftium.chain[f].length;d<b;d++){var c=Liftium.chain[f][d];if(Liftium.e(c.started)){continue}var a=Liftium.getTagStat(c.tag_id,"l");if(!Liftium.e(Liftium.chain[f][d].loaded)){Liftium.d("Recording Load for "+c.network_name+", #"+c.tag_id+" in "+f,4);Liftium.setTagStat(c.tag_id,"l");g+=",l"+c.tag_id+"pl"+a}else{if(!Liftium.e(c.rejected)){g+=",r"+c.tag_id+"pl"+a;Liftium.d("Recording Reject for "+c.network_name+", #"+c.tag_id+" in "+f,5);continue}}}return g.replace(/^,/,"")};Liftium.reportError=function(g,b){try{Liftium.d("Liftium ERROR: "+g);if(Liftium.getBrowserLang()!="en"){}if(typeof Liftium.errorCount!="undefined"){Liftium.errorCount++}else{Liftium.errorCount=1}if(Liftium.errorCount>5){return}var f=["Error loading script","Script error.","GA_googleFillSlot is not defined","translate.google","COMSCORE","quantserve","urchin","greasemonkey","Permission denied","Unexpected token ILLEGAL","Access is denied"];for(var a=0;a<f.length;a++){if(g.indexOf(f[a])>=0){return}}if(b=="onerror"){Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/js",ga_action:g,trackingMethod:"ad"})}else{var d={msg:g.substr(0,512),type:b||"general",pubid:LiftiumOptions.pubid,lang:"en"};if(b=="tag"){d.tag_id=Liftium.lastTag.tag_id}Liftium.beaconCall(Liftium.baseUrl+"error?"+Liftium.buildQueryString(d))}}catch(c){Liftium.d("Yikes. Liftium.reportError has an error");Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/reportError",ga_action:"reportError",trackingMethod:"ad"})}};Liftium.errorMessage=function(a){if(typeof a=="object"){return Liftium.print_r(a)}else{return a}};Liftium.sendBeacon=function(){if(!Liftium.e(Liftium.beacon)){return true}var f;if(Liftium.e(Liftium.config)||f===undefined||f===null){Liftium.d("No throttle defined, using 1.0");f=1}else{f=Liftium.config.throttle}if(Math.random()>f){Liftium.d("Beacon throttled at "+f);return true}var c="",e=0;for(var d in Liftium.chain){if(typeof Liftium.chain[d]=="function"){continue}e++;Liftium.markChain(d);c+=","+Liftium.recordEvents(d)}c=c.replace(/^,/,"");Liftium.storeTagStats();var a={};a.numSlots=e;a.events=c;a.country=Liftium.getCountry();if(Liftium.slotTimeouts>0){a.slotTimeouts=Liftium.slotTimeouts}Liftium.d("Beacon: ",7,a);var g;if(!window.JSON){g={events:a.events}}else{g={beacon:window.JSON.stringify(a)}}Liftium.beacon=g;Liftium.beaconCall(Liftium.baseUrl+"beacon?"+Liftium.buildQueryString(g));Liftium.d("Liftium done, beacon sent");Wikia.Tracker.track({eventName:"liftium.init",ga_category:"init/beacon",ga_action:"beacon",trackingMethod:"ad"});if(window.LiftiumTest&&typeof window.LiftiumTest.afterBeacon=="function"){window.LiftiumTest.afterBeacon()}return true};Liftium.setAdjustedValues=function(c){var e,f=0.05,a;for(var d=0;d<c.length;d++){if(c[d].adjusted_value){continue}a=c[d].value;if(c[d].pay_type=="CPC"){f+=0.2}if(parseFloat(c[d].floor,10)){a=a*1.01}if(c[d].pay_type=="CPC"&&!Liftium.e(Liftium.getReferringKeywords())){a=a*1.25;f=0}e=Liftium.getTagStat(c[d].tag_id,"a");for(var b=0;b<e;b++){a=a-(a*f)}if(a<c[d].value*0.15){c[d].adjusted_value=c[d].value*0.15}else{c[d].adjusted_value=a}}return c};Liftium.setPageVar=function(a,b){LiftiumOptions["kv_"+a]=b};Liftium.setTagStat=function(h,e){Liftium.d("Setting a "+e+" stat for "+h,6);var g=Liftium.tagStats.split(",");if(g.length>Liftium.statMax){g.shift()}var a=Liftium.getTagStat(h,"l");var c=Liftium.getTagStat(h,"r");var b=0;if(e==="l"){a++;b=Liftium.getTagStat(h,"m")||0}else{if(e==="r"){c++;b=Liftium.getMinutesSinceMidnight()}}var d=Liftium.now.getDay()+"_"+h+"l"+a;if(c>0){d=d+"r"+c;d=d+"m"+b}var f=Liftium.tagStats.replace(Liftium.getStatRegExp(h),d);if(f===Liftium.tagStats){Liftium.tagStats=Liftium.tagStats+","+d}else{Liftium.tagStats=f}Liftium.tagStats=Liftium.tagStats.replace(/^,/,"");Liftium.d("Tag Stats After Set = "+Liftium.tagStats,6);Liftium.storeTagStats()};Liftium.storeTagStats=function(){Liftium.d("Stored Tag Stats = "+Liftium.tagStats,6);Liftium.cookie("LTS",Liftium.tagStats,{domain:Liftium.getCookieDomain(),path:"/",expires:86400*1000})};Liftium.trackEvent=function(d,b){if(typeof d=="object"){d=d.join("/")}Liftium.d("Track event: "+d,1);var g=window.navigator;Liftium.sessionid=Liftium.sessionid||Math.round(Math.random()*2147483647);d="/"+LiftiumOptions.pubid+"/"+d;var f="__utma="+Liftium.cookie("__utma")+";+__utmz="+Liftium.cookie("__utmz")+";";var e={utmwv:"4.6.5",utmn:Math.round(Math.random()*2147483647),utmhn:"liftium.wikia.com",utmcs:"UTF-8",utmsr:"1024x768",utmsc:"24-bit",utmul:(g.language||g.systemLanguage||g.browserLanguage||g.userLanguage||"").toLowerCase(),utmje:"1",utmfl:"10.0 r32",utmdt:document.title,utmhid:Liftium.sessionid,utmr:"0",utmp:d,utmcc:f};if(typeof b!="undefined"){e.utmac=b;Liftium.d("Tracking is using custom profile: "+b,7)}else{e.utmac="UA-17475676-10"}var a="https:"==window.location.protocol?"https://ssl.":"http://www.";a+="google-analytics.com/__utm.gif?"+Liftium.buildQueryString(e);Liftium.beaconCall(a,false)};Liftium.buildTrackUrl=function(a){return a.join("/")+"/"+[Liftium.getPageVar("Hub","unknown"),Liftium.langForTracking(Liftium.getPageVar("cont_lang","unknown")),Liftium.dbnameForTracking(Liftium.getPageVar("wgDBname","unknown")),Liftium.geoForTracking(Liftium.getCountry())].join("/")};Liftium.langForTracking=function(a){if(!Liftium.in_array(a,["en","es","de","fr"])){Liftium.d("Wiki lang "+a+" changed to 'other' for tracking",7);a="other"}return a};Liftium.dbnameForTracking=function(a){if(wgWikiFactoryTagIds!="undefined"&&!Liftium.e(wgWikiFactoryTagIds)&&wgWikiFactoryTagIds.length>4){return a}Liftium.d("Wiki dbname "+a+" changed to 'other' for tracking",7);return"other"};Liftium.geoForTracking=function(a){if(!Liftium.in_array(a,["unknown","us","uk","ca"])){Liftium.d("Country "+a+" changed to 'other' for tracking",7);a="other"}return a};Liftium.trackQcseg=function(){var g=Liftium.cookie("qcseg");Liftium.d("Quantcast cookie: "+g,5);if(Liftium.e(g)){return}if((g.search(/"[DT]"/)!=-1)&&(g.search(/"[0-9]{4}"/)==-1)){return}try{var f=JSON.parse(g);Liftium.d("Quantcast cookie parsed:",7,f);if(Liftium.e(f.segments)){return}var b=true;for(var a in f.segments){if(typeof f.segments[a]!="object"){continue}if(Liftium.e(f.segments[a])){continue}if(Liftium.e(f.segments[a].id)){continue}Liftium.d("Quantcast segment: "+f.segments[a].id,5);b=false}if(b){return}}catch(d){Liftium.d("Quantcast cookie parse error:",7,d);return}};Liftium.throwError=function(){return window.LiftiumthrowError.UndefinedVar};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"";this.OS=this.searchString(this.dataOS)||""},searchString:function(e){for(var b=0,a=e.length;b<a;b++){var c=e[b].string;var d=e[b].prop;this.versionSearchString=e[b].versionSearch||e[b].identity;if(c){if(c.indexOf(e[b].subString)!=-1){return e[b].identity}}else{if(d){return e[b].identity}}}return null},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return null}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();Liftium.loadInspector=function(){var b=Liftium._("LiftiumInspectorScript");if(Liftium.e(b)){var a=Liftium.loadScript(Liftium.baseUrl+"js/Inspector.js?r="+Math.random().toString().substring(2,8),true);a.id="LiftiumInspectorScript"}};var XDM={allowedMethods:[],debugOn:false,iframeUrl:"/liftium_iframe.html",postMessageEnabled:true};XDM.send=function(a,c,b){XDM.debug("XDM.send called from "+document.location.hostname);if(typeof c!="string"){XDM.debug("Bad argument for XDM.send, 'method' is not a string, ("+typeof c+")");return false}if(typeof b=="undefined"){b=[]}if(XDM.canPostMessage()){return XDM._postMessage(a,c,b)}else{return XDM._postMessageWithIframe(a,c,b)}};XDM.getDestinationDomain=function(b){if(b==top){if(document.referrer.toString()!==""){var a=document.referrer.toString().match(/https*:\/\/([^\/]+)/);XDM.debug("Hostname for destWin set to "+a[1]+" using referrer");return a[1]}else{return false}}else{return b.location.hostname}};XDM._postMessage=function(a,g,c){XDM.debug("Sending message using postMessage()");var f=XDM.getDestinationDomain(a),b;if(f===false){b="*"}else{b="http://"+f}var e=XDM.serializeMessage(g,c);if(a.postMessage){return a.postMessage(e,b)}else{if(a.document.postMessage){return a.document.postMessage(e,b)}else{throw ("No supported way of using postMessage")}}};XDM._postMessageWithIframe=function(a,g,c){XDM.debug("Sending message using iframe");if(XDM.iframeUrl===null){XDM.debug("Iframe method called, but no html file is specified");return false}var f=XDM.getDestinationDomain(a),b;if(f===false){return false}else{b="http://"+f}var e=b+XDM.iframeUrl+"?"+XDM.serializeMessage(g,c);XDM.debug("Calling iframe dispatch url: "+e);if(typeof XDM.iframe=="undefined"){XDM.iframe=document.createElement("iframe");XDM.iframe.style.display="none";XDM.iframe.width=0;XDM.iframe.height=0;if(document.body===null){document.firstChild.appendChild(document.createElement("body"))}document.body.appendChild(XDM.iframe)}XDM.iframe.src=e;return false};XDM.serializeMessage=function(e,c){var b="method="+escape(e.toString());var a;for(var d=0;d<c.length;d++){a=d+1;b+=";arg"+a+"="+escape(c[d])}XDM.debug("Serialized message: "+b);return b};XDM.canPostMessage=function(){if(XDM.postMessageEnabled===false){return false}else{if(window.postMessage||window.document.postMessage){return true}else{return false}}};XDM.debug=function(a){if(XDM.debugOn&&typeof console!="undefined"&&typeof console.log!="undefined"){console.log("XDM debug: "+a)}};XDM.listenForMessages=function(a){if(XDM.canPostMessage()){if(window.addEventListener){return window.addEventListener("message",a,false)}else{if(window.attachEvent){return window.attachEvent("onmessage",a)}else{return false}}}else{return true}};XDM.isAllowedMethod=function(c){if(typeof c=="undefined"){return false}var b=false;for(var a=0;a<XDM.allowedMethods.length;a++){if(c.toString()===XDM.allowedMethods[a]){b=true;break}}return b};XDM.executeMessage=function(serializedMessage){var nvpairs=XDM.parseQueryString(serializedMessage);if(XDM.isAllowedMethod(nvpairs.method)){var functionArgs=[],code=nvpairs.method;for(var prop in nvpairs){if(prop.substring(0,3)=="arg"){functionArgs.push(nvpairs[prop].replace(/"/g,'\\"'))}}if(functionArgs.length>0){code+='("'+functionArgs.join('","')+'");'}else{code+="();"}if(top!=self){nvpairs.destWin=nvpairs.destWin||"top";code=nvpairs.destWin+"."+code}XDM.debug("Evaluating "+code);return eval(code)}else{XDM.debug("Invalid method from XDM: "+nvpairs.method);return false}};XDM.parseQueryString=function(a){var c=[];if(typeof a!="string"){return c}if(a.charAt(0)==="?"){a=a.substr(1)}a=a.replace(/\;/g,"&",a);var f=a.split("&");for(var d=0,b;d<f.length;d++){if(f[d].length===0){continue}var j="",h="";if((b=f[d].indexOf("="))!=-1){try{j=decodeURIComponent(f[d].substr(0,b));h=decodeURIComponent(f[d].substr(b+1))}catch(g){j=unescape(f[d].substr(0,b));h=unescape(f[d].substr(b+1))}}else{j=f[d];h=true}c[j]=h}return c};Liftium.now=new Date();if(typeof wgNow!="undefined"){Liftium.now=wgNow;Liftium.d("Using monaco time:",7,wgNow)}Liftium.startTime=Liftium.now.getTime();Liftium.debugLevel=Liftium.getRequestVal("liftium_debug",0)||Liftium.cookie("liftium_debug");Liftium.maxHopTime=Liftium.getRequestVal("liftium_timeout",0)||Liftium.cookie("liftium_timeout")||1800000;LiftiumOptions.error_beacon=!Liftium.debugLevel&&!Liftium.getRequestVal("liftium_onerror",0)&&!Liftium.cookie("liftium_onerror");if(LiftiumOptions.error_beacon!==false){(function(){var a=window.onerror;window.onerror=function(b,c,d){a&&a(b,c,d);return Liftium.catchError(b,c,d)}}())}}if(window.wgAdDriverStartLiftiumOnLoad){Liftium.addEventListener(window,"load",Liftium.init)}else{if(Liftium.empty(LiftiumOptions.offline)){Liftium.init()}}Liftium.addEventListener(window,"load",Liftium.onLoadHandler);window.Athena=window.Athena||(function(a){var b=new Date();return{now:b,definedInsideWikiajs:true,getMinuteTargeting:function(){return this.now.getMinutes()%15},getPageVar:a.getPageVar,setPageVar:a.setPageVar}}(window.Liftium));window.AQ=window.AQ||(function(d,b,c){var e=(d.top!==d),a=this;return{eventUrls:[],chain:{},allTags:{},cwpid:504082,priceFloor:0,tries:0,next:function(f){b.d("AQ.next called with "+f,3);b.d("AQ.chain for "+f+": "+b.print_r(a.chain[f]),5);var h,g=0;for(h=a.chain[f].length-1;h>=0;h-=1){if(!b.e(a.chain[f][h].skipped)){g=h+1;break}else{if(!b.e(a.chain[f][h].attempt)){a.beacon(a.chain[f][h].id,"reject");a.chain[f][h].reject=true;b.d("AQ tag #"+a.chain[f][h].id+" rejected in "+f,3);g=h+1;break}}}if(g>a.chain[f].length-1){b.d("AQ: End of ContextWeb chain",5);if(e){b.iframeHop(a.win.location)}else{b.hop()}}else{b.debug("AQ.next calling tag #"+a.chain[f][g].id+" with a value of "+a.chain[f][g].fValue,3);a.tag(f,a.chain[f][g].id)}},beacon:function(f,h){if(b.rand<0.5){return}var g=b.baseUrl+"event/set?event=contextWebBeacon&cwtagid="+f+"&action="+h;b.d("AQ event beacon url: "+g,3);a.eventUrls.push(g);b.beaconCall(g)},checkForLoad:function(f){var h,g;b.d("AQ.checkForLoad called for "+f,4);if(b.e(d.strCreative)){if(a.tries<100){g="AQ.checkForLoad('"+f+"');";b.d("AQ: Recalling "+g+" in 100 ms",6);d.setTimeout(g,100);a.tries+=1}else{b.d("Giving up after 100 tries in AQ.checkForLoad")}return}for(h=a.chain[f].length-1;h>=0;h-=1){if(!b.e(a.chain[f][h].attempt)){if(b.e(a.chain[f][h].reject)){a.beacon(a.chain[f][h].id,"load");a.chain[f][h].load=true;b.d("AQ tag #"+a.chain[f][h].id+" loaded in "+f,3)}break}}},randomTag:function(h,o){var l,k,n,m,g,f=[];a.randomTagCalled=true;for(l=0;l<a.allTags[h].length;l+=1){n=false;for(k=0;k<a.chain[h].length;k+=1){if(a.allTags[h][l].id===a.chain[h][k].id){n=true;break}}if(!n){f.push(b.clone(a.allTags[h][l]))}}if(b.e(f)){a.tag(h,a.chain[h][0].id,o);return}m=Math.floor(Math.random()*f.length);b.d("AQ.randomTag calling tag "+m+" in the chain for "+h,2);g=a.chain[h];a.chain[h]=[];a.chain[h].push(b.clone(f[m]));a.chain[h][0].random=true;a.chain[h].push(b.clone(g[0]));a.chain[h].push(b.clone(g[1]));a.tag(h,a.chain[h][0].id,o)},tag:function(f,j,o){var l,m,s,r,n,k,q,g;if(o===c){a.win=o}b.d("AQ.tag called for "+f+" with tag #"+j,3);a.lastTag=j;for(l=0;l<a.chain[f].length;l+=1){if(a.chain[f][l].id===j){m=l;break}}switch(f){case"MR":s="300x250";r=300;n=250;break;case"LB":s="728x90";r=728;n=90;break;case"WS":s="160x600";r=160;n=600;break;default:document.write("<!-- Invalid slotgroup for AQ.tag -->");return false}try{q="http://"+b.getPageVar("hostname")+b.getPageVar("request")}catch(p){if(e&&!b.e(document.referrer)){q=document.referrer}}k="http://tag.contextweb.com/TAGPUBLISH/getad.aspx";g={tagver:1,"if":0,ca:"VIEWAD",cp:a.cwpid,ct:j,cf:s,cn:1,cr:200,cw:r,ch:n,cads:0,rq:1,cwu:q,mrnd:b.rand};k+="?"+b.buildQueryString(g,"&");a.beacon(j,"attempt");a.chain[f][m].attempt=true;if(m===0){d.setTimeout(function(){a.checkForLoad(f)},750*a.chain[f].length)}a.win.document.write('<script type="text/javascript" src="'+k+'"><\/script>');a.win.document.write("<script><\/script>");return true}}}(window,window.top.Athena));window.AQNext=window.AQ.next;window.meerkat=(function(a){return function(b){this.settings={close:"none",dontShow:"none",meerkatPosition:"bottom",animationSpeed:"slow",height:"auto",background:"none"};if(b){a.extend(this.settings,b)}var c=this.settings;a("html, body").css({margin:"0",padding:"0",height:"100%"});a("#meerkat").show();a("#meerkat-wrap").css({position:"fixed",width:"100%",height:c.height,left:0,"z-index":1000}).css(c.meerkatPosition,"0");a("#meerkat-container").css({background:c.background,height:c.height});a(c.close+","+c.dontShow).css({cursor:"pointer"});a("#meerkat-wrap").hide().slideDown(c.animationSpeed);a(c.close).click(function(){a("#meerkat-wrap").slideUp()});a(c.dontShow).click(function(){a("#meerkat-wrap").slideUp()})}}(window.jQuery));window.ve_alternate=(function(a){return function(b){b.style.display="none";a.hop()}}(window.Athena));var AIC2={$placeHolder:false,fingerprint:"b",called:false,startPosition:0,stopPosition:0,magicNumber:800,isRightToLeft:false,visible:false};AIC2.enabled=window.top===window.self&&window.wgEnableAdsInContent&&window.wgShowAds&&!window.wgIsMainpage&&(window.wgIsContentNamespace||window.wikiaPageType==="search");AIC2.init=function(){if(!AIC2.enabled||AIC2.called){return}AIC2.called=true;var a=$(window);AIC2.$placeHolder=$("#WikiaAdInContentPlaceHolder");Liftium.d("AIC2: init",5);if($("body").hasClass("rtl")){Liftium.d("AIC2: rtl wiki",7);AIC2.isRightToLeft=true}if(a.width()<1010){Liftium.d("AIC2: window too narrow, bailing out",3);return}if(!AIC2.checkStartStopPosition()){return}if(AIC2.startPosition+AIC2.magicNumber<AIC2.stopPosition){Liftium.d("AIC2: page long enough",7);AIC2.$placeHolder.css("position","absolute");AIC2.$placeHolder.append('<div id="INCONTENT_BOXAD_1" class="noprint" style="height: 250px; width: 300px; position: relative;"></div>');a.bind("scroll.AIC2",AIC2.onScroll);a.bind("resize.AIC2",AIC2.onScroll)}else{Liftium.d("AIC2: page too short",3)}};AIC2.checkStartStopPosition=function(){var f,d,b,a=$("#WikiaFooter"),c=$("#LEFT_SKYSCRAPER_3"),h=$("#INCONTENT_BOXAD_1");Liftium.d("AIC2: check start/stop position",7);if(!AIC2.$placeHolder.length){Liftium.d("AIC2: no rail",3);return false}try{b=parseInt(h.height(),10)||0;f=parseInt(AIC2.$placeHolder.offset().top,10);d=parseInt(a.offset().top,10)-10-b;if(c.is(":visible")&&c.height()>50){Liftium.d("AIC2: sky3 found",3);d=parseInt(c.offset().top,10)-20-b}}catch(g){Liftium.d("AIC2: catched in start/stop:",1,g);Wikia.Tracker.track({eventName:"liftium.errors",ga_category:"errors/AIC2",ga_action:"try-catch",trackingMethod:"ad"});return false}Liftium.d("AIC2: start/stop old/new",7,[AIC2.startPosition,AIC2.stopPosition,f,d]);if(!AIC2.startPosition&&!AIC2.stopPosition){AIC2.startPosition=f;AIC2.stopPosition=d;Liftium.d("AIC2: start/stop position set up",7);return true}if(AIC2.isAlmostEqual(AIC2.startPosition,f)&&AIC2.isAlmostEqual(AIC2.stopPosition,d)){Liftium.d("AIC2: start/stop position correct",7);return true}AIC2.startPosition=f;AIC2.stopPosition=d;Liftium.d("AIC2: start/stop position fixed",5);return false};AIC2.isAlmostEqual=function(d,c){return Math.abs(d-c)<3};AIC2.onScroll=function(){var b=$(window),a=$("#INCONTENT_BOXAD_1");Liftium.d("AIC2: onScroll",9);if((b.scrollTop()>AIC2.startPosition)&&(b.scrollTop()<AIC2.stopPosition)){if(!AIC2.visible){Liftium.d("AIC2.showAd",5);if(!AIC2.checkStartStopPosition()){return}if(a.hasClass("wikia-ad")==false){window.adslots2.push(["INCONTENT_BOXAD_1",null,"AdEngine2",null]);a.addClass("wikia-ad")}a.css({position:"fixed",top:"10px",visibility:"visible"});AIC2.visible=true}}else{if(AIC2.visible){Liftium.d("AIC2.hideAd",5);a.css("visibility","hidden");AIC2.glueAd();AIC2.visible=false}}};AIC2.glueAd=function(){Liftium.d("AIC2: glueAd",9);var c=$("#INCONTENT_BOXAD_1"),a=parseInt(c.offset().top);if(a>AIC2.stopPosition){Liftium.d("AIC2: glue at the bottom",7);var b=parseInt(AIC2.stopPosition-AIC2.startPosition+10);c.css({position:"absolute",top:b+"px"})}else{Liftium.d("AIC2: glue at the top",7);c.css({position:"relative",top:"10px"})}c.css("visibility","visible")};var VideoHandlers={init:function(){if($.browser.msie&&$.browser.version=="8.0"){$("#WikiaArticle").find(".info-overlay-title").each(function(){var b=$(this),a=b.css("max-width");b.css("width",a)})}}};VideoHandlers.init();var CreatePage={pageLayout:null,options:{},loading:false,context:null,wgArticlePath:mw.config.get("wgArticlePath"),visualEditorEnabled:!!mw.config.get("wgVisualEditor"),checkTitle:function(a){$.getJSON(CreatePage.context.wgScript,{action:"ajax",rs:"wfCreatePageAjaxCheckTitle",title:a},function(b){var c;if(b.result==="ok"){if(CreatePage.visualEditorEnabled){c=CreatePage.wgArticlePath.replace("$1",encodeURIComponent(a));location.href=c+"?veaction=edit"}else{location.href=CreatePage.options[CreatePage.pageLayout].submitUrl.replace("$1",encodeURIComponent(a))}}else{CreatePage.displayError(b.msg)}})},openDialog:function(b,a){if(CreatePage.visualEditorEnabled&&!$(b.target).hasClass("createpage")){return}if(Boolean(window.WikiaEnableNewCreatepage)===false){return}if(b&&b.which===2){return}if(b&&b.preventDefault){b.preventDefault()}if(false===CreatePage.loading){CreatePage.loading=true;$.getJSON(CreatePage.context.wgScript,{action:"ajax",rs:"wfCreatePageAjaxGetDialog"},function(d){var f,e,c;$.showModal(d.title,d.html,{width:d.width,id:"CreatePageDialog",callback:function(){CreatePage.loading=false;c=function(){CreatePage.setPageLayout($(this).data("optionName"))};for(var g in CreatePage.options){f=g.charAt(0).toUpperCase()+g.substring(1);e=$("#CreatePageDialog"+f+"Container");e.data("optionName",g);e.click(c)}if(typeof a==="number"){a=a.toString()}if(a){$("#wpCreatePageDialogTitle").val(decodeURIComponent(a))}CreatePage.setPageLayout(d.defaultOption);$("#wpCreatePageDialogTitle").focus();$("#CreatePageDialogButton").find(".createpage").click(function(h){h.preventDefault();CreatePage.submitDialog(false)})}})})}},submitDialog:function(a){CreatePage.checkTitle($("#wpCreatePageDialogTitle").val(),a)},displayError:function(b){var a=$("#CreatePageDialogTitleErrorMsg");a.html('<span id="createPageErrorMsg">'+b+"</span>");a.removeClass("hiddenStructure")},setPageLayout:function(a){CreatePage.pageLayout=a;var b=a.charAt(0).toUpperCase()+a.substring(1);$("#CreatePageDialog"+b).attr("checked","checked");$("#CreatePageDialogChoices").children("li").removeClass("accent");$("#CreatePageDialog"+b+"Container").addClass("accent")},getTitleFromUrl:function(a){var b=new mw.Uri(a);return b.path.replace(CreatePage.wgArticlePath.replace("$1",""),"").replace(/_/g," ")},redLinkClick:function(d,b){if(CreatePage.visualEditorEnabled){return}var f=b.split(":"),a=false,c;if(window.ContentNamespacesText&&(f.length>1)){for(c in window.ContentNamespacesText){if(f[0]===window.ContentNamespacesText[c]){a=true}}}else{a=true}if(a){CreatePage.openDialog(d,b)}else{return false}},init:function(b){CreatePage.context=b;if(window.WikiaEnableNewCreatepage){$().log("init","CreatePage");if(!window.WikiaDisableDynamicLinkCreatePagePopup){$("#dynamic-links-write-article-link, #dynamic-links-write-article-icon").click(function(d){CreatePage.openDialog(d,null)});$('.noarticletext a[href*="redlink=1"]').click(function(d){CreatePage.openDialog(d,CreatePage.context.wgPageName);return false})}$(".createpage").click(CreatePage.openDialog);var a=$("#add_recipe_tab"),c;if(a.exists()){c=a.find("a");if(c.attr("href").match(/CreatePage$/)){c.click(CreatePage.openDialog)}}$("a.new").bind("click",function(d){CreatePage.redLinkClick(d,CreatePage.getTitleFromUrl(this.href))});$(".createboxButton").bind("click",function(j){var d=$(j.target).parent(),g,h,f;if(d.attr("class")==="createboxForm"){g=d.children("input[name='prefix']").val()||"";h=d.children(".createboxInput");f=d.children("input[name='preload']");if((typeof f.val()===undefined)||(f.val()==="")){CreatePage.openDialog(j,g+h.val())}else{return true}}})}}};jQuery(function(){CreatePage.init(window)});define("wikia.videoBootstrap",["wikia.loader","wikia.nirvana","wikia.log","wikia.tracker"],function videoBootstrap(b,e,c,d){var f=0;function a(k,q,h){var r=this,p=q.init,m=q.html,j=q.scripts,o=q.jsParams;this.element=k;this.clickSource=h;this.title=q.title;this.provider=q.provider;function n(){if(m&&!q.htmlPreloaded){k.innerHTML=m}}function l(){n();if(p){require([p],function(s){r.clearTimeoutTrack();s(o,r)})}}function g(){var t,s=[];for(t=0;t<j.length;t++){s.push({type:b.JS,resources:j[t]})}b.apply(b,s).done(l)}if(j){g()}else{n()}if(!p){r.timeoutTrack()}}a.prototype={reload:function(n,l,m,g){var k=this.element,h=n||this.title,j=g||this.clickSource;this.clearTimeoutTrack();e.getJson("VideoHandler","getEmbedCode",{fileTitle:h,width:l,autoplay:m?1:0}).done(function(o){return new a(k,o.embedCode,j)})},track:function(g){c("tracking "+g,3,"VideoBootstrap");d.track({action:g,category:"video-player-stats",label:this.provider,trackingMethod:"internal",value:0},{title:this.title,clickSource:this.clickSource})},timeoutTrack:function(){var g=this;this.clearTimeoutTrack();f=setTimeout(function(){g.track("content-begin")},3000)},clearTimeoutTrack:function(){c("clearing tracking timeout",3,"VideoBootstrap");clearTimeout(f)},timeStampId:function(j){var g=document.getElementById(j),h=j+"-"+new Date().getTime();if(g){g.id=h}return h},destroy:function(){this.element.innerHTML=""}};return a});(function(b,c){var a={cache:{articleMedia:[],relatedVideos:[],latestPhotos:[],wikiPhotos:[],details:{},share:{},to:0},inlineVideoLinks:c(),lightboxLoading:false,inlineVideoLoading:[],videoInstance:null,pageAds:c("#TOP_RIGHT_BOXAD"),defaults:{id:"LightboxModal",className:"LightboxModal",width:970,noHeadline:true,topOffset:25,height:628,videoHeight:360,onClose:function(){c(b).off(".Lightbox");Lightbox.openModal.find(".video-media").children().remove();a.lightboxLoading=false;Lightbox.updateUrlState(true);Lightbox.current.thumbs=[];Lightbox.current.thumbTypesAdded=[];Lightbox.to=a.cache.to;Lightbox.ads.adMediaProgress=[];Lightbox.ads.adMediaShown=0;Lightbox.ads.adMediaShownSinceLastAd=0;Lightbox.ads.adIsShowing=false;a.pageAds.css("visibility","visible");Lightbox.clearTrackingTimeouts();if(a.videoInstance){a.videoInstance.clearTimeoutTrack()}}},videoThumbWidthThreshold:400,init:function(){var e=this,f=c("#WikiaArticle"),d=c("#RelatedVideosRL"),h=c("#LatestPhotosModule"),g=c("#WikiaArticleComments");f.add(h).add(d).add(g).off(".lightbox").on("click.lightbox",".lightbox, a.image",function(l){var m=c(this),r=m.children("img").first(),n=r.attr("data-image-key")||r.attr("data-video-key"),q,j;if(m.hasClass("link-internal")||m.hasClass("link-external")||r.attr("data-shared-help")||m.hasClass("no-lightbox")){return}l.preventDefault();if(m.closest(f).length){q=f}else{if(m.closest(d).length){q=d}else{if(m.closest(h).length){q=h}else{if(m.closest(g).length){q=g}}}}var o={target:m,parent:q};if(m.hasClass("lightbox-link-to-open")){n=m.attr("data-image-key")||m.attr("data-video-key")}else{if(m.hasClass("wikia-slideshow-popout")){var p=m.parents(".wikia-slideshow-toolbar").siblings(".wikia-slideshow-images-wrapper").find("li:visible").find("img").first();n=p.attr("data-image-name")||p.attr("data-video-name")}}if(!n){n=m.attr("data-image-name")||m.attr("data-video-name");n=n?n.replace(/ /g,"_"):n;a.handleOldDom(5)}if(!n){a.handleOldDom(5);return}j=m.children(".Wikia-video-play-button").length;if(j&&r.width()>=e.videoThumbWidthThreshold&&!m.hasClass("force-lightbox")){var k=b.wgWikiaHubType?LightboxTracker.clickSource.HUBS:LightboxTracker.clickSource.EMBED;a.displayInlineVideo(m,r,n,k);return}e.loadLightbox(n,o)});f.on("click.lightbox",".wikia-slideshow-images .thumbimage, .wikia-slideshow-images .wikia-slideshow-image",function(j){j.preventDefault();c(this).closest(".wikia-slideshow-wrapper").find(".wikia-slideshow-popout").click()})},loadLightbox:function(d,e){a.removeInlineVideos();a.lightboxLoading=true;a.pageAds.css("visibility","hidden");var f=c("<div>").makeModal(a.defaults);f.find(".modalContent").startThrobbing();var k={key:d,modal:f};c.extend(k,e);var g=[];if(!a.assetsLoaded){g.push(c.loadMustache());var h=[c.getSassCommonURL("/extensions/wikia/Lightbox/css/Lightbox.scss"),b.wgExtensionsPath+"/wikia/Lightbox/js/Lightbox.js"];g.push(c.getResources(h));var j=c.Deferred();c.nirvana.sendRequest({controller:"Lightbox",method:"lightboxModalContent",type:"GET",format:"html",data:{lightboxVersion:b.wgStyleVersion,userLang:b.wgUserLanguage},callback:function(l){a.templateHtml=l;j.resolve()}});g.push(j)}g.push(a.getMediaDetailDeferred({fileTitle:d}));c.when.apply(this,g).done(function(){a.assetsLoaded=true;Lightbox.initialFileDetail=arguments[arguments.length-1];Lightbox.makeLightbox(k)})},displayInlineVideo:function(h,f,e,d){var g=this;if(c.inArray(e,a.inlineVideoLoading)>-1){return}a.inlineVideoLoading.push(e);a.getMediaDetail({fileTitle:e,height:f.height(),width:f.width()},function(l){var k=l.videoEmbedCode,j=c('<div class="inline-video"></div>').insertAfter(h.hide());require(["wikia.videoBootstrap"],function(m){g.videoInstance=new m(j[0],k,d)});a.inlineVideoLinks=h.add(a.inlineVideoLinks);LightboxTracker.inlineVideoTrackingTimeout=setTimeout(function(){LightboxTracker.track(Wikia.Tracker.ACTIONS.VIEW,"video-inline",null,{title:l.title,provider:l.providerName,clickSource:d})},1000);a.inlineVideoLoading.splice(c.inArray(e,a.inlineVideoLoading),1)},true)},removeInlineVideos:function(){clearTimeout(LightboxTracker.inlineVideoTrackingTimeout);a.inlineVideoLinks.show().next().remove()},getMediaDetail:function(d,g,e){var f=d.fileTitle;if(!e&&a.cache.details[f]){g(a.cache.details[f])}else{c.nirvana.sendRequest({controller:"Lightbox",method:"getMediaDetail",type:"get",format:"json",data:d,callback:function(h){if(!e){a.cache.details[f]=h}g(h)}})}},getMediaDetailDeferred:function(e){var d=c.Deferred();a.getMediaDetail(e,function(f){d.resolve(f)});return d},loadFromURL:function(){var e=b.Wikia.Querystring().getVal("file"),f=c("#LightboxModal");if(e){if(f.length){a.getMediaDetail({fileTitle:e},function(g){Lightbox.current.key=g.title.replace(/ /g,"_");Lightbox.current.type=g.mediaType;Lightbox.setCarouselIndex();Lightbox.openModal.carousel.find("li").eq(Lightbox.current.index).click()})}else{var d={parent:c("#WikiaArticle"),clickSource:LightboxTracker.clickSource.SHARE};a.loadLightbox(e,d)}}else{if(f.length){f.closeModal()}}},isOldDom:null,handleOldDom:function(d){if(a.isOldDom===null){c().log("Send old DOM tracking","Lightbox");LightboxTracker.track(Wikia.Tracker.ACTIONS.VIEW,"old-dom",d,null,"internal")}a.isOldDom=true}};LightboxTracker={inlineVideoTrackingTimeout:0,track:function(g,d,f,e,h){Wikia.Tracker.track({action:g,category:"lightbox",label:d||"",trackingMethod:h||"internal",value:f||0},e)},clickSource:{RV:"relatedVideos",LP:"latestPhotos",EMBED:"embed",SEARCH:"search",SV:"specialVideos",LB:"lightbox",SHARE:"share",HUBS:"hubs",OTHER:"other",TOUCHSTORM:"touchStorm"}};c(function(){if(b.wgEnableLightboxExt){a.init();a.loadFromURL()}});b.LightboxLoader=a;b.LightboxTracker=LightboxTracker})(this,jQuery);$(function(){var a={cache:[],timestats:0,lastScrollTop:0,init:function(){var c=this;c.createCache();c.checkAndLoad();var b=$.throttle(250,$.proxy(c.checkAndLoad,c));$(window).on("scroll",b)},createCache:function(){var b=this;b.cache=[];$("img.lzy").each(function(d){var c=[];var e=$(this);var f=e.offset().top;c.push(this);c.push(e);c.push(f);c.push(e.height()+f);b.cache[d]=c})},verifyCache:function(){if(this.cache.length==0){return}var d=this.cache.length-1;var f=Math.floor(Math.random()*d);var c=[d,f];var h=false;for(var e in c){var b=c[e];if(b in this.cache){var j=this.cache[b][1].offset().top;var g=Math.abs(j-this.cache[b][2]);if(g>5){h=true;break}}}if(h){this.createCache()}},load:function(d){var c=$(d);d.onload="";var b=c.data("src");if(b){d.src=b}c.removeClass("lzy").removeClass("lzyPlcHld")},checkAndLoad:function(){this.verifyCache();var d=$(window).scrollTop();var h=Math.abs(d-this.lastScrollTop);h=Math.min(h,1000)*3+200;this.lastScrollTop=d;var c=d+$(window).height()+h;d=d-h;var f=function(){this.setAttribute("class",this.getAttribute("class")+" lzyLoaded")};for(var k in this.cache){var b=this.cache[k];var e=b[0];var l=b[1];var j=b[2];var g=b[3];if((d<j&&c>j)||(d<g&&c>g)){l.addClass("lzyTrns");e.onload=f;e.src=l.data("src");l.removeClass("lzy");delete this.cache[k]}}}};a.init();window.ImgLzy=a});function openLogin(a){if((typeof wgComboAjaxLogin=="undefined")||(!wgComboAjaxLogin)){return true}else{showComboAjaxForPlaceHolder(false,"");a.preventDefault()}}function openLoginAndConnect(a){if((typeof wgComboAjaxLogin=="undefined")||(!wgComboAjaxLogin)){return true}else{if(typeof AjaxLogin=="undefined"){$.getScript(window.wgScript+"?action=ajax&rs=getRegisterJS&uselang="+window.wgUserLanguage+"&cb="+wgMWrevId+"-"+wgStyleVersion,function(){openLoginAndConnect()})}else{showComboAjaxForPlaceHolder(false,"",AjaxLogin.slideToLoginAndConnect)}a.preventDefault()}}function openRegister(a){if((typeof wgComboAjaxLogin=="undefined")||(!wgComboAjaxLogin)){return true}else{showComboAjaxForPlaceHolder(false,"","",true);a.preventDefault()}}function showComboAjaxForPlaceHolder(c,b,e,a,d){if(typeof showComboAjaxForPlaceHolder.statusAjaxLogin=="undefined"){showComboAjaxForPlaceHolder.statusAjaxLogin=false}if((wgUserName!==null)||(typeof wgComboAjaxLogin=="undefined")||(!wgComboAjaxLogin)){return false}if((typeof AjaxLogin!="undefined")&&AjaxLogin.showComboFromDOM()){if(b){AjaxLogin.setPlaceHolder(c)}if((typeof a!="undefined")&&a){AjaxLogin.showRegister($("#wpGoRegister"))}else{AjaxLogin.showLogin($("#wpGoLogin"))}return true}if(showComboAjaxForPlaceHolder.statusAjaxLogin){return true}showComboAjaxForPlaceHolder.statusAjaxLogin=true;window.scrollTo(0,0);$.getMessages("ComboAjaxLogin",function(){$().getModal(window.wgScript+"?action=ajax&rs=GetComboAjaxLogin&uselang="+window.wgUserLanguage+"&returnto="+wgPageName+"&returntoquery="+wgPageQuery+"&cb="+wgMWrevId+"-"+wgStyleVersion,false,{callback:function(){$.getScript(window.wgScript+"?action=ajax&rs=getRegisterJS&uselang="+window.wgUserLanguage+"&cb="+wgMWrevId+"-"+wgStyleVersion,function(){if(b){AjaxLogin.setPlaceHolder(c)}AjaxLogin.init($("#AjaxLoginLoginForm form:first"));AjaxLogin.show();showComboAjaxForPlaceHolder.statusAjaxLogin=false;if((typeof a!="undefined")&&a){AjaxLogin.showRegister($("#wpGoRegister"))}else{AjaxLogin.showLogin($("#wpGoLogin"))}if(typeof FB!="undefined"){FB.XFBML.parse()}if((typeof d!="undefined")&&(d)){if(d==true){$("#comboajaxlogin-actionmsg").show()}else{if(d=="protected"){$("#comboajaxlogin-actionmsg-protected").show()}}}if(typeof e=="function"){e()}})}})});return true}if(window.wgComboAjaxLogin){$(function(){$(".ajaxLogin").click(openLogin);$(".ajaxRegister").click(openRegister);if(wgUserName!==null){if(window.location.href.indexOf("placeholder=")>0){element=window.location.href.split("placeholder=")[1].split("&")[0];if($("#"+element).parent().parent().hasClass("wikiaPlaceholder")){$("#"+element).trigger("click")}}}if(wgUserName===null){$(".wikiaPlaceholder .wikia-button").removeAttr("onclick").click(function(b){if(b.target.nodeName=="SPAN"){showComboAjaxForPlaceHolder($(b.target.parentNode).attr("id"),true)}else{showComboAjaxForPlaceHolder($(b.target).attr("id"),true)}return false});var a=$("#ca-viewsource").add("#te-editanon").add(".loginToEditProtectedPage").add(".upphotoslogin");if(window.wgDisableAnonymousEditig){a=a.add(".editsection")}a.click(function(c){var b=true;if($(c.target).is(".loginToEditProtectedPage")){b="protected"}else{if($(c.target).is(".upphotoslogin")){b="reload"}}showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){if(b=="protected"){AjaxLogin.doReload("action=edit")}else{if(b=="reload"){AjaxLogin.doReload("")}else{var d=$(c.target);if(d.is("a")){window.location.href=d.attr("href")}else{if(d.parent().is("a")){window.location.href=d.parent().attr("href")}else{window.location.href=d.closest("nav").find("a").attr("href")}}}}}},false,b);return false});$(".wikiaComboAjaxLogin").click(function(b){showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){CreatePage.openDialog(b,null)}});return false});$(".require-login").click(function(b){$().log("login required for this action");if(showComboAjaxForPlaceHolder("",false,function(){AjaxLogin.doSuccess=function(){var c=$(b.target).attr("href");if(c){window.location.href=c}}},false,true)){b.preventDefault()}})}})}var UserLoginAjaxForm=function(b,a){this.el=$(b);this.options=a||{};this.init()};UserLoginAjaxForm.prototype.init=function(){this.form=this.el.find("form");this.wikiaForm=new WikiaForm(this.form);this.inputs={username:this.form.find("input[name=username]"),password:this.form.find("input[name=password]"),keeploggedin:this.form.find("input[name=keeploggedin]"),logintoken:this.form.find("input[name=loginToken]"),returnto:this.form.find("input[name=returnto]")};this.submitButton=this.form.find("input[type=submit]");this.forgotPasswordLink=this.form.find(".forgot-password");this.retrieveLoginToken();this.form.submit($.proxy(this.submitLogin,this));this.forgotPasswordLink.click($.proxy(this.mailPassword,this));this.inputs.username.focus()};UserLoginAjaxForm.prototype.submitLogin=function(a){$(window).trigger("UserLoginSubmit");this.submitButton.attr("disabled","disabled");if(this.options.ajaxLogin){a.preventDefault();this.ajaxLogin()}};UserLoginAjaxForm.prototype.ajaxLogin=function(){$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"login",format:"json",loginToken:this.loginToken,username:this.inputs.username.val(),password:this.inputs.password.val(),keeploggedin:this.inputs.keeploggedin.is(":checked")},$.proxy(this.submitLoginHandler,this))};UserLoginAjaxForm.prototype.submitLoginHandler=function(b){$().log(b);this.form.find(".error-msg").remove();this.form.find(".input-group").removeClass("error");var a=b.result,c;if(a==="ok"){window.wgUserName=b.wgUserName;c=this.options.callback||"";if(c&&typeof c==="function"){c(b)}else{this.reloadPage()}}else{if(a==="resetpass"){c=this.options.resetpasscallback||"";if(c&&typeof c==="function"){c(b)}else{$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"changePassword",format:"html",username:this.inputs.username.val(),password:this.inputs.password.val(),returnto:this.inputs.returnto.val(),fakeGet:1},$.proxy(this.retrieveTemplateHandler,this))}}else{if(a==="unconfirm"){$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"getUnconfirmedUserRedirectUrl",format:"json",username:this.inputs.username.val()},function(d){window.location=d.redirectUrl})}else{this.submitButton.removeAttr("disabled");this.errorValidation(b)}}}};UserLoginAjaxForm.prototype.retrieveTemplateHandler=function(a){var c=$('<div style="display:none" />').append(a);var d=c.find("h1");var b=this.form;this.form.slideUp(400,function(){b.replaceWith(c);c.slideDown(400)})};UserLoginAjaxForm.prototype.reloadPage=function(){var a=window.location.href;var b="?";if(a.indexOf("?")>0){b="&"}window.location.href=a.split("#")[0]+b+"cb="+Math.floor(Math.random()*10000)};UserLoginAjaxForm.prototype.errorValidation=function(a){if(a.errParam){this.wikiaForm.showInputError(a.errParam,a.msg)}else{this.wikiaForm.showGenericError(a.msg)}};UserLoginAjaxForm.prototype.retrieveLoginToken=function(a){a=a||{};if(!this.loginToken||a.clearCache){this.loginToken="retrieving";$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"retrieveLoginToken",format:"json"},$.proxy(function(b){this.loginToken=b.loginToken;this.inputs.logintoken.val(b.loginToken)},this))}};UserLoginAjaxForm.prototype.mailPassword=function(a){a.preventDefault();this.form.find(".input-group").removeClass("error");this.form.find(".error-msg").remove();$().log("mailing password");$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"mailPassword",format:"json",username:this.inputs.username.val()},$.proxy(this.mailPasswordHandler,this))};UserLoginAjaxForm.prototype.mailPasswordHandler=function(a){$().log(a);if(a.result==="ok"){this.errorValidation(a)}else{if(a.result==="error"){this.errorValidation(a)}}};var UserSignupAjaxForm=function(b,a,c,e,d){this.wikiaForm=b;this.inputsToValidate=a||[];this.notEmptyFields=e||[];this.captchaField=d||"";this.submitButton=$(c);this.activateSubmit()};UserSignupAjaxForm.prototype.validateInput=function(d){var b=$(d.target);var c=b.attr("name");var f=this.getDefaultParamsForAjax();f.field=c;f[c]=b.val();var a={paramName:c,form:this};$.post(wgScriptPath+"/wikia.php",f,$.proxy(this.validationHandler,a))};UserSignupAjaxForm.prototype.validationHandler=function(a){var c=this.paramName;var b=this.form;if(a.result==="ok"){b.wikiaForm.clearInputError(this.paramName)}else{b.wikiaForm.showInputError(this.paramName,a.msg)}this.form.activateSubmit()};UserSignupAjaxForm.prototype.validateBirthdate=function(c){var b=$(c.target);var a={paramName:b.attr("name"),form:this};if(UserSignup.deferred&&typeof UserSignup.deferred.reject==="function"){UserSignup.deferred.reject()}var d=this.getDefaultParamsForAjax();$.extend(d,{field:"birthdate",birthyear:this.wikiaForm.inputs.birthyear.val(),birthmonth:this.wikiaForm.inputs.birthmonth.val(),birthday:this.wikiaForm.inputs.birthday.val()});UserSignup.deferred=$.post(wgScriptPath+"/wikia.php",d,$.proxy(this.validationHandler,a))};UserSignupAjaxForm.prototype.getDefaultParamsForAjax=function(){return{controller:"UserSignupSpecial",method:"formValidation",format:"json"}};UserSignupAjaxForm.prototype.checkFieldsValid=function(){var c=true;var a=this.notEmptyFields;for(var b=0;b<a.length;b++){if(this.checkFieldEmpty(this.wikiaForm.inputs[a[b]])||this.wikiaForm.getInputGroup(a[b]).hasClass("error")){c=false;break}}if(this.captchaField&&this.checkFieldEmpty(this.wikiaForm.inputs[this.captchaField])){c=false}return c};UserSignupAjaxForm.prototype.checkFieldEmpty=function(a){return(a.is("input")&&a.val()=="")||(a.is("select")&&a.val()==-1)};UserSignupAjaxForm.prototype.activateSubmit=function(){var a=this.checkFieldsValid();if(a){this.submitButton.removeAttr("disabled")}else{this.submitButton.attr("disabled","disabled")}};var UserLoginModal={loginAjaxForm:false,isModalOpened:false,show:function(a){if(!window.wgComboAjaxLogin&&window.wgEnableUserLoginExt&&!this.isModalOpened){this.isModalOpened=true;a=a||{};$.get(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"modal",format:"html",uselang:window.wgUserLanguage},$.proxy(function(b){UserLoginModal.dialog=$(b).makeModal({width:350,onClose:$.proxy(function(){this.isModalOpened=false},this)});UserLoginModal.loginAjaxForm=new UserLoginAjaxForm(UserLoginModal.dialog,{ajaxLogin:true,callback:function(c){wgUserName=c.username;var d=a.callback;if(d&&typeof d==="function"){if(!a.persistModal){UserLoginModal.dialog.closeModal()}d()}else{UserLoginModal.loginAjaxForm.reloadPage()}},resetpasscallback:function(c){$.post(wgScriptPath+"/wikia.php",{controller:"UserLoginSpecial",method:"changePassword",format:"html",username:UserLoginModal.loginAjaxForm.inputs.username.val(),password:UserLoginModal.loginAjaxForm.inputs.password.val(),returnto:UserLoginModal.loginAjaxForm.inputs.returnto.val(),fakeGet:1},function(d){var f=$('<div style="display:none" />').append(d);var g=f.find("h1");UserLoginModal.dialog.find("h1").text(g.text());g.remove();var e=UserLoginModal.dialog.find(".UserLoginModal");e.slideUp(400,function(){e.html("").html(f);f.show();e.slideDown(400)})})}});UserLoginFacebook.init()},this));$.getResources([$.getSassCommonURL("/extensions/wikia/UserLogin/css/UserLoginModal.scss")]);return true}else{if(window.wgComboAjaxLogin){showComboAjaxForPlaceHolder(false,false,function(){if(a.callback){AjaxLogin.doSuccess=a.callback}},false,true);return true}}return false},isPreventingForceLogin:function(a){if(!(a.closest("span").hasClass("drop"))&&!(a.closest("ul").hasClass("WikiaMenuElement"))){return false}return true},init:function(){var a=$("#te-editanon, .loginToEditProtectedPage, .upphotoslogin");if(window.wgDisableAnonymousEditing){a=a.add(".editsection")}a.click($.proxy(function(b){b.stopPropagation();if(!this.isPreventingForceLogin($(b.target))&&UserLogin.isForceLogIn()){b.preventDefault()}},this));$("body").delegate(".ajaxLogin","click",function(b){UserLoginModal.show();b.preventDefault()})}};$(function(){if((typeof window.wgEnableUserLoginExt!="undefined")&&wgEnableUserLoginExt){UserLoginModal.init()}});(function(a,b,d){if(a.wgIsEditPage){return}var c={assetsLoaded:false,loadingAssets:false,wrapperSelector:".MiniEditorWrapper",initTime:0,initTimer:null,loadTime:0,loadTimer:null,ckeditorEnabled:false,editorSuite:"mweditorsuite",editorIsLoading:false,config:{animations:{},isMiniEditor:true,mode:"source",toolbars:{tabs:[],toolbar:["FormatMiniEditorSource","InsertMiniEditor"],rail:[]}},plugins:["MiniEditor","loadingstatus"],configure:function(){if(!this.assetsLoaded){return}if(typeof RTE!="undefined"){this.ckeditorEnabled=true;this.editorSuite="ckeditorsuite";this.config.mode=a.RTEInitMode||"wysiwyg";this.config.toolbars.toolbar=["ModeSwitch","FormatMiniEditor"].concat(this.config.toolbars.toolbar);RTE.config.contentsCss.push(b.getSassLocalURL("extensions/wikia/MiniEditor/css/core/content.scss"));RTE.overlayNode.bind("click.MiniEditor",function(){RTE.overlayNode.data("wikiaEditor").setAsActiveInstance()})}this.plugins.unshift(this.editorSuite);this.config.uiElements=a.wgEditorExtraButtons||{};GlobalTriggers.fire("MiniEditorReady")},loadAssets:function(f){var e=this;if(this.loadingAssets||this.assetsLoaded){if(b.isFunction(f)){f()}return}this.loadTimer=new Date();b().log("Start resource loading","MiniEditor");this.loadingAssets=true;b.nirvana.sendRequest({controller:"MiniEditorController",method:"makeGlobalVariables",data:{useeditor:b.getUrlVar("useeditor")},type:"POST",callback:function(j){var h=a.wgMiniEditorAssets;for(var g in j){a[g]=j[g]}if(typeof h!="undefined"&&b.isArray(h)){b.each(h,function(k,l){h[k]=a.wgResourceBasePath+l});h=a.wgMiniEditorAssets=j.wgMiniEditorAssets.concat(h)}b.getResources(h,b.proxy(function(){this.loadTime=(new Date().getTime()-this.loadTimer.getTime());b().log("End resource loading ("+this.loadTime+"ms)","MiniEditor");this.assetsLoaded=true;this.loadingAssets=false;this.configure();if(b.isFunction(f)){f()}},e),function(m,k,l){b().log(arguments,"MiniEditor")})}})},loading:function(e,f){b(e).closest(this.wrapperSelector).addClass(f?"preloading":"loading");this.editorIsLoading=true},initEditor:function(g,n,e){var k=b(g),h=k.closest(this.wrapperSelector),f=e&&e.target&&e.target!=k.get(0);if(this.loadingAssets){return}if(!this.assetsLoaded){this.loading(k,f);return this.loadAssets(b.proxy(function(){this.initEditor(g,n)},this))}var j=k.data("wikiaEditor");if(j&&j.ready){j.fire("editorActivated",(j.event=e))}else{if((j||(j=WikiaEditor.getInstance()))&&!j.ready){this.loading(k,f);j.fire("editorBeforeReady",(j.event=e))}else{this.initTimer=new Date();b().log("Start initialization","MiniEditor");n=b.extend(true,{},b.fn.miniEditor.options,n);var m=this,l=b.extend({},n.events);this.loading(k,f);l.editorReady=function(){m.editorIsLoading=false;if(b.isFunction(n.events.editorReady)){n.events.editorReady.apply(m,arguments)}};k.bind(l);if(n.content!==d){k.html(n.content)}j=WikiaEditor.create(this.plugins,b.extend(true,{},this.config,{body:k,element:h.addClass(this.editorSuite),minHeight:k.data("min-height")||200,mode:b.isArray(n.edgeCases)&&n.edgeCases.length?"source":this.config.mode,maxHeight:k.data("max-height")||400,startupFocus:!f},n.config),e);k.addClass("wikiaEditor").triggerHandler("editorInit",[j,e])}}},getStartupMode:function(f){var e=b(f);if(e.length){var g=e.data("wikiaEditor");if(g){return g.mode}}return this.config.mode},getLoadConversionFormat:function(e){return WikiaEditor.modeToFormat(this.getStartupMode(e))=="richtext"?"richtext":""},getSaveConversionFormat:function(e){return this.getLoadConversionFormat(e)=="richtext"?"wikitext":""}};b.fn.miniEditor=function(e,f){return this.each(function(){c.initEditor(this,e,f)})};b.fn.miniEditor.options={config:{},events:{}};b(function(){if(!a.wgMiniEditorLoadOnDemand){c.assetsLoaded=true;c.configure()}});a.MiniEditor=c})(this,jQuery);(function(a,b){if(!a.wgIsArticle){return}var d=b(a);var c={animations:{},processing:false,mostRecentCount:0,messagesLoaded:false,miniEditorEnabled:typeof a.wgEnableMiniEditorExt!="undefined"&&skin=="oasis",loadOnDemand:typeof a.wgArticleCommentsLoadOnDemand!="undefined",initCompleted:false,init:function(){var g=b("#article-comments");var e=b("#article-comm-fbMonit");var f=b("#fbCommentMessage");if(c.miniEditorEnabled){var h=b("#article-comm");h.bind("focus",function(j){c.editorInit(this)});if(h.is(":focus")){c.editorInit(h)}}if(a.wgDisableAnonymousEditing&&!a.wgUserName){b(".article-comm-reply").hide()}else{g.on("click",".article-comm-edit",c.actionProxy(c.edit));g.on("click",".article-comm-reply",c.actionProxy(c.reply));b("#article-comm-submit").bind("click",{source:"#article-comm"},c.actionProxy(c.postComment))}e.mouseenter(function(){f.fadeIn("slow")});e.mouseleave(function(){f.fadeOut("slow")});c.addHover();c.showEditLink();c.initCompleted=true},actionProxy:function(e){return function(f){f.preventDefault();if(c.miniEditorEnabled&&MiniEditor.editorIsLoading){b().log("Event cancelled because editor is loading: ",f);return true}e.apply(this,arguments)}},showEditLink:function(){if(wgUserName){b("#article-comments-ul details").find('a:contains("'+wgUserName+'")').closest("details").find(".edit-link").show()}},edit:function(g){g.preventDefault();if(c.processing){return}if(c.miniEditorEnabled&&!MiniEditor.assetsLoaded){MiniEditor.loadAssets(f)}else{f()}function f(){var e=g.target.id.replace(/^comment/,""),h=b("#article-comm-textfield-"+e);b.getJSON(wgScript,{action:"ajax",article:wgArticleId,convertToFormat:c.getLoadConversionFormat(h),id:e,method:"axEdit",rs:"ArticleCommentsAjax"},function(s){if(!s.error){var o=b(g.target).closest(".buttons"),p="#article-comm-div-form-"+s.id,r="#article-comm-textfield-"+s.id,q=b("#comm-text-"+s.id).hide(),l=b(p),n=q.parent(),j=b(s.text).hide(),m=j.find(r).val();if(!l.length){n.append(j.attr("id",p.substr(1)));l=b(p)}var k=b(r);if(c.miniEditorEnabled){c.editorInit(k,m,s.edgeCases)}else{k.val(m)}l.show();o.hide();b("#article-comm-submit-"+s.id).bind("click",{id:s.id,emptyMsg:s.emptyMsg},c.actionProxy(c.saveEdit));b("#article-comm-edit-cancel-"+s.id).bind("click",{id:s.id,target:g.target,text:s.text},c.actionProxy(c.cancelEdit))}c.processing=false})}c.processing=true},cancelEdit:function(g){var f=g.data.id;g.preventDefault();if(c.miniEditorEnabled){b("#article-comm-textfield-"+f).data("wikiaEditor").fire("editorDeactivated")}b("#article-comm-div-form-"+f).hide();b(g.data.target).closest(".buttons").show();b("#comm-text-"+f).show()},saveEdit:function(m){m.preventDefault();if(c.processing){return}var h=m.data.id,f=b("#article-comm-form-"+h);if(f.length){var l=b(m.target).siblings(".throbber"),g=b("#article-comm-submit-"+h),k=b("#article-comm-textfield-"+h),j=c.getContent(k);g.parent().find(".info").remove();if(b.trim(j)==""){g.after(b("<span>").addClass("info").html(m.data.emptyMsg));return}b("#article-comm-info").html("");l.css("visibility","visible");k.attr("readonly","readonly");b.postJSON(wgScript,{action:"ajax",article:wgArticleId,convertToFormat:c.getSaveConversionFormat(k),id:h,method:"axSave",rs:"ArticleCommentsAjax",title:wgPageName,wpArticleComment:j},function(e){l.css("visibility","hidden");if(!e.error){if(e.commentId&&e.commentId!=0){var o=b("#comm-"+e.commentId),n=b(e.text);b("#article-comm-div-form-"+e.commentId).hide();if(c.miniEditorEnabled){k.data("wikiaEditor").fire("editorReset")}o.find(".article-comm-text").html(n.find(".article-comm-text").html()).show();o.find(".edited-by").html(n.find(".edited-by").html())}}else{b("#article-comm-info").html(e.msg)}k.removeAttr("readonly");c.processing=false});c.processing=true}},reply:function(f){f.preventDefault();if(c.processing){return}b.getJSON(wgScript,{action:"ajax",article:wgArticleId,id:b(this).closest("li").attr("id").replace(/^comm-/,""),method:"axReply",rs:"ArticleCommentsAjax",title:wgPageName},function(g){var l=b("#comm-"+g.id),k=b("#comm-text-"+g.id).parent(),e=k.find(".article-comm-edit-box"),j=k.find(".buttons").hide();k.find(".info").remove();if(e.length){e.show()}else{if(!g.error){k.append(g.html);b("#article-comm-reply-submit-"+g.id).bind("click",{source:"#article-comm-reply-textfield-"+g.id,parentId:g.id},c.actionProxy(c.postComment))}else{if(g.error==2){k.find(".tools").after(b("<span>").addClass("info").html(g.msg))}else{b.showModal("",g.msg)}}}var h=b("#article-comm-reply-textfield-"+g.id);if(c.miniEditorEnabled){c.editorInit(h,{editorActivated:function(m,n){k.find(".article-comm-edit-box").show()},editorDeactivated:function(m,n){if(!n.getContent()){k.find(".article-comm-edit-box").hide();j.show()}}})}else{h.focus()}c.processing=false});c.processing=true},postComment:function(n){n.preventDefault();if(c.processing){return}var k=b(n.data.source),m=b(n.target),j=m.siblings(".throbber"),g=c.getContent(k),l=b.getUrlVar("showall");if(b.trim(g)==""){return}j.css("visibility","visible");k.attr("readonly","readonly");m.attr("disabled",true);var h={action:"ajax",article:wgArticleId,convertToFormat:c.getSaveConversionFormat(k),method:"axPost",rs:"ArticleCommentsAjax",title:wgPageName,wpArticleComment:g};if(n.data.parentId){h.parentId=n.data.parentId;h.page=b(".article-comments-pagination-link-active").eq(0).attr("page")}if(l){h.showall=1}function f(){b.postJSON(wgScript,h,function(p){j.css("visibility","hidden");if(c.miniEditorEnabled){k.data("wikiaEditor").fire("editorReset")}else{k.val("")}if(!p.error){var q,o,r=p.parentId,e=b(p.text);if(r){q=b("#comm-"+r);o=q.next();if(!o.hasClass("sub-comments")){q.after(o=b('<ul class="sub-comments"></ul>'))}o.append(e);q.find(".article-comm-edit-box").hide();q.find(".buttons").show()}else{e.prependTo("#article-comments-ul")}b("#article-comments-counter-header").html(b.msg("oasis-comments-header",p.counter));if(a.skin=="oasis"){b("#WikiaPageHeader, #WikiaUserPagesHeader").find(".commentsbubble").html(p.counter);if(!r){if(!c.mostRecentCount){c.mostRecentCount=b("#article-comments-ul > li").length}else{c.mostRecentCount++}b("#article-comments-counter-recent").html(b.msg("oasis-comments-showing-most-recent",c.mostRecentCount))}}c.addHover();c.showEditLink();b("#article-comm-info").html("")}else{b("#article-comm-info").html(p.msg)}k.removeAttr("readonly");b(n.target).removeAttr("disabled");c.processing=false});c.processing=true}if(!c.messagesLoaded){b.getMessages("ArticleCommentsCounter",function(){c.messagesLoaded=true;f()})}else{f()}},setPage:function(h){h.preventDefault();var g=parseInt(b(this).attr("page"));var f=b("#article-comments-ul").addClass("loading");b.getJSON(wgScript+"?action=ajax&rs=ArticleCommentsAjax&method=axGetComments&article="+wgArticleId,{page:g,order:b("#article-comm-order").attr("value")},function(j){f.removeClass("loading");if(!j.error){f.html(j.text);var e=b(".article-comments-pagination");if(e.exists()){e.html(j.pagination)}c.addHover()}c.processing=false})},addHover:function(){b(".article-comments-pagination-link").bind("click",c.setPage).not(".article-comments-pagination-link-active, #article-comments-pagination-link-prev, #article-comments-pagination-link-next").hover(function(){b(this).addClass("accent")},function(){b(this).removeClass("accent")})},editorInit:function(h,n,j,g){var m=b(h),l=m.data("wikiaEditor");if(typeof n==="string"){g=j;j=n;n={}}var f=b.isArray(g)&&g.length;if(l){l.fire("editorActivated");if(j!==undefined){if(f){l.ck.setMode("source")}l.setContent(j)}}else{var k=b("#WikiaArticleComments .actionButton").addClass("disabled").attr("disabled",true);if(j!==undefined){m.val(j)}function e(){n=n||{};var o=n.editorActivated;n.editorActivated=function(p,q){k.removeClass("disabled").removeAttr("disabled");if(b.isFunction(o)){o.apply(this,arguments)}};m.miniEditor({config:{animations:MiniEditor.Wall.Animations,mode:f?"source":MiniEditor.config.mode},events:n})}if(!MiniEditor.assetsLoaded){MiniEditor.loading(m);MiniEditor.loadAssets(e)}else{e()}}},getContent:function(e){return c.miniEditorEnabled?e.data("wikiaEditor").getContent():e.val()},getLoadConversionFormat:function(e){return c.miniEditorEnabled?MiniEditor.getLoadConversionFormat(e):""},getSaveConversionFormat:function(e){return c.miniEditorEnabled?MiniEditor.getSaveConversionFormat(e):""},scrollToElement:function(g){var f=b(g),j=d.scrollTop(),h=j+d.height(),e=f.offset().top;f.find("blockquote").addClass("current");if(e<j||e>h){b("html, body").animate({scrollTop:e},1)}}};if(c.loadOnDemand){b(function(){if(!b("#WikiaArticleComments").length){return}var f,k=a.location.hash,j=/^#comm-/.test(k),e=[b.getSassCommonURL("skins/oasis/css/core/ArticleComments.scss")],h=b("#WikiaArticleComments");var g=function(){return h.offset().top>=(d.scrollTop()+d.height())};if(c.miniEditorEnabled){e.push(b.getSassCommonURL("extensions/wikia/MiniEditor/css/MiniEditor.scss"));e.push(b.getSassCommonURL("extensions/wikia/MiniEditor/css/ArticleComments/ArticleComments.scss"))}var l=function(){b.when(b.getResources(e),b.nirvana.sendRequest({controller:"ArticleCommentsController",method:"Content",format:"html",type:"GET",data:{articleId:a.wgArticleId,page:h.data("page"),skin:true},callback:function(m){f=m}})).then(function(){h.removeClass("loading").html(f);c.init();if(j){c.scrollToElement(k)}})};if(!j&&g()){d.on("scrollstop.ArticleCommentsLoadOnDemand",function(m){if(!g()){d.off("scrollstop.ArticleCommentsLoadOnDemand");l()}})}else{l()}})}else{wgAfterContentAndJS.push(c.init)}a.ArticleComments=c})(this,jQuery);window.onFBloaded=function(){var b=window.fbAppId,a=window.location.protocol+"//"+window.location.host+window.wgScriptPath+"/channel.php?lang="+encodeURIComponent(window.fbScriptLangCode);if(window.fbAppInit){return}else{if(typeof b!="string"){$().log("FB","appId is empty!");return}}FB.init({appId:b,oauth:true,status:true,cookie:true,xfbml:window.fbUseMarkup,channelUrl:a});if(typeof GlobalTriggers!="undefined"){GlobalTriggers.fire("fbinit")}window.fbAppInit=true};$(function(){$("#pt-fbconnect,#pt-fblink,#pt-fbconvert").addClass("mw-fblink");$("#pt-fblogout").click(function(){var g=confirm("You are logging out of both this site and Facebook.");if(g){FB.logout(function(h){window.location=window.fbLogoutURL})}});$("#fbconnect a").on("click",function(g){loginByFBConnect();g.preventDefault()});if($.getUrlVar("ref")==="fbfeed"){var c="",b=$.getUrlVar("fbtype");if(b!==""){c="/"+b}}if(skin=="oasis"){var f=null,a=false,e=$("#WikiaPageHeader .likes :first-child");var d=function(){if(e.children("span").filter(":visible").length>1){}else{if(!a){clearInterval(f)}}};$("#WikiaPageHeader .likes").hover(function(){a=true;f=setInterval(d,250)},function(){a=false;if(e.children("span").filter(":visible").length<2){clearInterval(f)}})}});function sendToConnectOnLogin(){sendToConnectOnLoginForSpecificForm("")}function sendToConnectOnLoginForSpecificForm(a){FB.getLoginStatus(function(b){if(a!=""){a="/"+a}var c=wgServer+wgScript+"?title=Special:Connect"+a+"&returnto="+encodeURIComponent(window.fbReturnToTitle||wgPageName)+"&returntoquery="+encodeURIComponent(window.wgPageQuery||"");if(a=="/ConnectExisting"){window.location.href=c;return}$("#fbConnectModalWrapper").remove();$.postJSON(window.wgScript+"?action=ajax&rs=SpecialConnect::checkCreateAccount&cb="+wgStyleVersion,function(d){if(d.status=="ok"){$().getModal(window.wgScript+"?action=ajax&rs=SpecialConnect::ajaxModalChooseName&returnto="+encodeURIComponent(wgPageName)+"&returntoquery="+encodeURIComponent(window.wgPageQuery||""),"#fbConnectModal",{id:"fbConnectModalWrapper",width:600})}else{window.location.href=c}})})}function openFbLogin(){FB.login(sendToConnectOnLogin,{scope:"publish_stream"})}function loginByFBConnect(){openFbLogin();return false}function fixXFBML(a){if(typeof $.browser.msie!="undefined"&&typeof $.browser.version!="undefined"&&$.browser.version&&$.browser.version.substring(0,$.browser.version.indexOf("."))<9){GlobalTriggers.bind("fbinit",function(){var c=$("#"+a).parent(),b=c.html();c.html("").append(b);FB.XFBML.parse(c.get(0))})}}$(function(){if(window.wgCanonicalSpecialPageName==="Connect"){$.loadFacebookAPI(function(){fixXFBML("fbSpecialConnect")})}});var GlobalNotification={init:function(){GlobalNotification.dom=$(".global-notification");if(GlobalNotification.dom.length){GlobalNotification.setUpClose()}this.wikiaHeaderHeight=$("#WikiaHeader").height()},options:{notify:"blue",confirm:"green",error:"red",warn:"yellow"},createDom:function(a){if(!GlobalNotification.dom.length){GlobalNotification.dom=$('<div class="global-notification"><button class="close wikia-chiclet-button"><img src="'+window.stylepath+'/oasis/images/icon_close.png"></button><div class="msg"></div></div>').hide();GlobalNotification.setUpClose()}if(a instanceof jQuery){a.prepend(GlobalNotification.dom).show()}else{if(GlobalNotification.isModal()){GlobalNotification.modal.prepend(GlobalNotification.dom)}else{if($(".oasis-split-skin").length){$(".WikiaHeader").after(GlobalNotification.dom)}else{$(".WikiaPageContentWrapper").prepend(GlobalNotification.dom)}}}GlobalNotification.msg=GlobalNotification.dom.find(".msg")},show:function(c,b,a,d){GlobalNotification.content=c;var e=function(){GlobalNotification.createDom(a);GlobalNotification.msg.html(GlobalNotification.content);GlobalNotification.dom.removeClass("confirm, error, notify, warn").addClass(b);if(window.WikiaFooterApp){WikiaFooterApp.addScrollEvent()}GlobalNotification.dom.fadeIn("slow");if(typeof d==="number"){setTimeout(function(){GlobalNotification.hide()},d)}};GlobalNotification.hide(e)},hide:function(a){if(!GlobalNotification.dom){return}if(GlobalNotification.dom.length){GlobalNotification.dom.animate({height:0,padding:0,opacity:0},400,function(){GlobalNotification.dom.remove();GlobalNotification.dom=[];if(jQuery.isFunction(a)){a()}})}else{if(jQuery.isFunction(a)){a()}}},isModal:function(){GlobalNotification.modal=$(".modalWrapper, .yui-panel");if(GlobalNotification.modal.length>0&&GlobalNotification.modal.is(":visible")){return true}return false},setUpClose:function(){GlobalNotification.dom.find(".close").click(GlobalNotification.hide)},onScroll:function(a){if(GlobalNotification.dom&&GlobalNotification.dom.length){var b=GlobalNotification.wikiaHeaderHeight;if(a>b){GlobalNotification.dom.addClass("float")}else{GlobalNotification.dom.removeClass("float")}}}};$(function(){GlobalNotification.init()});if(typeof wgAjaxFailureMsg!=="undefined"){$(document).ajaxError(function(){GlobalNotification.show(window.wgAjaxFailureMsg,"error")})}var GlobalModal={init:function(){var a=$.getUrlVar("modal");if(a){var b=GlobalModal["show"+a];if(typeof b==="function"){b()}}},showUploadImage:function(){if(!wgUserName){$(".ajaxLogin").trigger("click")}else{$(".upphotos").trigger("click")}},showAddPage:function(){if(!wgUserName){$(".ajaxLogin").trigger("click")}else{$(".createpage").trigger("click")}},showLogin:function(){if(!wgUserName){$(".ajaxLogin").trigger("click")}},showAdopt:function(){$.when($.getResources([$.getSassCommonURL("/extensions/wikia/AutomaticWikiAdoption/css/AutomaticWikiAdoption.scss")]),$.nirvana.sendRequest({controller:"AutomaticWikiAdoption",method:"AdoptWelcomeDialog",format:"html",type:"get",data:{cb:wgCurRevisionId}})).then(function(c,a){var b=a[0];$(b).makeModal({width:500,height:400})})}};$(function(){GlobalModal.init()});var UserLogin={forceLoggedIn:false,refreshIfAfterForceLogin:function(){if(this.forceLoggedIn){Wikia.Querystring().addCb().goTo()}},rteForceLogin:function(){if(!window.wgComboAjaxLogin){window.onbeforeunload=function(){};UserLoginModal.show({persistModal:true,callback:function(){window.WikiaEditor&&WikiaEditor.reloadEditor()}})}else{showComboAjaxForPlaceHolder("",false,"",false,true)}},isForceLogIn:function(){if(wgUserName==null){window.onbeforeunload=function(){};if(!window.wgComboAjaxLogin){UserLoginModal.show();return true}else{if(showComboAjaxForPlaceHolder("",false,"",false,true)){return true}}}return false}};if(window.wgEnableKruxTargeting){$(window).load(function(){window.AdEngine_loadKruxLater(Krux)})}var WikiaBar={WIKIA_BAR_BOXAD_NAME:"WIKIA_BAR_BOXAD_1",WIKIA_BAR_STATE_ANON_ML_KEY:"AnonMainLangWikiaBar_0.0001",WIKIA_BAR_STATE_ANON_NML_KEY:"AnonNotMainLangWikiaBar_0.0001",WIKIA_BAR_HIDDEN_ANON_ML_TTL:24*60*1000,WIKIA_BAR_HIDDEN_ANON_NML_TTL:180*24*60*1000,WIKIA_BAR_STATE_USER_KEY_SUFFIX:"UserWikiaBar_1.0004",WIKIA_BAR_MAX_MESSAGE_PARTS:5,WIKIA_BAR_SAMPLING_RATIO:10,WIKIA_BAR_SHOWN_STATE_VALUE:"shown",WIKIA_BAR_HIDDEN_STATE_VALUE:"hidden",cutMessagePrecision:20,messageConfig:{index:0,container:null,attributeName:"wikiabarcontent",content:null,speed:500,delay:10000,prevMsgNumber:-1,doTrackImpression:false},wikiaBarHidden:true,wikiaBarWrapperObj:null,wikiaBarCollapseWrapperObj:null,isSampledEvent:function(){return this.WIKIA_BAR_SAMPLING_RATIO>=Math.floor((Math.random()*100+1))},bindTracking:function(){this.wikiaBarWrapperObj.click($.proxy(this.clickTrackingHandler,this));this.wikiaBarCollapseWrapperObj.click($.proxy(this.clickTrackingHandler,this))},init:function(){this.$window=$(window);this.wikiaBarWrapperObj=$("#WikiaBarWrapper");this.wikiaBarCollapseWrapperObj=$(".WikiaBarCollapseWrapper");this.bindTracking();var a=this.wikiaBarWrapperObj.find(".arrow");a.click($.proxy(this.onShownClick,this));this.wikiaBarCollapseWrapperObj.find(".wikia-bar-collapse").click($.proxy(this.onHiddenClick,this));if(!this.isUserAnon()){this.handleLoggedInUsersWikiaBar()}else{if(this.isUserAnon()&&this.hasAnonHiddenWikiaBar()===false){this.handleLoggedOutUsersWikiaBar()}}a.popover({placement:"wikiaBar",content:a.data("tooltip")});$(".wikia-bar-collapse").popover({placement:"wikiaBar",content:a.data("tooltipshow")});this.$window.triggerHandler("WikiaBarReady");return true},getAdIfNeeded:function(){var a=$("#"+this.WIKIA_BAR_BOXAD_NAME);if(a.hasClass("wikia-ad")==false&&window.wgShowAds&&window.wgAdsShowableOnPage&&window.wgEnableWikiaBarAds){window.adslots2.push([this.WIKIA_BAR_BOXAD_NAME,null,"AdEngine2",null]);a.addClass("wikia-ad")}},cutMessageIntoSmallPieces:function(l,a,j){var k=[],g,c,f,h,b=0;for(var e=0,d=l.length;e<d;e++){h=l[e].text;if(typeof h=="string"){c=h.split("");do{g=this.checkMessageWidth(c,a,j);f=c.slice(g.length,c.length);k.push({anchor:$.trim(g.join("")),href:l[e].href,messageNumber:e});c=f;b++}while(f.length>0&&b<this.WIKIA_BAR_MAX_MESSAGE_PARTS)}}a.text("");return k},checkMessageWidth:function(h,a,g){var k="",l,e,f=-1;for(var c=0,b=h.length;c<b;c+=g){k=k+h.join("").substr(c,g);l=$("<span></span>").text(k);a.html(l);if(l.width()>=this.messageConfig.container.width()){f=c-g;break}}if(f==-1){e=h}else{e=h.slice(0,f);var d=e.lastIndexOf(" ");if((d>-1)&&(d<f)){e=h.slice(0,d)}}return e},messageFadeIn:function(){var a=this.messageConfig.index,b=this.messageConfig;if(a==(b.content.length-1)){this.messageConfig.index=0}else{this.messageConfig.index++}setTimeout($.proxy(this.messageSlideShow,this),b.delay);return true},messageSlideShow:function(){var b=this.messageConfig.content[this.messageConfig.index],c=this.messageConfig.container,a=$("<a></a>").attr("href",b.href).data("index",b.messageNumber).text(b.anchor);c.fadeOut(this.messageConfig.speed,$.proxy(function(){c.html(a);if(this.messageConfig.prevMsgNumber!=b.messageNumber){this.messageConfig.prevMsgNumber=b.messageNumber;this.messageConfig.doTrackImpression=true}else{this.messageConfig.doTrackImpression=false}c.fadeIn(this.messageConfig.speed,$.proxy(this.messageFadeIn,this))},this));return true},startSlideShow:function(){this.messageConfig.content=this.cutMessageIntoSmallPieces(this.messageConfig.container.data(this.messageConfig.attributeName),this.messageConfig.container,this.cutMessagePrecision);if(typeof this.messageConfig.content=="object"){this.messageConfig.container.popover({placement:"wikiaBarMessage",content:this.messageConfig.container.data("messagetooltip")});this.messageSlideShow()}},show:function(){$("#WikiaNotifications").removeClass("hidden");this.wikiaBarCollapseWrapperObj.addClass("hidden");this.wikiaBarWrapperObj.removeClass("hidden");this.wikiaBarHidden=false},hide:function(){$("#WikiaNotifications").addClass("hidden");this.wikiaBarCollapseWrapperObj.removeClass("hidden");this.wikiaBarWrapperObj.addClass("hidden");this.wikiaBarHidden=true},isWikiaBarHidden:function(){return this.wikiaBarHidden},onShownClick:function(a){this.changeBarStateData();a.preventDefault()},onHiddenClick:function(a){this.changeBarStateData();a.preventDefault()},changeBarStateData:function(){if(this.isUserAnon()){this.changeAnonBarStateData()}else{this.changeLoggedInUserStateBar()}this.$window.triggerHandler("WikiaBarStateChanged")},changeAnonBarStateData:function(){var a=this.hasAnonHiddenWikiaBar();if(a===false){this.setCookieData(true);this.hide()}else{this.setCookieData(false);this.getAdIfNeeded();this.show()}},hasAnonHiddenWikiaBar:function(){return this.getAnonData()},handleLoggedOutUsersWikiaBar:function(){this.show();this.messageConfig.container=this.wikiaBarWrapperObj.find(".message");var a=this.messageConfig.container.data(this.messageConfig.attributeName);if(this.messageConfig.container.exists()&&a&&(typeof a=="object")&&(a.length>0)){this.startSlideShow()}this.getAdIfNeeded()},handleLoggedInUsersWikiaBar:function(){var a=this.getLocalStorageData();if(a===null){this.getLoggedInUserStateBarAndChangeLocalStorage()}else{this.doWikiaBarAnimationDependingOnState(a)}},getLoggedInUserStateBarAndChangeLocalStorage:function(){$.nirvana.sendRequest({controller:"WikiaUserPropertiesController",method:"performPropertyOperation",data:{handlerName:"WikiaBarUserPropertiesHandler",methodName:"getWikiaBarState"},type:"get",format:"json",callback:$.proxy(this.onGetLoggedInUserStateBarAndChangeLocalStorage,this),onErrorCallback:$.proxy(this.onGetLoggedInUserStateBarAndChangeLocalStorageError,this)})},changeLoggedInUserStateBar:function(){var a=this.isWikiaBarHidden()?this.WIKIA_BAR_SHOWN_STATE_VALUE:this.WIKIA_BAR_HIDDEN_STATE_VALUE;this.doWikiaBarAnimationDependingOnState(a);this.setLocalStorageData(a);$.nirvana.sendRequest({controller:"WikiaUserPropertiesController",method:"performPropertyOperation",data:{handlerName:"WikiaBarUserPropertiesHandler",methodName:"changeWikiaBarState",callParams:{changeTo:a}},type:"post",format:"json"})},onGetLoggedInUserStateBarAndChangeLocalStorage:function(a){var b=a.results.propertyValue||this.WIKIA_BAR_SHOWN_STATE_VALUE;this.setLocalStorageData(b);this.doWikiaBarAnimationDependingOnState(b)},onGetLoggedInUserStateBarAndChangeLocalStorageError:function(){},doWikiaBarAnimationDependingOnState:function(c){if(c===this.WIKIA_BAR_SHOWN_STATE_VALUE){this.show()}else{this.hide()}if(window.wgAction=="edit"){var b=window.WikiaEditor=window.WikiaEditor||(new Observable()),a=b.getInstance();if(typeof(a)!=="undefined"){a.fire("sizeChanged")}}},getLocalStorageDataKey:function(){var a=undefined;if(window.wgUserName){a=window.wgUserName+"_"+this.WIKIA_BAR_STATE_USER_KEY_SUFFIX}else{$().log("WikiaBar notice: No user name found")}return a},getLocalStorageData:function(){return $.storage.get(this.getLocalStorageDataKey())},setLocalStorageData:function(a){$.storage.set(this.getLocalStorageDataKey(),a)},getAnonData:function(a){var b=this.getCookieKey(),d=$.cookie(b),c=null;if(d===null&&!this.isMainWikiaBarLang()){c=(typeof a!=="undefined")?a:true}else{if(d===null&&this.isMainWikiaBarLang()){c=(typeof a!=="undefined")?a:false}else{c=(d==="true")}}return c},setCookieData:function(e){var d=this.getCookieKey(),c=new Date(),a=new Date(c.getTime()+this.WIKIA_BAR_HIDDEN_ANON_ML_TTL),b={expires:a,path:"/",domain:window.wgCookieDomain};if(this.isUserAnon()&&!this.isMainWikiaBarLang()){b.expires=this.WIKIA_BAR_HIDDEN_ANON_NML_TTL}else{if(!this.isUserAnon){b.expires=this.WIKIA_BAR_HIDDEN_USER_TTL}}$.cookie(d,e,b)},getCookieKey:function(){var a=this.WIKIA_BAR_STATE_ANON_ML_KEY;if(this.isUserAnon()&&!this.isMainWikiaBarLang()){a=this.WIKIA_BAR_STATE_ANON_NML_KEY}return a},isUserAnon:function(){return(window.wgUserName===null)},isMainWikiaBarLang:function(){var a=-1;if(window.wgContentLanguage&&window.wgWikiaBarMainLanguages){a=$.inArray(window.wgContentLanguage,window.wgWikiaBarMainLanguages)}return(a>=0)},getWikiaBarOffset:function(){var a=$("#WikiaBarWrapper").outerHeight(true)||0;return(this.wikiaBarHidden)?0:a},trackClick:function(c,e,a,d,f,b){if(this.isSampledEvent()){Wikia.Tracker.track({action:e,category:c,label:a,trackingMethod:"ga",value:d},f)}},clickTrackingHandler:function(g){var d=$(g.target),c=d.parent(),b=new Date();if(d.hasClass("arrow")){this.trackClick("wikia-bar",Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,"arrow-hide",null,{},g)}else{if(d.hasClass("wikia-bar-collapse")){this.trackClick("wikia-bar",Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,"arrow-show",null,{},g)}else{if(c.hasClass("wikiabar-button")){var f=c.data("index");this.trackClick("wikia-bar",Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,"wikiabar-button-"+f,null,{},g)}else{if(c.hasClass("message")){var a=d.data("index");this.trackClick("wikia-bar",Wikia.Tracker.ACTIONS.CLICK_LINK_TEXT,"message-"+a+"-clicked",null,{},g)}}}}$().log("tracking took "+(new Date()-b)+" ms")}};if(window.wgEnableWikiaBarExt){$(function(){WikiaBar.init();group=window.Wikia.AbTest?Wikia.AbTest.getGroup("DAR_GLOBALNAVIGATIONFIXED"):null;switch(group){case"HIDE_WIKIA_BAR":if(WikiaBar&&WikiaBar.isUserAnon()&&WikiaBar.getAnonData(false)===false){WikiaBar.hide()}case"SHOW_WIKIA_BAR":$("body").addClass("global-header-fixed-at-top");break;default:}})}var ChatEntryPoint={loading:false,chatLaunchModal:null,bindComplete:false,init:function(){if(!ChatEntryPoint.bindComplete){$("body").on("click",".WikiaChatLink",function(a){a.preventDefault();a.stopPropagation();ChatEntryPoint.onClickChatButton(this.href)});ChatEntryPoint.bindComplete=true}if(window.wgWikiaChatUsers){ChatEntryPoint.initEntryPoint()}else{if(!ChatEntryPoint.loading){ChatEntryPoint.loading=true;ChatEntryPoint.loadChatUsers()}}},loadChatUsers:function(){$.nirvana.sendRequest({controller:"ChatRailController",method:"GetUsers",type:"GET",format:"json",callback:function(a){window.wgWikiaChatUsers=a.users;ChatEntryPoint.initEntryPoint()}})},initEntryPoint:function(){if(typeof window.wgWikiaChatUsers==="string"){window.wgWikiaChatUsers=window.wgWikiaChatUsers.length?JSON.parse(window.wgWikiaChatUsers):[]}$(".ChatModuleUninitialized").each(function(){ChatEntryPoint.processModuleTemplate($(this));$(this).removeClass("ChatModuleUninitialized")})},processModuleTemplate:function(g){var b=[],e,d=window.wgWikiaChatUsers.length,a=window.wgWikiaChatProfileAvatarUrl;g.find(".chat-contents").addClass((d)?"chat-room-active":"chat-room-empty").addClass((window.wgUserName)?"chat-user-logged-in":"chat-user-anonymous");g.find(".chat-total").html(d);g.find("p.chat-name").html(window.wgSiteName);if(!window.wgUserName){g.find("div.chat-join button").addClass("loginToChat")}g.find("div.chat-join button").attr("data-msg-id",d?"chat-join-the-chat":"chat-start-a-chat");if(d){var c=g.find("ul.carousel");var f=c.find(">li");for(e=0;e<d;e++){b.push(ChatEntryPoint.fillUserTemplate(f.clone(),window.wgWikiaChatUsers[e]))}c.html(b);ChatEntryPoint.initCarousel(g.find(".chat-whos-here"))}else{g.find("ul.carousel").remove()}if(a){g.find(".carousel-container img.avatar.currentUser").attr("src",a)}else{g.find(".carousel-container img.avatar.currentUser").remove()}g.find("[data-msg-id]").each(function(){var h=$(this);h.html($.msg(h.data("msg-id"),h.data("msg-param")))})},fillUserTemplate:function(c,b){if(b.showSince){var a=window.wgWikiaChatMonts||window.wgMonthNamesShort;b.since=a[b.since_month]+" "+b.since_year}c.find("[data-user-prop]").each(function(){var f=$(this),d=f.data("user-attr"),g=f.data("user-prop"),e=b[g];if(typeof e==="undefined"){f.remove()}else{if(d){f.attr(d,e)}else{f.html(e)}}});return c},initCarousel:function(b){b.find(".carousel-container").carousel({nextClass:"arrow-right",prevClass:"arrow-left",itemsShown:(window.wgOasisResponsive)?5:6});var c=0;function a(d){c=setTimeout(function(){d.popover("hide")},300)}b.find(".chatter").popover({trigger:"manual",placement:"bottom",content:function(){var d=$(this).find(".UserStatsMenu");return d.clone().wrap("<div>").parent().html()}}).on("mouseenter",function(){clearTimeout(c);$(".popover").remove();$(this).popover("show")}).on("mouseleave",function(){var d=$(this);a(d);$(".popover").mouseenter(function(){clearTimeout(c)}).mouseleave(function(){a(d)})})},onClickChatButton:function(a){if(window.wgUserName){window.open(a,"wikiachat",window.wgWikiaChatWindowFeatures)}else{UserLoginModal.show({persistModal:true,callback:ChatEntryPoint.onSuccessfulLogin})}},onSuccessfulLogin:function(a){UserLoginModal.dialog.startThrobbing();$.nirvana.sendRequest({controller:"ChatRail",method:"AnonLoginSuccess",type:"GET",format:"html",callback:ChatEntryPoint.onJoinChatFormLoaded})},onJoinChatFormLoaded:function(a){UserLoginModal.dialog.stopThrobbing();UserLoginModal.dialog.closeModal();require(["wikia.ui.factory"],function(b){b.init("modal").then(function(d){var c="JoinChatModal",e=d.render({type:"default",vars:{id:c,size:"small",content:a,title:$.msg("chat-start-a-chat"),closeButton:true,closeText:$.msg("close")}});require(["wikia.ui.modal"],function(f){ChatEntryPoint.chatLaunchModal=f.init(c,e);ChatEntryPoint.chatLaunchModal.show();$("#modal-join-chat-button").bind("click",ChatEntryPoint.launchChatWindow);ChatEntryPoint.chatLaunchModal.onClose=function(){ChatEntryPoint.reloadPage()}})})})},reloadPage:function(){Wikia.Querystring().addCb().goTo()},launchChatWindow:function(b){var a=$("#modal-join-chat-button").data("chat-page");window.open(a,"wikiachat",window.wgWikiaChatWindowFeatures);if(ChatEntryPoint.chatLaunchModal){ChatEntryPoint.chatLaunchModal.close()}ChatEntryPoint.reloadPage()}};if(typeof wgWikiaChatUsers!=="undefined"){$(function(){ChatEntryPoint.init()})}(function(g,e){var f=g("#RelatedForumDiscussion"),c=f.find(".forum-content"),h=g(e);if(f.exists()){f.find(".button.forum-new-post").tooltip();function d(){return f.offset().top>(h.scrollTop()+(h.height()*3))}var b=function(){f.find(".forum-timestamp").timeago()};if(!e.wgUserName){function a(){g.nirvana.sendRequest({controller:"RelatedForumDiscussionController",method:"checkData",format:"json",data:{articleId:e.wgArticleId?e.wgArticleId:0},callback:function(j){if(j&&j.replace){c.html(j.html)}c.removeClass("forum-invisible");b()}})}if(!d()){a()}else{h.on("scrollstop.RelatedForumDiscussion",function(){if(!d()){h.off("scrollstop.RelatedForumDiscussion");a()}})}}else{b()}}})(jQuery,window);(function(d,f){if(d.VET_loader){return}var b=false,e=false,a="",c={};c.load=function(j,k){if(wgUserName==null&&wgAction=="edit"){UserLogin.rteForceLogin();k&&k.stopThrobbing();return}else{if(wgUserName==null){UserLoginModal.show({callback:function(){UserLogin.forceLoggedIn=true;d.VET_loader.load(j)}});k&&k.stopThrobbing();return}}if(e){k&&k.stopThrobbing();return}e=true;var m=[];if(!b){var l=f.Deferred(),g=f.Deferred();f.nirvana.sendRequest({controller:"VideoEmbedToolController",method:"modal",type:"get",format:"html",callback:function(n){a=n;l.resolve()}});m.push(l);var h=f.getResources([f.getAssetManagerGroupUrl("VET_js"),f.getSassCommonURL("/extensions/wikia/VideoEmbedTool/css/VET.scss"),f.getSassCommonURL("/extensions/wikia/WikiaStyleGuide/css/Dropdown.scss")]);m.push(h)}f.when.apply(this,m).done(function(){k&&k.stopThrobbing();require(["wikia.vet"],function(n){c.modal=f(a).makeModal({width:939,onClose:function(){n.close()},onAfterClose:function(){e=false}});n.show(j);b=true})})};f.fn.addVideoButton=function(g){f.preloadThrobber();return this.each(function(){var h=f(this);h.off("click.VETLoader").on("click.VETLoader",function(j){j.preventDefault();h.startThrobbing();c.load(g,h)})})};d.VET_loader=c})(window,jQuery);(function(a){function b(d){function c(l){var m=(l.type||"POST").toUpperCase(),o=(l.format||"json").toLowerCase(),j=l.data||{},q=l.callback||function(){},f=l.onErrorCallback||function(){},e,n;if((typeof l.controller==="undefined")||(typeof l.method==="undefined")){throw"controller and method are required"}if(!(o==="json"||o==="html"||o==="jsonp")){throw"Only Json,Jsonp and Html format are allowed"}e=l.scriptPath||a.wgServer+a.wgScriptPath;n={controller:l.controller.replace(/Controller$/,""),method:l.method};if(m==="POST"){n.format=o}else{if(typeof j=="string"){j+="&format="+o}else{j.format=o}}var k;if(typeof j=="string"){k=j}else{var g=[];for(var p in j){g[g.length]=p}g.sort();k={};for(var h=0;h<g.length;h++){k[g[h]]=j[g[h]]}}return d.ajax({url:e+"/wikia.php?"+d.param(n),dataType:o,type:m,data:k,success:q,error:f})}return{sendRequest:c,getJson:function(e,j,g,h,f){if(typeof g=="function"){f=h;h=g;g={}}return c({controller:e,method:j,data:g,type:"GET",callback:h,onErrorCallback:f})},postJson:function(e,j,g,h,f){if(typeof g=="function"){f=h;h=g;g={}}return c({controller:e,method:j,data:g,callback:h,onErrorCallback:f})}}}if(a.define&&a.define.amd){a.define("wikia.nirvana",["jquery"],b)}if(a.jQuery){a.jQuery.nirvana=b(a.jQuery)}}(this));define("wikia.ui.factory",["wikia.nirvana","wikia.window","wikia.loader","wikia.ui.component","jquery"],function uifactory(f,c,g,d,b){function a(l){var k=new b.Deferred(),m={components:l,cb:c.wgStyleVersion};f.getJson("Wikia\\UI\\UIFactoryApi","getComponentsConfig",m,function(n){k.resolve(n)},function(n){k.reject(JSON.parse(n.responseText))});return k.promise()}function h(){return new d}function e(n){var m={},l=[];for(var k=0;k<n.length;k++){if(m.hasOwnProperty(n[k])){continue}l.push(n[k]);m[n[k]]=1}return l}function j(k){var l=new b.Deferred(),m=[];if(!(k instanceof Array)){k=[k]}a(k).done(function(o){var n=[],q=[];o.components.forEach(function(t){var r=h(),v=t.templateVarsConfig,u=t.assets,s=t.templates;if(u){n=n.concat(u.js);q=q.concat(u.css)}if(v&&s){r.setComponentsConfig(s,v)}m.push(r)});n=e(n);q=e(q);g({type:g.CSS,resources:q});function p(){l.resolve.apply(null,m)}if(n.length>0){g({type:g.JS,resources:n}).done(p)}else{p()}}).fail(function(n){if(n.error){throw new Error(n.error+": "+n.message)}l.reject()});return l.promise()}return{init:j}});
/*
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(x){x.name="mustache.js";x.version="0.5.0-dev";x.tags=["{{","}}"];x.parse=n;x.compile=e;x.render=w;x.clearCache=v;x.to_html=function(B,z,A,C){var y=w(B,z,A);if(typeof C==="function"){C(y)}else{return y}};var t=Object.prototype.toString;var f=Array.isArray;var b=Array.prototype.forEach;var g=String.prototype.trim;var j;if(f){j=f}else{j=function(y){return t.call(y)==="[object Array]"}}var s;if(b){s=function(z,A,y){return b.call(z,A,y)}}else{s=function(B,C,A){for(var z=0,y=B.length;z<y;++z){C.call(A,B[z],z,B)}}}var l=/^\s*$/;function c(y){return l.test(y)}var q;if(g){q=function(y){return y==null?"":g.call(y)}}else{var o,h;if(c("\xA0")){o=/^\s+/;h=/\s+$/}else{o=/^[\s\xA0]+/;h=/[\s\xA0]+$/}q=function(y){return y==null?"":String(y).replace(o,"").replace(h,"")}}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function p(y){return String(y).replace(/&(?!\w+;)|[<>"']/g,function(z){return d[z]||z})}function m(E,G,H,A){A=A||"<template>";var I=G.split("\n"),y=Math.max(H-3,0),B=Math.min(I.length,H+3),z=I.slice(y,B);var F;for(var C=0,D=z.length;C<D;++C){F=C+y+1;z[C]=(F===H?" >> ":"    ")+z[C]}E.template=G;E.line=H;E.file=A;E.message=[A+":"+H,z.join("\n"),"",E.message].join("\n");return E}function u(y,G,F){if(y==="."){return G[G.length-1]}var E=y.split(".");var C=E.length-1;var D=E[C];var H,z,B=G.length,A,I;while(B){I=G.slice(0);z=G[--B];A=0;while(A<C){z=z[E[A++]];if(z==null){break}I.push(z)}if(z&&typeof z==="object"&&D in z){H=z[D];break}}if(typeof H==="function"){H=H.call(I[I.length-1])}if(H==null){return F}return H}function k(B,y,F,A){var z="";var D=u(B,y);if(A){if(D==null||D===false||(j(D)&&D.length===0)){z+=F()}}else{if(j(D)){s(D,function(G){y.push(G);z+=F();y.pop()})}else{if(typeof D==="object"){y.push(D);z+=F();y.pop()}else{if(typeof D==="function"){var C=y[y.length-1];var E=function(G){return w(G,C)};z+=D.call(C,F(),E)||""}else{if(D){z+=F()}}}}}return z}function n(aa,C){C=C||{};var L=C.tags||x.tags,M=L[0],H=L[L.length-1];var z=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var G=[],ab=false,Y=false;var W=function(){if(ab&&!Y&&!C.space){while(G.length){z.splice(G.pop(),1)}}else{G=[]}ab=false;Y=false};var T=[],Q,D,N;var V=function(ac){L=q(ac).split(/\s+/);D=L[0];N=L[L.length-1]};var K=function(ac){z.push('";',Q,'\nvar partial = partials["'+q(ac)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')};var y=function(ae,ac){var ad=q(ae);if(ad===""){throw m(new Error("Section name may not be empty"),aa,J,C.file)}T.push({name:ad,inverted:ac});z.push('";',Q,'\nvar name = "'+ad+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')};var F=function(ac){y(ac,true)};var U=function(ad){var ac=q(ad);var af=T.length!=0&&T[T.length-1].name;if(!af||ac!=af){throw m(new Error('Section named "'+ac+'" was never opened'),aa,J,C.file)}var ae=T.pop();z.push('";',"\n    return buffer;","\n  };","\n})();");if(ae.inverted){z.push("\nbuffer += renderSection(name,stack,callback,true);")}else{z.push("\nbuffer += renderSection(name,stack,callback);")}z.push('\nbuffer += "')};var X=function(ac){z.push('";',Q,'\nbuffer += lookup("'+q(ac)+'",stack,"");','\nbuffer += "')};var A=function(ac){z.push('";',Q,'\nbuffer += escapeHTML(lookup("'+q(ac)+'",stack,""));','\nbuffer += "')};var J=1,Z,E;for(var R=0,S=aa.length;R<S;++R){if(aa.slice(R,R+M.length)===M){R+=M.length;Z=aa.substr(R,1);Q="\nline = "+J+";";D=M;N=H;ab=true;switch(Z){case"!":R++;E=null;break;case"=":R++;H="="+H;E=V;break;case">":R++;E=K;break;case"#":R++;E=y;break;case"^":R++;E=F;break;case"/":R++;E=U;break;case"{":H="}"+H;case"&":R++;Y=true;E=X;break;default:Y=true;E=A}var B=aa.indexOf(H,R);if(B===-1){throw m(new Error('Tag "'+M+'" was not closed properly'),aa,J,C.file)}var P=aa.substring(R,B);if(E){E(P)}var O=0;while(~(O=P.indexOf("\n",O))){J++;O++}R=B+H.length-1;M=D;H=N}else{Z=aa.substr(R,1);switch(Z){case'"':case"\\":Y=true;z.push("\\"+Z);break;case"\r":break;case"\n":G.push(z.length);z.push("\\n");W();J++;break;default:if(c(Z)){G.push(z.length)}else{Y=true}z.push(Z)}}}if(T.length!=0){throw m(new Error('Section "'+T[T.length-1].name+'" was not closed properly'),aa,J,C.file)}W();z.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var I=z.join("").replace(/buffer \+= "";\n/g,"");if(C.debug){if(typeof console!="undefined"&&console.log){console.log(I)}else{if(typeof print==="function"){print(I)}}}return I}function r(C,A){var z="view,partials,stack,lookup,escapeHTML,renderSection,render";var y=n(C,A);var B=new Function(z,y);return function(E,F){F=F||{};var D=[E];try{return B(E,F,D,u,p,k,w)}catch(G){throw m(G.error,C,G.line,A.file)}}}var a={};function v(){a={}}function e(z,y){y=y||{};if(y.cache!==false){if(!a[z]){a[z]=r(z,y)}return a[z]}return r(z,y)}function w(A,y,z){return e(A)(y,z)}})(Mustache);(function(a){a.Mustache=Mustache;if(a.define&&a.define.amd){a.define("wikia.mustache",Mustache)}}(window));define("wikia.ui.component",["wikia.mustache"],function uicomponent(b){function c(e,f,h){var j=e.templates;if(!j.hasOwnProperty(f)){throw new Error("Requested component type is not supported!")}var d=e.templateVarsConfig[f].required,g=[];d.forEach(function(l){if(!h.hasOwnProperty(l)){g.push(l)}});if(g.length>0){var k=g.join(", ");throw new Error("Missing required mustache variables: "+k+"!")}}function a(){if(!(this instanceof a)){return new a}var d={},e,f;this.render=function(g){e=g.type;f=g.vars;c(d,e,f);return b.render(d.templates[e],f)};this.setComponentsConfig=function(g,h){d.templates=g;d.templateVarsConfig=h}}return a});


(function(window,document,location,$){'use strict';var modalId='ExitstitialInfobox',modalWidth=840,adSlot='EXIT_STITIAL_BOXAD_1',redirectDelay=window.wgOutboundScreenRedirectDelay||10,enabled=window.wgEnableOutboundScreenExt&&window.wgShowAds&&window.wgAdsShowableOnPage;if(!enabled){return;}
$(document).ready(function(){$('.WikiaArticle a.exitstitial').filter('.external, .extiw').click(function(event){event.preventDefault();var url=$(this).attr('href');$.getMessages('AdEngine',function(){var $goBack=$('<a></a>').attr('href','').text($.msg('adengine-exitstitial-go-back')),modalTitle=$.msg('adengine-exitstitial-title-template',window.wgSiteName),$modal,$modalBody=$('<div></div>'),$modalText=$('<p></p>').text($.msg('adengine-exitstitial-redirecting')+' '),$modalAd=$('<div class="ad-centered-wrapper"></div>'),$ad=$('<div class="wikia-ad noprint"></div>').attr('id',adSlot),$modalSkip=$('<div class="close-exitstitial-ad"></div>'),$skipAd=$('<a></a>').attr('href',url).text($.msg('adengine-exitstitial-button'));$modalText.append($goBack);$modalSkip.append($skipAd);$goBack.click(function(event){event.preventDefault();$modal.closeModal();});$modalBody.append($modalText).append($modalAd).append($modalSkip);$modal=$.showModal(modalTitle,$modalBody,{id:modalId,width:modalWidth});$modalAd.html($('<div></div>').html($ad));window.adslots2.push([adSlot]);setTimeout(function(){$skipAd.filter(':visible').each(function(){location.href=url;});},redirectDelay*1000);});});});}(window,document,location,jQuery));;var UserLoginFacebook={modal:false,form:false,callbacks:{},initialized:false,log:function(msg){$().log(msg,'UserLoginFacebook');},init:function(){if(!this.initialized){this.initialized=true;this.loginSetup();this.setupTooltips();$.loadFacebookAPI();this.log('init');}},setupTooltips:function(){$('.sso-login > a').tooltip();},loginSetup:function(){var self=this;$('body').off('fb').on('click.fb','.sso-login-facebook',function(ev){ev.preventDefault();FB.login($.proxy(self.loginCallback,self),{scope:'publish_stream,email'});});},loginCallback:function(response){if(typeof response==='object'&&response.status){this.log(response);switch(response.status){case'connected':this.log('FB.login successful');$.nirvana.postJson('FacebookSignupController','index',$.proxy(this.checkAccountCallback,this));break;case'unknown':break;}}},checkAccountCallback:function(resp){if(resp.loggedIn){var loginCallback=this.callbacks['login-success']||'';if(loginCallback&&typeof loginCallback==='function'){loginCallback();}else{require(['wikia.querystring'],function(qs){var qString=new qs(),returnto=(wgCanonicalSpecialPageName&&(wgCanonicalSpecialPageName.match(/Userlogin|Userlogout/)))?wgMainPageTitle:null;if(returnto){qString.setPath(wgArticlePath.replace('$1',returnto));}
qString.addCb().goTo();});}}
else{$.showCustomModal(resp.title,resp.modal,{id:'FacebookSignUp',width:710,buttons:[{id:'FacebookSignUpCancel',message:resp.cancelMsg,handler:$.proxy(function(){this.modal.closeModal();},this)}],callback:$.proxy(this.showSignupModal,this)});}},showSignupModal:function(modal){this.modal=modal;var loginCallback=this.callbacks['login-success']||'';this.form=new UserLoginFacebookForm(this.modal,{ajaxLogin:true,callback:function(res){if(loginCallback&&typeof loginCallback==='function'){loginCallback();}else if(res.location){window.location.href=res.location;}}});this.wikiaForm=this.form.wikiaForm;this.modal.find('.FacebookSignupConfigHeader').bind('click',function(ev){ev.preventDefault();$(this).toggleClass('on').next('form').toggle();});this.signupAjaxForm=new UserSignupAjaxForm(this.wikiaForm,null,this.form.el.find('input[type=submit]'));this.wikiaForm.el.find('input[name=username], input[name=password]').bind('blur.UserLoginFacebook',$.proxy(this.signupAjaxForm.validateInput,this.signupAjaxForm));$.getResources([$.getSassCommonURL('extensions/wikia/UserLogin/css/UserLoginFacebook.scss')]);},closeSignupModal:function(){if(this.modal){this.modal.closeModal();}}};;var UserLoginFacebookForm=$.createClass(UserLoginAjaxForm,{init:function(){UserLoginFacebookForm.superclass.init.call(this);var feedForm=this.form.parent().children('.FacebookSignupConfig');this.feedCheckboxes=feedForm.find('input[type="checkbox"]');},getFeedOptions:function(){var ret=[],feedName,feedOptions=this.feedCheckboxes.serializeArray();for(var i=0,len=feedOptions.length;i<len;i++){feedName=feedOptions[i].name.split('-').pop();ret.push(feedName);}
return ret;},retrieveLoginToken:function(){},ajaxLogin:function(){$.nirvana.postJson('FacebookSignupController','signup',{username:this.inputs.username.val(),password:this.inputs.password.val(),signupToken:this.inputs.logintoken.val(),fbfeedoptions:this.getFeedOptions().join(',')},$.proxy(this.submitLoginHandler,this));}});;var UserLoginDropdown={dropdown:false,loginAjaxForm:false,init:function(){this.dropdown=$("#UserLoginDropdown");$("#AccountNavigation .ajaxLogin").click($.proxy(function(ev){ev.preventDefault();ev.stopPropagation();this.show();},this)).closest('li').hover(function(e){e.preventDefault();UserLoginDropdown.hoverHandle=setTimeout(function(){UserLoginDropdown.show();},300);},function(e){clearTimeout(UserLoginDropdown.hoverHandle);});HoverMenuGlobal.menus.push(UserLoginDropdown);},show:function(){if(!this.dropdown.hasClass('show')){this.dropdown.addClass('show');if(!this.loginAjaxForm){this.loginAjaxForm=new UserLoginAjaxForm(this.dropdown);UserLoginFacebook.init();}
$('body').unbind('.loginDropdown').bind('click.loginDropdown',$.proxy(this.outsideClickHandler,this));}
this.loginAjaxForm.inputs['username'].focus();},hide:function(){this.dropdown.removeClass('show');$('body').unbind('.loginDropdown');},outsideClickHandler:function(e){var target=$(e.target);if(!target.closest('#AccountNavigation').exists()){this.hide();}},hideNav:function(){UserLoginDropdown.hide();}};$(function(){UserLoginDropdown.init();});;


var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(exports){exports.name="mustache.js";exports.version="0.5.0-dev";exports.tags=["{{","}}"];exports.parse=parse;exports.compile=compile;exports.render=render;exports.clearCache=clearCache;exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send==="function"){send(result);}else{return result;}};var _toString=Object.prototype.toString;var _isArray=Array.isArray;var _forEach=Array.prototype.forEach;var _trim=String.prototype.trim;var isArray;if(_isArray){isArray=_isArray;}else{isArray=function(obj){return _toString.call(obj)==="[object Array]";};}
var forEach;if(_forEach){forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope);};}else{forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i){callback.call(scope,obj[i],i,obj);}};}
var spaceRe=/^\s*$/;function isWhitespace(string){return spaceRe.test(string);}
var trim;if(_trim){trim=function(string){return string==null?"":_trim.call(string);};}else{var trimLeft,trimRight;if(isWhitespace("\xA0")){trimLeft=/^\s+/;trimRight=/\s+$/;}else{trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}
trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"");};}
var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;'};function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s;});}
function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end);var c;for(var i=0,len=context.length;i<len;++i){c=i+start+1;context[i]=(c===line?" >> ":"    ")+context[i];}
e.template=template;e.line=line;e.file=file;e.message=[file+":"+line,context.join("\n"),"",e.message].join("\n");return e;}
function lookup(name,stack,defaultValue){if(name==="."){return stack[stack.length-1];}
var names=name.split(".");var lastIndex=names.length-1;var target=names[lastIndex];var value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0);context=stack[--i];j=0;while(j<lastIndex){context=context[names[j++]];if(context==null){break;}
localStack.push(context);}
if(context&&typeof context==="object"&&target in context){value=context[target];break;}}
if(typeof value==="function"){value=value.call(localStack[localStack.length-1]);}
if(value==null){return defaultValue;}
return value;}
function renderSection(name,stack,callback,inverted){var buffer="";var value=lookup(name,stack);if(inverted){if(value==null||value===false||(isArray(value)&&value.length===0)){buffer+=callback();}}else if(isArray(value)){forEach(value,function(value){stack.push(value);buffer+=callback();stack.pop();});}else if(typeof value==="object"){stack.push(value);buffer+=callback();stack.pop();}else if(typeof value==="function"){var scope=stack[stack.length-1];var scopedRender=function(template){return render(template,scope);};buffer+=value.call(scope,callback(),scopedRender)||"";}else if(value){buffer+=callback();}
return buffer;}
function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1];var code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var spaces=[],hasTag=false,nonSpace=false;var stripSpace=function(){if(hasTag&&!nonSpace&&!options.space){while(spaces.length){code.splice(spaces.pop(),1);}}else{spaces=[];}
hasTag=false;nonSpace=false;};var sectionStack=[],updateLine,nextOpenTag,nextCloseTag;var setTags=function(source){tags=trim(source).split(/\s+/);nextOpenTag=tags[0];nextCloseTag=tags[tags.length-1];};var includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];','\nif (partial) {','\n  buffer += render(partial,stack[stack.length - 1],partials);','\n}','\nbuffer += "');};var openSection=function(source,inverted){var name=trim(source);if(name===""){throw debug(new Error("Section name may not be empty"),template,line,options.file);}
sectionStack.push({name:name,inverted:inverted});code.push('";',updateLine,'\nvar name = "'+name+'";','\nvar callback = (function () {','\n  return function () {','\n    var buffer = "";','\nbuffer += "');};var openInvertedSection=function(source){openSection(source,true);};var closeSection=function(source){var name=trim(source);var openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName){throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);}
var section=sectionStack.pop();code.push('";','\n    return buffer;','\n  };','\n})();');if(section.inverted){code.push("\nbuffer += renderSection(name,stack,callback,true);");}else{code.push("\nbuffer += renderSection(name,stack,callback);");}
code.push('\nbuffer += "');};var sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(source)+'",stack,"");','\nbuffer += "');};var sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "');};var line=1,c,callback;for(var i=0,len=template.length;i<len;++i){if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length;c=template.substr(i,1);updateLine='\nline = '+line+';';nextOpenTag=openTag;nextCloseTag=closeTag;hasTag=true;switch(c){case"!":i++;callback=null;break;case"=":i++;closeTag="="+closeTag;callback=setTags;break;case">":i++;callback=includePartial;break;case"#":i++;callback=openSection;break;case"^":i++;callback=openInvertedSection;break;case"/":i++;callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++;nonSpace=true;callback=sendPlain;break;default:nonSpace=true;callback=sendEscaped;}
var end=template.indexOf(closeTag,i);if(end===-1){throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);}
var source=template.substring(i,end);if(callback){callback(source);}
var n=0;while(~(n=source.indexOf("\n",n))){line++;n++;}
i=end+closeTag.length-1;openTag=nextOpenTag;closeTag=nextCloseTag;}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=true;code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length);code.push("\\n");stripSpace();line++;break;default:if(isWhitespace(c)){spaces.push(code.length);}else{nonSpace=true;}
code.push(c);}}}
if(sectionStack.length!=0){throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);}
stripSpace();code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");if(options.debug){if(typeof console!="undefined"&&console.log){console.log(body);}else if(typeof print==="function"){print(body);}}
return body;}
function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render";var body=parse(template,options);var fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render);}catch(e){throw debug(e.error,template,e.line,options.file);}};}
var _cache={};function clearCache(){_cache={};}
function compile(template,options){options=options||{};if(options.cache!==false){if(!_cache[template]){_cache[template]=_compile(template,options);}
return _cache[template];}
return _compile(template,options);}
function render(template,view,partials){return compile(template)(view,partials);}})(Mustache);(function(context){context.Mustache=Mustache;if(context.define&&context.define.amd){context.define('wikia.mustache',Mustache);}}(window));;define('wikia.toc',function(){'use strict';function getData(headers,createSection){var toc={sections:[]},levels=[toc.sections],headersLength=headers.length,hToLevel=[],level=-1,lastHeader=-1,headerLevel,i,obj,header;for(i=0;i<headersLength;i++){header=headers[i];obj=createSection(header);if(obj===false||typeof obj.sections==='undefined'||!(obj.sections instanceof Array)){continue;}
headerLevel=parseInt(header.nodeName.slice(1),10);if(headerLevel>lastHeader){level+=1;}else if(headerLevel<lastHeader&&level>0){level=0;if(typeof hToLevel[headerLevel]!=='undefined'){level=hToLevel[headerLevel];}}
hToLevel[headerLevel]=level;lastHeader=headerLevel;levels[level].push(obj);levels[level+1]=obj.sections;}
return toc;}
return{getData:getData};});;require(['jquery','wikia.toc','wikia.mustache'],function($,toc,mustache){'use strict';var hasTOC=false,cacheKey='TOCAssets';function wrapper(){return function(text,render){if(text!==''){return'<ol>'+render(text)+'</ol>';}else{return false;}};}
function createTOCSection(header){header=$(header).children('.mw-headline');if(header.length===0){return false;}
header=header.clone();header.find('noscript').remove();return{title:header.text(),id:header.attr('id'),sections:[]};}
function loadTemplate(){var dfd=new $.Deferred();require(['wikia.loader','wikia.cache'],function(loader,cache){var template=cache.getVersioned(cacheKey);if(template){dfd.resolve(template);}else{require(['wikia.throbber'],function(throbber){var toc=$('#toc');throbber.show(toc);loader({type:loader.MULTI,resources:{mustache:'extensions/wikia/TOC/templates/TOC_articleContent.mustache'}}).done(function(data){template=data.mustache[0];dfd.resolve(template);cache.setVersioned(cacheKey,template,604800);throbber.remove(toc);});});}});return dfd.promise();}
function renderTOC($target){var $container=$target.parents('#toc').children('ol'),$headers=$target.parents('#mw-content-text').find('h1, h2, h3, h4, h5, h6'),data=toc.getData($headers,createTOCSection);data.wrapper=wrapper;loadTemplate().done(function(template){$container.append(mustache.render(template,data));hasTOC=true;});}
function setTOCCookie(isHidden){$.cookie('mw_hidetoc',isHidden,{expires:30,path:'/'});}
function showHideTOC($target){var tocWrapper=$target.parents('#toc'),targetLabel,tocCookie;tocWrapper.toggleClass('show');if(tocWrapper.hasClass('show')){targetLabel=$target.data('hide');tocCookie=null;}else{targetLabel=$target.data('show');tocCookie=1;}
$target.text(targetLabel);$target.attr('title',targetLabel);setTOCCookie(tocCookie);}
function isNewTOC(){return $('#toc').is('nav');}
function initTOC(){var $showLink=$('#togglelink');if(!hasTOC){renderTOC($showLink);}
showHideTOC($showLink);}
$(function(){$('body').on('click','#togglelink',function(event){event.preventDefault();if(isNewTOC()){var $target=$(event.target);if(!hasTOC){renderTOC($target);}
showHideTOC($target);}});$(window).on('EditPageAfterRenderPreview',function(){hasTOC=false;if(isNewTOC()&&window.wgUserName!==null){initTOC();}});if(isNewTOC()&&window.wgUserName!==null&&$.cookie('mw_hidetoc')===null){initTOC();}});});;